# Step into R programming:The iris flower dataset  

Learning objectives:

- Utilize R via [Rstudio Cloud](https://rstudio.cloud/) or through a local installation.
- Familiarize yourself with the RStudio interface, including Console, Script, Environment, Plots panels.
- Understand and manipulate data frames and vectors.
- Master the basics workflow: importing data, checking data types, defining vectors from columns, and data through plotting.

 
## Getting started 
**1. Using RStudio Cloud:**

R and RStudio are accessible through a web browser via [Rstudio
    Cloud](https://rstudio.cloud/). You can create a free account, or simply log in using your Google account. Begin by clicking the **New Project** button. 

**2. Local Installation:**

Alternatively, you can install R on your laptop from [www.R-project.org](https://cloud.r-project.org/). Then install RStudio Desktop from
    [www.RStudio.com](https://www.rstudio.com/products/rstudio/download/#download). If you're using older versions of R or Rstudio, it's wise to uninstall them, delete the folder containing R packages, and install the latest versions for an optimal experience.
    

```{r Rinterface, echo=FALSE, out.width='80%', fig.cap='Interface of RStudio.', fig.align='center'}
knitr::include_graphics("images/img0100_Rstudio.png")
```


RStudio uses R in the background but provides a more user-friendly interface. R
commands can be typed directly into the "Console" window, as shown in Figure \@ref(fig:Rinterface). 

For a quick demonstration, try executing the following commands in the Console window. 
Remember, R is case-sensitive: "Species" and "species" are two different variables. 
If these commands seem like a breeze,  perhaps this book is too basic for you. 
Consider exploring more advanced books like [R for Data Science](https://r4ds.had.co.nz/). 
Conversely, if typing these 248 characters feels like a multi-month project, consider a typing tutorial at [www.RapidTyping.com](www.RapidTyping.com).  
```{r eval = FALSE}
head(iris)
str(iris)
summary(iris)
df <- iris[, 1:4]
boxplot(df)
pairs(df)
stars(df)

PL <- df$Petal.Length
barplot(PL)
hist(PL)
SP <- iris$Species
pie(table(SP))
boxplot(PL ~ SP)
summary(aov(PL ~ SP))

PW <- df$Petal.Width
plot(PL, PW, col = SP)
abline(lm(PW ~ PL))
```

![Animated GIF for screen shot.](https://github.com/gexijin/learnR/raw/master/images/demo.gif)


## The proper way of using RStudio

1.  **Create a project**: In RStudio, a project serves as a convenient means to organize your work. For each new research project, we put all related files (source code, data, results) into a designated folder. On RStudio.cloud, this is a must for starting an R session. 
Click the **Untitled Project** on the top of the window to rename it as something meaningful, such as "Workshop". For local R users, navigate to **File** in the main menu, select **New Project**, then follow the instructions to choose or create a new folder. 

2.  **Create a script file**: Begin by going to **File > New File > R Script**, or by clicking on the green plus icon. Instead of directly typing commands into the console window, we will use the **R Script** window. This allows us to save our work. To execute one line of code, simply click anywhere on the line and then click the **Run** button. You can also execute a block of code by highlighting it and clicking Run. For practice, type these two lines into the Script window, save the script as 'Workshop_script.R'. Then click each line and **Run** from the icon. After that, highlight both lines and click **Run**. 
```{r eval = FALSE}
head(iris)
plot(iris)
```

3.  **Copy file into project folder**: To integrate the dataset into your project, download it from
[GitHub](https://raw.githubusercontent.com/gexijin/learnR/master/datasets/iris.csv) and save it as 'iris.csv'.  

## Data frames contain rows and columns: the iris flower dataset 
In 1936, Edgar Anderson collected data on [*iris* flowers] to quantify the geographic variations
(https://en.wikipedia.org/wiki/iris_flower_data_set). 
The dataset includes 50 samples from each of the three
sub-species ( *iris setosa*, *iris virginica,* and *iris versicolor*), with measurements in centimeters (cm) for lengths and widths of sepals and petals. This is one of many built-in datasets in R. You can also **download** the dataset from
[GitHub](https://raw.githubusercontent.com/gexijin/learnR/master/datasets/iris.csv).

```{r echo=FALSE, out.width='50%', fig.cap='iris flower. Photo from Wikipedia.', fig.align='center' }
knitr::include_graphics("images/img0101_iris.png")
```

If you are using [Rstudio Cloud](https://rstudio.cloud/) through a web browser, 
remember that it operates on cloud-based servers. This means you cannot directly access 
local files, and must first upload them using the **Upload** button in the **Files** 
tab of the lower right panel. 

To **import** the dataset into R, go to **Import Dataset** in the **File** menu, then 
select **"From Text(base)..."**. The default settings should suffice; just click 
**Import** in the pop-up window. Thankfully, importing data in R isn't a lengthy process like in some other software(says SAS). If you have trouble with importing, skip this step as this dataset is already included in R.

```{r echo=FALSE, out.width='80%', fig.cap='Example of a data frame.', fig.align='center'}
knitr::include_graphics("images/img0102_dataframe.png")
```

Let's open the dataset in Excel for a quick review. Think about what distinguishes the three species. Imagine you find an iris flower with sepals of 6.5cm long by 3.0cm wide, and petals of 6.2cm long by 2.2cm wide. Which species do you think it belongs to?  **Think** (!) for a few minutes while eyeballing the data in Excel. Write down your guess about the species. Getting familiar with this dataset is crucial for this chapter and those that follow.

To answer these questions, let's visualize and analyze the data with R. **Type the commands, omit those marked by “#”**.
```{r echo=TRUE, eval=FALSE}
View(iris) # View as a spreadsheet
```
```{r echo=TRUE}
head(iris) # Display the first few rows
class(iris) # Reveal the data type
str(iris) # Expose the structure
```

The imported data is stored in a **data frame** named *iris*, which contains
information for 150 observations (flowers) across 5 variables. The first 4 variables/columns, 
*Sepal.Length*, *Sepal.Width*, *Petal.Length*, and *Petal.Width*, are **numeric**. 
The 5^th^ variable/column, *Species*, consists of **character** strings indicating the sub-species of each sample. It's important to note that numeric and character data are treated differently in R. Sometimes we need to overwrite data types guessed by R, which can be done during the data importing process. If you are using the built-in iris data, the variable/column *Species* is a **factor** with three levels.

```{r echo=TRUE}
summary(iris) # Provide summary statistics
```
The *summary* function offers insights into the distribution of each variables, highlighting that there are 50 observations for each of the three subspecies.

Individual values in a **data frame** can be accessed using row and column indices. 
```{r echo=TRUE, results='hide'}
iris[3, 4] # Value at row 3 and column 4
iris[3, ] # All values in row 3
iris[, 4] # All values in column 4
iris[3, 1:4] # Values in row 3 for columns 1 to 4
```

**To do the exercises, you need to start with a blank Word document. Copy-and-paste the R code and corresponding outputs into the document, then save it as both a Word and a PDF file. Submit these files to the Dropbox.**

>
```{exercise }

>

Type **data()** in the R Console window. The pop-up window - "R data sets" - contains all built-in data sets in package **datasets**. Choose a data set whose structure is data frame, then answer the following questions:

>
a. Display the first few rows of the data set. **NOT** the entire set.      
b. Show the dimensions of the data set.        
c. Extract a subset containing values from rows 2 to 5 and columns 1 to 4. Choose another data set if yours has fewer rows or columns.
```

Feel free to replace the **iris** data set with any of the built-in data sets as long as it's a **data frame**. Make sure to check the type of the data set using **class()** or **str()** function. Note that you will need to change the variable names and row/column ranges accordingly. 

```{r}
colnames(iris) # Display column names
```

Memorize these column names; they are essential for our analysis. We can retrieve an entire column by using the data frame name followed by the column name. For example, sepal length information is under the column **Sepal.Length**. Be mindful that R is case-sensitive; a term like “iris$petal.length” will not be recognized.
```{r echo=TRUE, results='hide'}
iris$Petal.Length # Display 150 petal lengths
```

To minimize typing, let’s store the data in a new **vector** named PL.

```{r} 
PL <- iris$Petal.Length # Store Petal.Length values in a new vector
```

Someone might complain that nothing happens after typing in this command. Actually, you have already created a new **vector** called PL in the memory. You can find it in the **Environment** tab in the top right panel. Programming mainly involves creating and modifying data objects in memory.
```{r echo=FALSE, out.width='100%', fig.align='center'}
knitr::include_graphics("images/environment.png")
```

Like withdrawing money saved in a bank, these data can be retrieved and used.
```{r} 
PL  # Output the 150 numbers stored in PL
mean(PL)  # Calculate the mean. Pretty straightforward!
```

>
```{exercise}

>
a. Calculate the mean of the sepal length in the data set **iris**.             
b. Find the mean of speed in the built-in data set **cars**.
```


The best way to discover and learn R functions is through a Google search. The R community is incredibly supportive. Websites like [StackOverflow.com](https://stackoverflow.com/) are treasure troves for code examples and answers to even the most basic questions.

>
```{exercise}

>
a. Look up “R square root function” on Google, then compute the value of $\sqrt{56.7}$.     
b. Find the maximum value of the variable *mpg* in the data set **mtcars**. 
```


## Analyzing one set of numbers

A **vector** in R holds a series of numbers or characters, and R's diverse **functions** make it simple to perform calculations (like addition, subtraction, multiplication, etc.) on these elements, either individually or collectively.

```{r}
summary(PL)
```

The **summary** function provides a detailed overview of the petal length distribution:

-   The minimum is 1.000, while the maximum reaches 6.900.

-   The average petal length stands at 3.758.

-   The mid-point, or median, at 4.350, indicates that half the values are smaller than this. Ever wonder why the median and mean differ? Imagine if there's a typo and a petal length is erroneously entered as 340cm instead of 3.40cm. That would skew things quite a bit!

-   The 3rd quartile, or 75^th^ percentile, is 5.100, meaning 75% of the petals are shorter than this. Conversely, a student ranked 5th in a class of 25 would be in the 80th percentile. The minimum is the 0^th^ percentile and the maximum is the 100^th^ percentile.
    
-   The 1st quartile, or 25^th^ percentile, is at 1.600, indicating that Only 25% of the flowers have
    petals shorter than this. 
    
  These summary statistics are visually represented in a boxplot (Figure \@ref(fig:1-3)A). Boxplots are particularly useful when comparing multiple data sets.

(ref:1-3) Boxplot of petal length (A) and of all 4 columns (B).

```{r 1-3, echo=c(1, 5), fig.show='hold', out.width='50%', fig.cap='(ref:1-3)', fig.align='center'}
boxplot(PL) # Boxplot of Petal Length.
text(x = 1, y = c(5.2, 4.5, 1.75), 
     labels = c("75th pencentile", "Median", "25th pencentile"))
text(1.45, 6.6, labels = "boxplot(PL)", col = "red")
legend("topleft", inset = .02, legend = "A", box.lty = 0)
boxplot(iris[, 1:4]) # Boxplots of four columns of iris.
text(4.1, 7.5, labels = "boxplot(iris[, 1:4])", col = "red")
legend("topleft", inset = .001, legend = "B", box.lty = 0)
```

In RStudio, you can copy a plot to the clipboard using the **Export** button on
top of the plot area. Or you can click **zoom**, right-click on the pop-up plot, 
and select **"Copy Image"**. Then you can paste the plot into Word. 

>
```{exercise}

>
a. Check the data structure of the built-in data set **mtcars**.     
b. Create a boxplot of Mile Per Gallon (*mpg*) in **mtcars**.
```

  
To quantify the variance, we compute the **standard deviation** σ as follows:
\begin{align}
σ=\sqrt{\frac{1}{N-1}[(x_{1}-\bar x)^2+(x_{2}-\bar x)^2+...+(x_{N}-\bar x)^2]}    
\end{align}
where N is the sample size and $\bar{x}$ is the mean:
\begin{align}
\bar x=\frac{1}{N}(x_{1}+x_{2}+\cdots+x_{N}) 

\end{align}
A small standard deviation implies that the measurements cluster closely around the mean.

```{r}
sd(PL) # Standard deviation of Petal Length
SW <- iris$Sepal.Width
sd(SW) # Standard deviation of Sepal Width
```

The results suggest that these flowers have similar sepal width but exhibit significant variation in
petal length, as indicated by the boxplot above. This variation might be an adaptation survival in different habitats.

With R, it is straightforward to generate graphs. 
```{r out.width='80%', fig.cap='Barplot of petal length.', fig.align='center'}
barplot(PL) # Bar plot of Petal Length
```

This bar plot suggests that the first 50 flowers (iris setosa) have much shorter
petals than the other two species, and the last 50 flowers (iris virginica) have
slightly longer petals than iris versicolor.

(ref:1-4) Scatter plot, histogram, lag plot and normal Q-Q plot. 

```{r 1-4, echo=c(1, 4, 6, 9, 10), fig.show='hold', out.width='50%', fig.cap='(ref:1-4)', fig.align='center'}
plot(PL) # Scatter plot
legend("topleft", inset = .02, cex = 2, legend = "plot(PL)", box.lty = 0)
title("Scatter plot of Petal Length")
hist(PL) # Histogram
legend(1.6, 36, cex = 2, legend = "hist(PL)", box.lty = 0)
lag.plot(PL) # Lag plot
legend("topleft", inset = .02, cex = 2, legend = "lag.plot(PL)", box.lty = 0)
title("Lag plot of Pental Length")
qqnorm(PL) # Q-Q plot for normal distribution
qqline(PL) #Add the regression line
legend("topleft", inset = .02, cex = 2, legend = "qqnorm(PL)", box.lty = 0)
```
In the scatter plot, three distinct groups are apparent, with one group having much smaller petal lengths. 

Histogram shows the distribution of data by plotting the frequency of data in bins.
Figure \@ref(fig:1-4) reveals that there are more flowers with Petal Length between 1 cm and 1.5 cm. It also indicates that the data does not show a bell-curved distribution.

The lag plot is a scatter plot against the same set of number with an offset of
1. Any structure in a lag plot indicates non-randomness in the order in which
the data is presented. We can clearly see three clusters, indicating that
values are centered around three levels sequentially.

Q-Q (quantile-quantile) plots are used to check if data follows a normal distribution, a pre-requisite for many statistical methods. Quantiles of the data are compared against those in a normal distribution. If the data points on a Q-Q plot form a straight line, the data likely adheres to a normal distribution. See Figure \@ref(fig:1-5) for an example. 


>
```{exercise}

>
a. Run x = rnorm(500) to generate 500 random numbers following the Standard Normal distribution.    
b. Generate scatter plot, histogram, lag plot, and Q-Q plot of these numbers. Your plots should resemble those in Figure \@ref(fig:1-5).      
```


(ref:1-5) Plots for randomly generated numbers following a normal distribution.

```{r 1-5, echo=FALSE, fig.show='hold', out.width='50%', out.length='50%', fig.cap='(ref:1-5)', fig.align='center'}
x <- rnorm(500)
plot(x) # Scatter plot
title("Scatter plot of x")
hist(x) # Histogram
lag.plot(x) # Lag plot
title("Lag plot of x")
qqnorm(x) # Q-Q plot for normal distribution
qqline(x)
```


>
```{exercise}

>
Create scatter plot, histogram, lag plot, and Q-Q plot for the Septal Length in the iris dataset.
```


A one-sample t-test is ideal for testing the mean of a normally distributed data. 
Suppose the pental length of the species *setosa*, the first 50 observations of *PL*, 
follows a normal distribution. We aim to test if its mean is different from 1.5 cm at the significance level of $\alpha = 0.05$. 
Here is the code to perform this test:
```{r}
t.test(PL[1:50], mu = 1.5) # Two-sided t-test for the mean petal length of setosa
```

In this case, our null hypothesis is that the mean petal length of *setosa* is 1.5 cm. 
Since p-value 0.1282 is greater than the significance level 0.05, 
there is no strong evidence to reject the null hypothesis. 
This function also provides the 95% confidence interval for the mean. 
Based on our sample of the 50 observations, we are 95% confident that the actual mean petal length of setosa (if we were to measure all setosa in the world) lies between 1.412645 cm and 1.511355 cm. 

>
```{exercise}

>
Compute the 95% confidence interval for the sepal length of setosa.
```


Hypothesis testing can also determine whether a set of numbers is derived from normal distribution. 
It's crucial to clearly state the null hypothesis when interpreting results. Here the null hypothesis is that the data comes from a normal distribution. 
```{r}
# Normality test 
shapiro.test(PL)
```

Given the test statistic of 0.87627, the chance that the petal length is normally distributed is only 7.412×10^-10^. In other words, it is highly unlikely that the petal length follows a normal distribution. We reject the normal distribution hypothesis, corroborating our earlier plots.

```{r}
# Normality test of the first 50 observations of PL
shapiro.test(PL[1:50])
```
With a p-value of 0.05481, slightly above the threshold of $\alpha=0.05$, we fail to reject the null hypothesis. This indicates that we don't have sufficient evidence to refute the claim that the petal length of setosa follows a normal distribution. 

In statistics, combining graphical insights with statistical models leads to well-rounded conclusions.

>
```{exercise}

>
a. Conduct Shapiro’s test on sepal width. Does it follow a normal distribution given the significant level $\alpha = 0.05$?    
b. Generate histogram and Q-Q plot for sepal width. Do these plots show a normal distribution?    
```


## Analyzing a categorical variable

In the iris dataset, the species information in the last column is what we call a **categorical variable**. 
Bar and Pie charts are excellent for displaying proportions. In this case, they display equal representation of the three species, with 50 observations each.
```{r echo=c(1, 2, 3, 5), fig.show='hold', out.width='50%', fig.cap='Frequencies of categorical values visualized by Pie chart (A) and bar chart (B).', fig.align='center'}
counts <- table(iris$Species) # Tabulate the frequencies
counts
pie(counts) # Create a pie chart
legend("topleft", inset = .02, legend = "A", box.lty = 0)
barplot(counts) # Generate a bar plot
text(3.71, 48, labels = "B")
```


## The relationship between two numerical variables 
Scatter plot is very effective in visualizing the correlation between two numerical variables.

(ref:2-1) Scatter plot of petal width and petal length.

```{r 2-1, message=FALSE, out.width='80%', fig.cap='(ref:2-1)', fig.align='center'}
PW <- iris$Petal.Width # Shortcut for petal width
plot(PW, PL) # Scatter plot of petal width vs petal length
```

Figure \@ref(fig:2-1) shows that there is a positive correlation between petal
length and width. This implies that flowers with longer petals are also
wider, suggesting a proportional increase in both dimensions.

Another unusual feature is that there seem to be two distinct clusters. Do the
points in the small cluster represent one particular species of iris? To explore 
this, we can color-code the species in the plot.  The resultant Figure \@ref(fig:2-2) clearly  demonstrates that one particular species, *setosa* forms the smaller cluster in
the low left corner. The other two species, while not as distinctly separated, also exhibit a notable differences. This insight is crucial for understanding the dataset.

(ref:2-2) Scatter plot showing the correlation of petal width and petal length.

```{r 2-2, echo = c(1,2,3),out.width='80%', fig.cap='(ref:2-2)', fig.align='center'}
SP <- as.factor(iris$Species)
plot(PW, PL, col = SP) # Colors based on Species
legend("topleft", levels(SP), fill = 1:3) # Add legends on top left.
abline(lm(PL ~ PW)) # Linear model line
```


To enable species-based color coding, we defined a new variable SP by converting the last column into a **factor**. The function **str(SP)** shows that the SP is a factor with 3 levels, internally coded as 1, 2, and 3, which we use for color coding. This method of base plotting in R has been simplified by 
modern systems such as ggplot2, which we will discuss later. So it's not necessary to remember any of these steps.

```{r}
str(SP) # Display the structure of Species.
```

The variation in petal length might be an adaptation to different environments. For instance, *setosa*, with the smallest petals, is typically found in Arctic
regions. *versicolor* is often found in the Eastern United States and
Eastern Canada. While *virginica* is common along the coastal plain from Florida
to Georgia in the Southeastern United States--*Wikipedia*." It appears that the iris
flowers in warmer places are much larger than those in colder ones. R makes graph creation easy, but interpreting these graphs in context still requires thoughtful analysis.

>
```{exercise}

>
Explore the **mtcars** dataset available at: [https://stat.ethz.ch/R-manual/R-patched/RHOME/library/datasets/html/mtcars.html](https://stat.ethz.ch/R-manual/R-patched/RHOME/library/datasets/html/mtcars.html). Create a scatter plot to analyze the correlation between Miles/(US) gallon and Displacement (cu.in.). Since the type of cyl is numeric, you will need to use function newcyl -> as.factor(cyl) to convert it into factor. Replace all 'mtcars$cyl' with 'newcyl'.
>
a. Color-code the scatter plot by the Number of cylinders;
b. Include a legend to the top right corner.
```

We can quantitatively measure the strength of a correlation using metrics like Pearson's correlation coefficient, which ranges from -1 to 1. A value of zero signifies no linear correlation.
```{r}
cor(PW, PL)
```

This outcome indicates a strong, positive correlation between petal width and petal length. To visually represent this on a plot, we can add a text annotation:
```{r eval=FALSE}
text(1.5, 1.5, paste("R=0.96"))
```

A correlation test can further assess the statistical significance of the correlation:
```{r}
cor.test(PW, PL)
```

This test allows us to reject the null hypothesis that the true correlation is zero (no correlation), which indicates that the correlation is statistically significant. It's worth noting that Pearson’s coefficient can be influenced by outliers, and alternatives like Spearman’s coefficient may be used for more robust analysis. For more information, consult the help documentation:
```{r eval=FALSE, echo=TRUE, message=FALSE}
?cor # Display help information for the cor() function
```

Regression analysis can further reveal the relationship between petal length and width using an equation. We consider a linear model:

   $Petal.Length = \alpha × Petal.Width + c + \epsilon$,

where $\alpha$ is the slope parameter, $c$ is a constant, and $\epsilon$ represents random error. This model can be established using a least squared-error method:
```{r}
model <- lm(PL ~ PW) # Linear Model (lm)
summary(model) # Display model details
```

In the regression model, the tilde(~) links a response variable on the left with one or more independent variables on the right side. We are defining a statistical model where PL is modeled as a function of PW.
Our analysis estimates $\alpha=2.22944$ and $c=1.08356$, with both parameters significantly 
different from zero (p-values<2×10^-16^) in both cases. Consequently, we can reliably predict the petal length with the equation: 

$Petal.Length = 2.22944 × Petal.Width + 1.08356$.

Formulas like this are also used in plots. This model can be visualized on a scatter plot as a regression line:
```{r fig.keep='none', eval = FALSE}
abline(model) # Add the regression line to plot
```

To analyze the model's accuracy and assumptions, diagnostic plots are useful:
```{r fig.keep='none', eval = FALSE}
plot(model) # Diagnostic plots for regression
```
Regression analysis is a powerful tool for examining the significance of relationships between variables. 

>
```{exercise}

>
Investigate the relationship between sepal length and sepal width using scatter plots, 
correlation coefficients, test of correlation, and linear regression. 
Again interpret all your results in clear and straightforward English.
```



## Testing the differences between two groups
In research, we often encounter questions like "Are boys taller than girls of the same age?" To address such queries, we analyze a random **sample** from a **population** to determine if observed differences between two groups reflect actual population differences or are merely due to random sampling errors.

(ref:2-4) Boxplot of petal length, grouped by species.

```{r  message=FALSE, out.width='80%', fig.cap='(ref:2-4)', fig.align='center'}
Species <- iris$Species
# Compare distributions of petal length for the three species via boxplot
boxplot(PL ~ Species)
```
Here, R automatically splits the dataset into three groups based on species and creates a boxplot for each. The boxplot clearly shows that *Setosa* has much shorter petals. But are the differences between *versicolor* and *virginica* statistically significant? Despite our limited sample size of 50 flowers per species, we seek to draw broader conclusions. We could measure all the iris flowers across the world or **use statistical inference**. Let's extract corresponding data.
```{r results='hide'}
PL1 <- PL[51:100] # Petal Length of versicolor
PL1 
PL2 <- PL[101:150] # Petal length of virginica
PL2 
```

```{r fig.keep='none'}
boxplot(PL1, PL2) # Boxplot of the two groups
t.test(PL1, PL2) # Two-sample t-test
```
In this two sample t-test, our null hypothesis states that the mean petal length for *versicolor* is the same as for *virginica*. The small p-value of 2.2x10^-16^ indicates that it is extremely unlikely to observe the difference of 1.292cm through random sampling. Hence, we reject this hypothesis and conclude that the means for the two species are significantly different. If we measure all *versicolor* and *virginica* flowers in the world and compute their average petal lengths, it is very likely that the two averages are different. Conversely, a p-value larger than a chosen significance level, let's say $\alpha = 0.05$, would imply insufficient evidence to reject the hypothesis of equal means.

Interestingly, we do not need separate data objects for a t-test. It can be performed directly within the dataframe, with R separateing data points by columns.
```{r results='hide', fig.keep='none'}
# Extract observations of species versicolor which are lined at rows from 51 to 150
df <- iris[51:150, ]
t.test(Petal.Length ~ Species, data = df) # t-test within the data frame
boxplot(Petal.Length ~ Species, data = droplevels(df)) # Boxplot with adjusted species levels
```

>
```{exercise}

>
Use boxplot and t-test to investigate whether there are significant differences in 
sepal width between *versicolor* and *virginica*. Interpret your results.
```


## Testing differences among multiple groups (ANOVA)
As indicated in Figure \@ref(fig:2-5), sepal width variation across species is small. We aim to determine if the mean sepal widths for the 3 species are equal. This is a perfect task for Analysis of Variance (ANOVA).

(ref:2-5) Boxplot of sepal width across 3 species.

```{r 2-5, echo=c(1:3), fig.cap='(ref:2-5)', fig.align='center'}
SW <- iris$Sepal.Width
boxplot(SW ~ SP)
summary(aov(SW ~ SP))
```
With the p-value significantly below 0.05, we reject the null hypothesis, concluding that not all the 3 species share the same mean sepal width. The boxplot in Figure \@ref(fig:2-5) suggests that *setosa* has wider sepals, though ANOVA only confirms that at least two species differ in mean sepal width, this is how the hypothesis was set up. 

>
```{exercise}

>
Explore if the mean spetal widths are the same across the 3 species using boxplot and ANOVA. 
```

Hopefully, this chapter has given you a taste of what it's like to use R for data visualization and analysis. It's an interactive and graphical process. If I've made this seem overly complex, I apologize; that's not my intention as an instructor. Many individuals can learn R independently by working on a small dataset of personal interest. The key is to Google everything and keep trying. 

![From Tenor.com](https://github.com/gexijin/learnR/raw/master/images/tenor_typing_cat.gif)
```{r echo=FALSE,eval=FALSE}
# https://www.google.com/url?sa=i&url=https%3A%2F%2Ftenor.com%2Fsearch%2Ftyping-cat-gifs&psig=AOvVaw1CPM5qGGZWAikE70wzGepI&ust=1623775293141000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCNi1wMHIl_ECFQAAAAAdAAAAABAJ
```
