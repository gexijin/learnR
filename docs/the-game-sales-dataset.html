<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 The game sales dataset | Learn R through examples</title>
  <meta name="description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 The game sales dataset | Learn R through examples" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="github-repo" content="gexijin/learnR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 The game sales dataset | Learn R through examples" />
  
  <meta name="twitter:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  

<meta name="author" content="Xijin Ge, Jianli Qi and Rong Fan" />


<meta name="date" content="2021-08-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-state-dataset.html"/>
<link rel="next" href="the-messy-salary-data.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html"><i class="fa fa-check"></i><b>1</b> Step into R programming–the iris flower dataset</a>
<ul>
<li class="chapter" data-level="1.1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting started</a></li>
<li class="chapter" data-level="1.2" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#data-frames-contain-rows-and-columns-the-iris-flower-dataset"><i class="fa fa-check"></i><b>1.2</b> Data frames contain rows and columns: the Iris flower dataset</a></li>
<li class="chapter" data-level="1.3" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-one-set-of-numbers"><i class="fa fa-check"></i><b>1.3</b> Analyzing one set of numbers</a></li>
<li class="chapter" data-level="1.4" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-a-categorical-variable"><i class="fa fa-check"></i><b>1.4</b> Analyzing a categorical variable</a></li>
<li class="chapter" data-level="1.5" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#the-relationship-between-two-numerical-variables"><i class="fa fa-check"></i><b>1.5</b> The relationship between two numerical variables</a></li>
<li class="chapter" data-level="1.6" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-the-differences-between-two-groups"><i class="fa fa-check"></i><b>1.6</b> Testing the differences between two groups</a></li>
<li class="chapter" data-level="1.7" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-the-difference-among-multiple-groups-anova"><i class="fa fa-check"></i><b>1.7</b> Testing the difference among multiple groups (ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html"><i class="fa fa-check"></i><b>2</b> Visualizing the iris flower data set</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#basic-concepts-of-r-graphics"><i class="fa fa-check"></i><b>2.1</b> Basic concepts of R graphics</a></li>
<li class="chapter" data-level="2.2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#scatter-plots-matrix"><i class="fa fa-check"></i><b>2.2</b> Scatter plots matrix</a></li>
<li class="chapter" data-level="2.3" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#star-and-segment-diagrams"><i class="fa fa-check"></i><b>2.3</b> Star and segment diagrams</a></li>
<li class="chapter" data-level="2.4" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#the-ggplot2-package-is-intuitive-and-powerful"><i class="fa fa-check"></i><b>2.4</b> The ggplot2 package is intuitive and powerful</a></li>
<li class="chapter" data-level="2.5" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#other-types-of-plots-with-ggplot2"><i class="fa fa-check"></i><b>2.5</b> Other types of plots with ggplot2</a></li>
<li class="chapter" data-level="2.6" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#hierarchical-clustering-and-heat-map"><i class="fa fa-check"></i><b>2.6</b> Hierarchical clustering and heat map</a></li>
<li class="chapter" data-level="2.7" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>2.7</b> Principal component analysis (PCA)</a></li>
<li class="chapter" data-level="2.8" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#classification-by-predicting-the-odds-of-binary-outcomes"><i class="fa fa-check"></i><b>2.8</b> Classification by predicting the odds of binary outcomes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-structures.html"><a href="data-structures.html#basic-concepts"><i class="fa fa-check"></i><b>3.1</b> Basic concepts</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-structures.html"><a href="data-structures.html#expressions"><i class="fa fa-check"></i><b>3.1.1</b> Expressions</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-structures.html"><a href="data-structures.html#logical-values"><i class="fa fa-check"></i><b>3.1.2</b> Logical Values</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-structures.html"><a href="data-structures.html#variables"><i class="fa fa-check"></i><b>3.1.3</b> Variables</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-structures.html"><a href="data-structures.html#functions"><i class="fa fa-check"></i><b>3.1.4</b> Functions</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-structures.html"><a href="data-structures.html#looking-for-help-and-example-code"><i class="fa fa-check"></i><b>3.1.5</b> Looking for help and example Code</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-structures.html"><a href="data-structures.html#data-structures-1"><i class="fa fa-check"></i><b>3.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>3.2.2</b> Matrices</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>3.2.3</b> Data Frames</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-structures.html"><a href="data-structures.html#strings-and-string-vectors"><i class="fa fa-check"></i><b>3.2.4</b> Strings and string vectors</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.2.5</b> Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html"><i class="fa fa-check"></i><b>4</b> Importing data and managing files</a>
<ul>
<li class="chapter" data-level="4.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#project-oriented-workflow"><i class="fa fa-check"></i><b>4.1</b> Project-oriented workflow</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-project-in-a-new-folder"><i class="fa fa-check"></i><b>4.1.1</b> Create a project in a new folder</a></li>
<li class="chapter" data-level="4.1.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-script-file-and-comment"><i class="fa fa-check"></i><b>4.1.2</b> Create a script file and comment (!)</a></li>
<li class="chapter" data-level="4.1.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#copy-data-files-to-the-new-directory"><i class="fa fa-check"></i><b>4.1.3</b> Copy data files to the new directory</a></li>
<li class="chapter" data-level="4.1.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#import-data-files"><i class="fa fa-check"></i><b>4.1.4</b> Import data files</a></li>
<li class="chapter" data-level="4.1.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#check-and-convert-data-types"><i class="fa fa-check"></i><b>4.1.5</b> Check and convert data types</a></li>
<li class="chapter" data-level="4.1.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#close-a-project-when-you-are-done"><i class="fa fa-check"></i><b>4.1.6</b> Close a project when you are done</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#reading-files-directly-using-read.table"><i class="fa fa-check"></i><b>4.2</b> Reading files directly using read.table</a></li>
<li class="chapter" data-level="4.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#general-procedure-to-read-data-into-r"><i class="fa fa-check"></i><b>4.3</b> General procedure to read data into R:</a></li>
<li class="chapter" data-level="4.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#enter-data-manually"><i class="fa fa-check"></i><b>4.4</b> Enter data manually</a></li>
<li class="chapter" data-level="4.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-manipulation-in-a-data-frame"><i class="fa fa-check"></i><b>4.5</b> Data manipulation in a data frame</a></li>
<li class="chapter" data-level="4.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-transformation-using-the-dplyr"><i class="fa fa-check"></i><b>4.6</b> Data transformation using the dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html"><i class="fa fa-check"></i><b>5</b> The heart attack data set (I)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#begin-your-analysis-by-examining-each-column-separately"><i class="fa fa-check"></i><b>5.1</b> Begin your analysis by examining each column separately</a></li>
<li class="chapter" data-level="5.2" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#possible-correlation-between-two-numeric-columns"><i class="fa fa-check"></i><b>5.2</b> Possible correlation between two numeric columns?</a></li>
<li class="chapter" data-level="5.3" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Associations between categorical variables?</a></li>
<li class="chapter" data-level="5.4" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-a-categorical-and-a-numeric-variables"><i class="fa fa-check"></i><b>5.4</b> Associations between a categorical and a numeric variables?</a></li>
<li class="chapter" data-level="5.5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-multiple-columns"><i class="fa fa-check"></i><b>5.5</b> Associations between multiple columns?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html"><i class="fa fa-check"></i><b>6</b> The heart attack dataset (II)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#scatter-plot-in-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Scatter plot in ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>6.2</b> Histograms and density plots</a></li>
<li class="chapter" data-level="6.3" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#box-plots-and-violin-plots"><i class="fa fa-check"></i><b>6.3</b> Box plots and Violin plots</a></li>
<li class="chapter" data-level="6.4" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#bar-plot-with-error-bars"><i class="fa fa-check"></i><b>6.4</b> Bar plot with error bars</a></li>
<li class="chapter" data-level="6.5" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#statistical-models-are-easy-interpretations-and-verifications-are-not"><i class="fa fa-check"></i><b>6.5</b> Statistical models are easy; interpretations and verifications are not!</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-topics.html"><a href="advanced-topics.html"><i class="fa fa-check"></i><b>7</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-topics.html"><a href="advanced-topics.html#introduction-to-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Introduction to R Markdown</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-topics.html"><a href="advanced-topics.html#tidyverse"><i class="fa fa-check"></i><b>7.2</b> Tidyverse</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-topics.html"><a href="advanced-topics.html#interactive-plots-made-easy-with-plotly"><i class="fa fa-check"></i><b>7.3</b> Interactive plots made easy with Plotly</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-topics.html"><a href="advanced-topics.html#shiny-apps"><i class="fa fa-check"></i><b>7.4</b> Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-topics.html"><a href="advanced-topics.html#install-the-shiny-package-by-typing-this-in-the-console."><i class="fa fa-check"></i><b>7.4.1</b> Install the Shiny package by typing this in the console.</a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-topics.html"><a href="advanced-topics.html#create-a-shiny-web-app-is-a-piece-of-cake"><i class="fa fa-check"></i><b>7.4.2</b> Create a Shiny web app is a piece of cake</a></li>
<li class="chapter" data-level="7.4.3" data-path="advanced-topics.html"><a href="advanced-topics.html#lets-play"><i class="fa fa-check"></i><b>7.4.3</b> Let’s play!</a></li>
<li class="chapter" data-level="7.4.4" data-path="advanced-topics.html"><a href="advanced-topics.html#pubish-your-app"><i class="fa fa-check"></i><b>7.4.4</b> Pubish your app</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-topics.html"><a href="advanced-topics.html#define-your-own-function"><i class="fa fa-check"></i><b>7.5</b> Define your own function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-state-dataset.html"><a href="the-state-dataset.html"><i class="fa fa-check"></i><b>8</b> The state dataset</a>
<ul>
<li class="chapter" data-level="8.1" data-path="the-state-dataset.html"><a href="the-state-dataset.html#reading-in-and-manipulating-data"><i class="fa fa-check"></i><b>8.1</b> Reading in and manipulating data</a></li>
<li class="chapter" data-level="8.2" data-path="the-state-dataset.html"><a href="the-state-dataset.html#visualizing-data"><i class="fa fa-check"></i><b>8.2</b> Visualizing data</a></li>
<li class="chapter" data-level="8.3" data-path="the-state-dataset.html"><a href="the-state-dataset.html#analyzing-the-relationship-among-variables"><i class="fa fa-check"></i><b>8.3</b> Analyzing the relationship among variables</a></li>
<li class="chapter" data-level="8.4" data-path="the-state-dataset.html"><a href="the-state-dataset.html#the-whole-picture-of-the-data-set"><i class="fa fa-check"></i><b>8.4</b> The whole picture of the data set</a></li>
<li class="chapter" data-level="8.5" data-path="the-state-dataset.html"><a href="the-state-dataset.html#linear-model-analysis"><i class="fa fa-check"></i><b>8.5</b> Linear model analysis</a></li>
<li class="chapter" data-level="8.6" data-path="the-state-dataset.html"><a href="the-state-dataset.html#conclusion"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html"><i class="fa fa-check"></i><b>9</b> The game sales dataset</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#reading-in-data-and-manage-data"><i class="fa fa-check"></i><b>9.1</b> Reading in data and manage data</a></li>
<li class="chapter" data-level="9.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#visualization-of-categorical-variables"><i class="fa fa-check"></i><b>9.2</b> Visualization of categorical variables</a></li>
<li class="chapter" data-level="9.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#correlation-among-numeric-variables"><i class="fa fa-check"></i><b>9.3</b> Correlation among numeric variables</a></li>
<li class="chapter" data-level="9.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-score-and-count"><i class="fa fa-check"></i><b>9.4</b> Analysis of score and count</a></li>
<li class="chapter" data-level="9.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-sales"><i class="fa fa-check"></i><b>9.5</b> Analysis of sales</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-year.release"><i class="fa fa-check"></i><b>9.5.1</b> By Year.Release</a></li>
<li class="chapter" data-level="9.5.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-region"><i class="fa fa-check"></i><b>9.5.2</b> By Region</a></li>
<li class="chapter" data-level="9.5.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating"><i class="fa fa-check"></i><b>9.5.3</b> By Rating</a></li>
<li class="chapter" data-level="9.5.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-genre"><i class="fa fa-check"></i><b>9.5.4</b> By Genre</a></li>
<li class="chapter" data-level="9.5.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-score"><i class="fa fa-check"></i><b>9.5.5</b> by Score</a></li>
<li class="chapter" data-level="9.5.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating-genre-critic-score"><i class="fa fa-check"></i><b>9.5.6</b> By Rating &amp; Genre &amp; Critic score</a></li>
<li class="chapter" data-level="9.5.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-platform"><i class="fa fa-check"></i><b>9.5.7</b> By Platform</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#effect-of-platform-type-to-priciple-components"><i class="fa fa-check"></i><b>9.6</b> Effect of platform type to priciple components</a></li>
<li class="chapter" data-level="9.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#models-for-global-sales"><i class="fa fa-check"></i><b>9.7</b> Models for global sales</a></li>
<li class="chapter" data-level="9.8" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#conclusion-1"><i class="fa fa-check"></i><b>9.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html"><i class="fa fa-check"></i><b>10</b> The messy salary data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#read-in-and-clean-data"><i class="fa fa-check"></i><b>10.1</b> Read in and clean data</a></li>
<li class="chapter" data-level="10.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#information-about-the-variables"><i class="fa fa-check"></i><b>10.2</b> Information about the variables</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#income-and-age"><i class="fa fa-check"></i><b>10.2.1</b> Income and age</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group"><i class="fa fa-check"></i><b>10.2.2</b> Ethnic group</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex"><i class="fa fa-check"></i><b>10.2.3</b> Sex</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#union-descreption"><i class="fa fa-check"></i><b>10.2.4</b> Union descreption</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income"><i class="fa fa-check"></i><b>10.3</b> Analysis of gross income</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#age"><i class="fa fa-check"></i><b>10.3.1</b> Age</a></li>
<li class="chapter" data-level="10.3.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex-1"><i class="fa fa-check"></i><b>10.3.2</b> Sex</a></li>
<li class="chapter" data-level="10.3.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group-1"><i class="fa fa-check"></i><b>10.3.3</b> Ethnic Group</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income-type"><i class="fa fa-check"></i><b>10.4</b> Analysis of gross income type</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#gross-type"><i class="fa fa-check"></i><b>10.4.1</b> Gross Type</a></li>
<li class="chapter" data-level="10.4.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-and-sex-and-age"><i class="fa fa-check"></i><b>10.4.2</b> Ethnic and Sex and age</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#lm-and-anova-analysis"><i class="fa fa-check"></i><b>10.5</b> LM and ANOVA analysis</a></li>
<li class="chapter" data-level="10.6" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#conclusion-2"><i class="fa fa-check"></i><b>10.6</b> Conclusion</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learn R through examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-game-sales-dataset" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> The game sales dataset</h1>
<p>This is a video game sales data including game sales of North America, European, Japan, and other area, together they make the global sale. The data also gives information about the critic score, user score, and the counts of critics or users who gave these two kind of scores. This data was downloaded from <a href="https://www.kaggle.com/rush4ratio/video-game-sales-with-ratings#Video_Games_Sales_as_at_22_Dec_2016.csv">https://www.kaggle.com/rush4ratio/video-game-sales-with-ratings#Video_Games_Sales_as_at_22_Dec_2016.csv</a>.</p>
<p>The detail about the data is listed as follow:</p>
<p>Name: Name of the game</p>
<p>Platform: Console on which the game is running</p>
<p>Year_of_Release: Year of the game released</p>
<p>Genre: Game’s category</p>
<p>Publisher: Publisher</p>
<p>NA_Sales: Game sales in North America (in millions of units)</p>
<p>EU_Sales: Game sales in the European Union (in millions of units)</p>
<p>JP_Sales: Game sales in Japan (in millions of units)</p>
<p>Other_Sales: Game sales in the rest of the world, i.e. Africa, Asia excluding Japan, Australia, Europe excluding the E.U. and South America (in millions of units)</p>
<p>Global_Sales: Total sales in the world (in millions of units)</p>
<p>Critic_Score: Aggregate score compiled by Meta critic staff</p>
<p>Critic_Count: The number of critics used in coming up with the Critic_score</p>
<p>User_Score: Score by Metacritic’s subscribers</p>
<p>User_Count: Number of users who gave the user_score</p>
<p>Developer: Party responsible for creating the game</p>
<p>Rating: The ESRB ratings:
E for “Everyone”; E10+ for “Everyone 10+”; T for “Teen”; M for “Mature”; AO for “Adults Only”; RP for “Rating Pending”; K-A for kids to adults.</p>
<p>After downloading the data, We replaced N/A with NA first in Excel and saved it as csv file , then read in. We removed these observations with empty strings of Rating and 6825 observations were left in our data set “game.” We noticed that there were lots of sales value with zero. To prepare these variables ready for being taken log value to make them normal or close to the normal distribution, we transformed the sales into basic units and plus 1. We also divided critic score by 10 to match the scale unit of user score.</p>
<div id="reading-in-data-and-manage-data" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Reading in data and manage data</h2>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="the-game-sales-dataset.html#cb814-1" aria-hidden="true" tabindex="-1"></a>tem <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;datasets/video-game-sales-at-22-Dec-2016.csv&quot;</span>)</span>
<span id="cb814-2"><a href="the-game-sales-dataset.html#cb814-2" aria-hidden="true" tabindex="-1"></a>tem <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(tem)  <span class="co"># Remove NA</span></span>
<span id="cb814-3"><a href="the-game-sales-dataset.html#cb814-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-4"><a href="the-game-sales-dataset.html#cb814-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb814-5"><a href="the-game-sales-dataset.html#cb814-5" aria-hidden="true" tabindex="-1"></a>game <span class="ot">&lt;-</span> tem <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Rating <span class="sc">!=</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>()  <span class="co">#remove empty rating observations</span></span>
<span id="cb814-6"><a href="the-game-sales-dataset.html#cb814-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-7"><a href="the-game-sales-dataset.html#cb814-7" aria-hidden="true" tabindex="-1"></a><span class="co"># By multiplying 1000000 we get the actual sale, </span></span>
<span id="cb814-8"><a href="the-game-sales-dataset.html#cb814-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding 1 makes all sales positive which make log possible for all sales later</span></span>
<span id="cb814-9"><a href="the-game-sales-dataset.html#cb814-9" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Year_of_Release <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">as.character</span>(game<span class="sc">$</span>Year_of_Release))</span>
<span id="cb814-10"><a href="the-game-sales-dataset.html#cb814-10" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>NA_Sales <span class="ot">&lt;-</span> game<span class="sc">$</span>NA_Sales <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb814-11"><a href="the-game-sales-dataset.html#cb814-11" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>EU_Sales <span class="ot">&lt;-</span> game<span class="sc">$</span>EU_Sales <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb814-12"><a href="the-game-sales-dataset.html#cb814-12" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>JP_Sales <span class="ot">&lt;-</span> game<span class="sc">$</span>JP_Sales <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb814-13"><a href="the-game-sales-dataset.html#cb814-13" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Other_Sales <span class="ot">&lt;-</span> game<span class="sc">$</span>Other_Sales <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb814-14"><a href="the-game-sales-dataset.html#cb814-14" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Global_Sales <span class="ot">&lt;-</span> game<span class="sc">$</span>Global_Sales <span class="sc">*</span> <span class="dv">1000000</span> <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb814-15"><a href="the-game-sales-dataset.html#cb814-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-16"><a href="the-game-sales-dataset.html#cb814-16" aria-hidden="true" tabindex="-1"></a><span class="co"># By being divided by 10 to make Critic Score the same decimal as User Score</span></span>
<span id="cb814-17"><a href="the-game-sales-dataset.html#cb814-17" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Critic_Score <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(game<span class="sc">$</span>Critic_Score)) <span class="sc">/</span> <span class="dv">10</span>  </span>
<span id="cb814-18"><a href="the-game-sales-dataset.html#cb814-18" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>User_Score <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(game<span class="sc">$</span>User_Score))</span>
<span id="cb814-19"><a href="the-game-sales-dataset.html#cb814-19" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Critic_Count <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(game<span class="sc">$</span>Critic_Count)</span>
<span id="cb814-20"><a href="the-game-sales-dataset.html#cb814-20" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>User_Count <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(game<span class="sc">$</span>User_Count)</span>
<span id="cb814-21"><a href="the-game-sales-dataset.html#cb814-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-22"><a href="the-game-sales-dataset.html#cb814-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Set category variables as factor variables </span></span>
<span id="cb814-23"><a href="the-game-sales-dataset.html#cb814-23" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Name <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Name)</span>
<span id="cb814-24"><a href="the-game-sales-dataset.html#cb814-24" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Platform <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Platform)</span>
<span id="cb814-25"><a href="the-game-sales-dataset.html#cb814-25" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Genre <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Genre)</span>
<span id="cb814-26"><a href="the-game-sales-dataset.html#cb814-26" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Publisher <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Publisher)</span>
<span id="cb814-27"><a href="the-game-sales-dataset.html#cb814-27" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Developer <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Developer)</span>
<span id="cb814-28"><a href="the-game-sales-dataset.html#cb814-28" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Rating <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Rating)</span>
<span id="cb814-29"><a href="the-game-sales-dataset.html#cb814-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-30"><a href="the-game-sales-dataset.html#cb814-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Format column names </span></span>
<span id="cb814-31"><a href="the-game-sales-dataset.html#cb814-31" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(game) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Name&quot;</span>, <span class="st">&quot;Platform&quot;</span>, <span class="st">&quot;Year.Release&quot;</span>, <span class="st">&quot;Genre&quot;</span>, <span class="st">&quot;Publisher&quot;</span>, <span class="st">&quot;NA.Sales&quot;</span>, <span class="st">&quot;EU.Sales&quot;</span>, <span class="st">&quot;JP.Sales&quot;</span>, <span class="st">&quot;Other.Sales&quot;</span>, <span class="st">&quot;Global.Sales&quot;</span>, <span class="st">&quot;Critic.Score&quot;</span>, <span class="st">&quot;Critic.Count&quot;</span>, <span class="st">&quot;User.Score&quot;</span>, <span class="st">&quot;User.Count&quot;</span>, <span class="st">&quot;Developer&quot;</span>, <span class="st">&quot;Rating&quot;</span>)</span>
<span id="cb814-32"><a href="the-game-sales-dataset.html#cb814-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-33"><a href="the-game-sales-dataset.html#cb814-33" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(game)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6825 obs. of  16 variables:
##  $ Name        : Factor w/ 4377 levels &quot; Tales of Xillia 2&quot;,..: 4203 2055 4205 2530 4201 2533 2054 4195 1820 4196 ...
##  $ Platform    : Factor w/ 17 levels &quot;3DS&quot;,&quot;DC&quot;,&quot;DS&quot;,..: 13 13 13 3 13 13 3 13 15 13 ...
##  $ Year.Release: Factor w/ 25 levels &quot;1985&quot;,&quot;1988&quot;,..: 15 17 18 15 15 18 14 16 19 18 ...
##  $ Genre       : Factor w/ 12 levels &quot;Action&quot;,&quot;Adventure&quot;,..: 11 7 11 5 4 5 7 11 4 11 ...
##  $ Publisher   : Factor w/ 262 levels &quot;10TACLE Studios&quot;,..: 164 164 164 164 164 164 164 164 147 164 ...
##  $ NA.Sales    : num  41360001 15680001 15610001 11280001 13960001 ...
##  $ EU.Sales    : num  28960001 12760001 10930001 9140001 9180001 ...
##  $ JP.Sales    : num  3770001 3790001 3280001 6500001 2930001 ...
##  $ Other.Sales : num  8450001 3290001 2950001 2880001 2840001 ...
##  $ Global.Sales: num  82530001 35520001 32770001 29800001 28920001 ...
##  $ Critic.Score: num  7.6 8.2 8 8.9 5.8 8.7 9.1 8 6.1 8 ...
##  $ Critic.Count: num  51 73 73 65 41 80 64 63 45 33 ...
##  $ User.Score  : num  8 8.3 8 8.5 6.6 8.4 8.6 7.7 6.3 7.4 ...
##  $ User.Count  : num  322 709 192 431 129 594 464 146 106 52 ...
##  $ Developer   : Factor w/ 1289 levels &quot;10tacle Studios, Fusionsphere Systems&quot;,..: 779 779 779 779 779 779 779 779 468 779 ...
##  $ Rating      : Factor w/ 7 levels &quot;AO&quot;,&quot;E&quot;,&quot;E10+&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  - attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:9826] 2 5 6 10 11 13 19 21 22 23 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:9826] &quot;2&quot; &quot;5&quot; &quot;6&quot; &quot;10&quot; ...</code></pre>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="the-game-sales-dataset.html#cb816-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(game)</span></code></pre></div>
<pre><code>##                                         Name         Platform     Year.Release 
##  LEGO Star Wars II: The Original Trilogy  :   8   PS2    :1140   2008   : 592  
##  Madden NFL 07                            :   8   X360   : 858   2007   : 590  
##  Need for Speed: Most Wanted              :   8   PS3    : 769   2005   : 562  
##  Harry Potter and the Order of the Phoenix:   7   PC     : 651   2009   : 550  
##  Madden NFL 08                            :   7   XB     : 565   2006   : 528  
##  Need for Speed Carbon                    :   7   Wii    : 479   2003   : 498  
##  (Other)                                  :6780   (Other):2363   (Other):3505  
##           Genre                            Publisher       NA.Sales       
##  Action      :1630   Electronic Arts            : 944   Min.   :       1  
##  Sports      : 943   Ubisoft                    : 496   1st Qu.:   60001  
##  Shooter     : 864   Activision                 : 492   Median :  150001  
##  Role-Playing: 712   Sony Computer Entertainment: 316   Mean   :  394485  
##  Racing      : 581   THQ                        : 307   3rd Qu.:  390001  
##  Platform    : 403   Nintendo                   : 291   Max.   :41360001  
##  (Other)     :1692   (Other)                    :3979                     
##     EU.Sales           JP.Sales        Other.Sales        Global.Sales     
##  Min.   :       1   Min.   :      1   Min.   :       1   Min.   :   10001  
##  1st Qu.:   20001   1st Qu.:      1   1st Qu.:   10001   1st Qu.:  110001  
##  Median :   60001   Median :      1   Median :   20001   Median :  290001  
##  Mean   :  236090   Mean   :  64159   Mean   :   82678   Mean   :  777591  
##  3rd Qu.:  210001   3rd Qu.:  10001   3rd Qu.:   70001   3rd Qu.:  750001  
##  Max.   :28960001   Max.   :6500001   Max.   :10570001   Max.   :82530001  
##                                                                            
##   Critic.Score    Critic.Count      User.Score      User.Count     
##  Min.   :1.300   Min.   :  3.00   Min.   :0.500   Min.   :    4.0  
##  1st Qu.:6.200   1st Qu.: 14.00   1st Qu.:6.500   1st Qu.:   11.0  
##  Median :7.200   Median : 25.00   Median :7.500   Median :   27.0  
##  Mean   :7.027   Mean   : 28.93   Mean   :7.186   Mean   :  174.7  
##  3rd Qu.:8.000   3rd Qu.: 39.00   3rd Qu.:8.200   3rd Qu.:   89.0  
##  Max.   :9.800   Max.   :113.00   Max.   :9.600   Max.   :10665.0  
##                                                                    
##             Developer     Rating    
##  EA Canada       : 149   AO  :   1  
##  EA Sports       : 142   E   :2082  
##  Capcom          : 126   E10+: 930  
##  Ubisoft         : 103   K-A :   1  
##  Konami          :  95   M   :1433  
##  Ubisoft Montreal:  87   RP  :   1  
##  (Other)         :6123   T   :2377</code></pre>
<p>Summary of these variables tells us that some of the games were published in the same name; PS2 is the most popular platform; Action is the most popular Genre; Electronic Arts has the most high frequency among the publishers; Rating T and E are the two most released ratings; For these sales, though the minimums, several quantiles, and medians are small, the maximums are high, which means there are real good sale games among them; Extreme big maximum User count hints so many users scored some special games.</p>
<p>Our pre-analysis shows that these variables are not normally distributed, especially those sales and score counts variables. We take logs to transform these variables.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="the-game-sales-dataset.html#cb818-1" aria-hidden="true" tabindex="-1"></a>NA.Sales.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>NA.Sales)   </span>
<span id="cb818-2"><a href="the-game-sales-dataset.html#cb818-2" aria-hidden="true" tabindex="-1"></a>EU.Sales.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>EU.Sales)  </span>
<span id="cb818-3"><a href="the-game-sales-dataset.html#cb818-3" aria-hidden="true" tabindex="-1"></a>JP.Sales.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>JP.Sales)   </span>
<span id="cb818-4"><a href="the-game-sales-dataset.html#cb818-4" aria-hidden="true" tabindex="-1"></a>Other.Sales.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>Other.Sales)  </span>
<span id="cb818-5"><a href="the-game-sales-dataset.html#cb818-5" aria-hidden="true" tabindex="-1"></a>Global.Sales.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>Global.Sales) </span>
<span id="cb818-6"><a href="the-game-sales-dataset.html#cb818-6" aria-hidden="true" tabindex="-1"></a>Critic.Count.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>Critic.Count)</span>
<span id="cb818-7"><a href="the-game-sales-dataset.html#cb818-7" aria-hidden="true" tabindex="-1"></a>User.Count.Log <span class="ot">&lt;-</span> <span class="fu">log</span>(game<span class="sc">$</span>User.Count)</span></code></pre></div>
<p>Then we combine the log variables with the original variables.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="the-game-sales-dataset.html#cb819-1" aria-hidden="true" tabindex="-1"></a>game.log <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(NA.Sales.Log, EU.Sales.Log, JP.Sales.Log, Other.Sales.Log,</span>
<span id="cb819-2"><a href="the-game-sales-dataset.html#cb819-2" aria-hidden="true" tabindex="-1"></a>Global.Sales.Log, Critic.Count.Log, User.Count.Log)</span>
<span id="cb819-3"><a href="the-game-sales-dataset.html#cb819-3" aria-hidden="true" tabindex="-1"></a>game <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(game, game.log)  <span class="co"># The data we use for analysis</span></span></code></pre></div>
<p>Now we plot histogram and QQ plot for the transformed data set.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="the-game-sales-dataset.html#cb820-1" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(game)[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">23</span>)]  <span class="co"># Pick up the numeric columns according to the names </span></span>
<span id="cb820-2"><a href="the-game-sales-dataset.html#cb820-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>))  <span class="co"># Layout in 5 rows and 4 columns</span></span>
<span id="cb820-3"><a href="the-game-sales-dataset.html#cb820-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(name)){</span>
<span id="cb820-4"><a href="the-game-sales-dataset.html#cb820-4" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">sample</span>(game[name[i]][, <span class="dv">1</span>], <span class="dv">5000</span>)</span>
<span id="cb820-5"><a href="the-game-sales-dataset.html#cb820-5" aria-hidden="true" tabindex="-1"></a>  submean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sub)</span>
<span id="cb820-6"><a href="the-game-sales-dataset.html#cb820-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sub, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Hist. of&quot;</span>, name[i], <span class="at">sep =</span> <span class="st">&quot; &quot;</span>), <span class="at">xlab =</span> name[i])</span>
<span id="cb820-7"><a href="the-game-sales-dataset.html#cb820-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> submean, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb820-8"><a href="the-game-sales-dataset.html#cb820-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(sub, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Q-Q Plot of&quot;</span>, name[i], <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb820-9"><a href="the-game-sales-dataset.html#cb820-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(sub) </span>
<span id="cb820-10"><a href="the-game-sales-dataset.html#cb820-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {s.t <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(sub)</span>
<span id="cb820-11"><a href="the-game-sales-dataset.html#cb820-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {s.t <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s.t, <span class="fu">shapiro.test</span>(sub))</span>
<span id="cb820-12"><a href="the-game-sales-dataset.html#cb820-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb820-13"><a href="the-game-sales-dataset.html#cb820-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb820-14"><a href="the-game-sales-dataset.html#cb820-14" aria-hidden="true" tabindex="-1"></a>s.t <span class="ot">&lt;-</span> s.t[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]  <span class="co"># Take first two columns of shapiro.test result</span></span>
<span id="cb820-15"><a href="the-game-sales-dataset.html#cb820-15" aria-hidden="true" tabindex="-1"></a>s.t <span class="ot">&lt;-</span> <span class="fu">cbind</span>(name, s.t) <span class="co"># Add variable name for the result</span></span>
<span id="cb820-16"><a href="the-game-sales-dataset.html#cb820-16" aria-hidden="true" tabindex="-1"></a>s.t</span></code></pre></div>
<pre><code>##     name               statistic p.value     
## s.t &quot;Critic.Score&quot;     0.962095  2.752307e-34
##     &quot;User.Score&quot;       0.9120088 4.411444e-47
##     &quot;NA.Sales.Log&quot;     0.6441563 5.738764e-73
##     &quot;EU.Sales.Log&quot;     0.7115408 1.045862e-68
##     &quot;JP.Sales.Log&quot;     0.6267102 5.87549e-74 
##     &quot;Other.Sales.Log&quot;  0.7100878 8.299196e-69
##     &quot;Global.Sales.Log&quot; 0.9970401 2.345161e-08
##     &quot;Critic.Count.Log&quot; 0.9796708 3.544379e-26
##     &quot;User.Count.Log&quot;   0.9423045 2.092411e-40</code></pre>
<p><img src="book_files/figure-html/unnamed-chunk-484-1.png" width="768" />
Histograms and qq plots of these original sales show abnormal distributed, but the log values of these sales are much close to normal distribution, especially the log value of global sales. Though the Shapiro test with a p-value less than 0.05 denies its normality, it’s much better than the other sales or other log values of sales. Maybe the missing value of sale is the reason of the abnormality. We will pay more attention to the log value of global sales later.</p>
<p>From the histograms and qq plots we also see that two scores and log values of their counts are close to normal distribution. Though the Shapiro tesst still deny the normality of these log values. We assume they are normally distributed in our analysis.</p>
<p>There are lots of interest points in this data set such as the distribution of global and regional sales, their relationship; the correlation of critic score and user score, and their counts; whether these scores are the main effect for sales, or the effect of other factors matter to sales such as genre, rating, platform, publisher, and so on.</p>
<p>First, let’s do visualization.</p>
</div>
<div id="visualization-of-categorical-variables" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Visualization of categorical variables</h2>
<p>To simplify platform analysis, We regroup platform as Platform.type.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="the-game-sales-dataset.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regroup platform as Platform.type </span></span>
<span id="cb822-2"><a href="the-game-sales-dataset.html#cb822-2" aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC&quot;</span>)</span>
<span id="cb822-3"><a href="the-game-sales-dataset.html#cb822-3" aria-hidden="true" tabindex="-1"></a>xbox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X360&quot;</span>, <span class="st">&quot;XB&quot;</span>, <span class="st">&quot;XOne&quot;</span>)</span>
<span id="cb822-4"><a href="the-game-sales-dataset.html#cb822-4" aria-hidden="true" tabindex="-1"></a>nintendo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Wii&quot;</span>, <span class="st">&quot;WiiU&quot;</span>, <span class="st">&quot;N64&quot;</span>, <span class="st">&quot;GC&quot;</span>, <span class="st">&quot;NES&quot;</span>, <span class="st">&quot;3DS&quot;</span>, <span class="st">&quot;DS&quot;</span>) </span>
<span id="cb822-5"><a href="the-game-sales-dataset.html#cb822-5" aria-hidden="true" tabindex="-1"></a>playstation <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PS&quot;</span>, <span class="st">&quot;PS2&quot;</span>, <span class="st">&quot;PS3&quot;</span>, <span class="st">&quot;PS4&quot;</span>, <span class="st">&quot;PSP&quot;</span>, <span class="st">&quot;PSV&quot;</span>)</span>
<span id="cb822-6"><a href="the-game-sales-dataset.html#cb822-6" aria-hidden="true" tabindex="-1"></a>game <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span></span>
<span id="cb822-7"><a href="the-game-sales-dataset.html#cb822-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Platform.type =</span> <span class="fu">ifelse</span>(Platform <span class="sc">%in%</span> pc, <span class="st">&quot;PC&quot;</span>,</span>
<span id="cb822-8"><a href="the-game-sales-dataset.html#cb822-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(Platform <span class="sc">%in%</span> xbox, <span class="st">&quot;Xbox&quot;</span>,</span>
<span id="cb822-9"><a href="the-game-sales-dataset.html#cb822-9" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">ifelse</span>(Platform <span class="sc">%in%</span> nintendo, <span class="st">&quot;Nintendo&quot;</span>, </span>
<span id="cb822-10"><a href="the-game-sales-dataset.html#cb822-10" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(Platform <span class="sc">%in%</span> playstation, <span class="st">&quot;Playstation&quot;</span>, <span class="st">&quot;Others&quot;</span>))))) </span></code></pre></div>

<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="the-game-sales-dataset.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb823-2"><a href="the-game-sales-dataset.html#cb823-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> Platform.type)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-PlatformType1"></span>
<img src="book_files/figure-html/game-PlatformType1-1.png" alt="Bar plot of platform type." width="672" />
<p class="caption">
Figure 9.1: Bar plot of platform type.
</p>
</div>
<p>As the bar plot shows here, Playstation is the biggest group, then Xbox and Nintendo. While “Others” is the smallest type.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="the-game-sales-dataset.html#cb824-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(game<span class="sc">$</span>Genre))</span>
<span id="cb824-2"><a href="the-game-sales-dataset.html#cb824-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>fraction <span class="ot">&lt;-</span> dat<span class="sc">$</span>Freq <span class="sc">/</span> <span class="fu">sum</span>(dat<span class="sc">$</span>Freq)</span>
<span id="cb824-3"><a href="the-game-sales-dataset.html#cb824-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="fu">order</span>(dat<span class="sc">$</span>fraction), ]</span>
<span id="cb824-4"><a href="the-game-sales-dataset.html#cb824-4" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>ymax <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(dat<span class="sc">$</span>fraction)</span>
<span id="cb824-5"><a href="the-game-sales-dataset.html#cb824-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>ymin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(dat<span class="sc">$</span>ymax, <span class="at">n =</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb824-6"><a href="the-game-sales-dataset.html#cb824-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Genre&quot;</span></span>
<span id="cb824-7"><a href="the-game-sales-dataset.html#cb824-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb824-8"><a href="the-game-sales-dataset.html#cb824-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">fill =</span> Genre, <span class="at">ymax =</span> ymax, <span class="at">ymin =</span> ymin, <span class="at">xmax =</span> <span class="dv">4</span>, <span class="at">xmin =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb824-9"><a href="the-game-sales-dataset.html#cb824-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="at">colour =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span>  <span class="co"># Background color</span></span>
<span id="cb824-10"><a href="the-game-sales-dataset.html#cb824-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span>  <span class="co"># Coordinate system to polar</span></span>
<span id="cb824-11"><a href="the-game-sales-dataset.html#cb824-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span>  </span>
<span id="cb824-12"><a href="the-game-sales-dataset.html#cb824-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ring plot for Genre&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Genre&quot;</span>) <span class="sc">+</span></span>
<span id="cb824-13"><a href="the-game-sales-dataset.html#cb824-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
<p>Action, Sports, and Shooter are the first three biggest genres. Action occupies almost 25% of genre. Three of
them together contribute over half of the genre count. Puzzle, Adventure, and Stratege have relatively less count.</p>
<p>Now we regroup rating AO, RP and K-A as “Others” because there are only few observations of these ratings.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="the-game-sales-dataset.html#cb825-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regroup Rating as Rating.type </span></span>
<span id="cb825-2"><a href="the-game-sales-dataset.html#cb825-2" aria-hidden="true" tabindex="-1"></a>rating <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;E&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;E10+&quot;</span>)</span>
<span id="cb825-3"><a href="the-game-sales-dataset.html#cb825-3" aria-hidden="true" tabindex="-1"></a>game <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span> </span>
<span id="cb825-4"><a href="the-game-sales-dataset.html#cb825-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rating.type =</span> <span class="fu">ifelse</span>(Rating <span class="sc">%in%</span> rating, <span class="fu">as.character</span>(Rating), <span class="st">&quot;Others&quot;</span>)) </span></code></pre></div>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="the-game-sales-dataset.html#cb826-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(game<span class="sc">$</span>Rating.type), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb826-2"><a href="the-game-sales-dataset.html#cb826-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the names of counts for detail information</span></span>
<span id="cb826-3"><a href="the-game-sales-dataset.html#cb826-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;T - Teen&quot;</span>, <span class="st">&quot;E - Everyone&quot;</span>, <span class="st">&quot;M - Mature&quot;</span>, <span class="st">&quot;E10+ - Everyone 10+&quot;</span>, <span class="st">&quot;Others&quot;</span>)</span>
<span id="cb826-4"><a href="the-game-sales-dataset.html#cb826-4" aria-hidden="true" tabindex="-1"></a>pct <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">round</span>(counts<span class="sc">/</span><span class="fu">sum</span>(counts) <span class="sc">*</span> <span class="dv">100</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb826-5"><a href="the-game-sales-dataset.html#cb826-5" aria-hidden="true" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(counts), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, pct, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)  <span class="co"># Rating information and percentage</span></span>
<span id="cb826-6"><a href="the-game-sales-dataset.html#cb826-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(counts, <span class="at">labels =</span> lbls, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(lbls)),</span>
<span id="cb826-7"><a href="the-game-sales-dataset.html#cb826-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">&quot;Pie Chart of Ratings with sample sizes&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-488-1.png" width="672" /></p>
<p>The popular ratings are T, E, M, and E10+, according to the order. “Others” only occupies a very little portion in the all games.</p>

<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="the-game-sales-dataset.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb827-2"><a href="the-game-sales-dataset.html#cb827-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb827-3"><a href="the-game-sales-dataset.html#cb827-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game) <span class="sc">+</span></span>
<span id="cb827-4"><a href="the-game-sales-dataset.html#cb827-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(Rating.type), <span class="at">fill =</span> Platform.type), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb827-5"><a href="the-game-sales-dataset.html#cb827-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Rating Type&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Platform Type&quot;</span>, <span class="at">title=</span><span class="st">&quot;Mosaic Plot&quot;</span>) <span class="sc">+</span></span>
<span id="cb827-6"><a href="the-game-sales-dataset.html#cb827-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb827-7"><a href="the-game-sales-dataset.html#cb827-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-mosaic"></span>
<div id="htmlwidget-08196747e4c5fe362763" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-08196747e4c5fe362763">{"x":{"data":[{"x":[0,0,0.292852747252747,0.292852747252747,0],"y":[0,0.303064909538038,0.303064909538038,0,0],"text":"Nintendo<br>E<br>Frequency: 656","key":["Nintendo","E"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.8)","hoveron":"fills","name":"Nintendo","legendgroup":"Nintendo","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.302852747252747,0.302852747252747,0.433665934065934,0.433665934065934,0.302852747252747],"y":[0,0.389915896939975,0.389915896939975,0,0],"text":"Nintendo<br>E10+<br>Frequency: 377","key":["Nintendo","E10+"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.8)","hoveron":"fills","name":"Nintendo","legendgroup":"Nintendo","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.443665934065934,0.443665934065934,0.645230769230769,0.645230769230769,0.443665934065934],"y":[0,0.0657797813329779,0.0657797813329779,0,0],"text":"Nintendo<br>M<br>Frequency: 98","key":["Nintendo","M"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.8)","hoveron":"fills","name":"Nintendo","legendgroup":"Nintendo","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.655230769230769,0.655230769230769,0.655652747252747,0.655652747252747,0.655230769230769],"y":[0,0,0,0,0],"text":"Nintendo<br>Others<br>Frequency: 0","key":["Nintendo","Others"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.8)","hoveron":"fills","name":"Nintendo","legendgroup":"Nintendo","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.665652747252747,0.665652747252747,1,1,0.665652747252747],"y":[0,0.163480035573324,0.163480035573324,0,0],"text":"Nintendo<br>T<br>Frequency: 404","key":["Nintendo","T"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(248,118,109,0.8)","hoveron":"fills","name":"Nintendo","legendgroup":"Nintendo","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0,0,0.292852747252747,0.292852747252747,0],"y":[0.312599535430494,0.392061676345955,0.392061676345955,0.312599535430494,0.312599535430494],"text":"Others<br>E<br>Frequency: 172","key":["Others","E"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(163,165,0,0.8)","hoveron":"fills","name":"Others","legendgroup":"Others","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.302852747252747,0.302852747252747,0.433665934065934,0.433665934065934,0.302852747252747],"y":[0.399450522832431,0.418067196956886,0.418067196956886,0.399450522832431,0.399450522832431],"text":"Others<br>E10+<br>Frequency: 18","key":["Others","E10+"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(163,165,0,0.8)","hoveron":"fills","name":"Others","legendgroup":"Others","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.443665934065934,0.443665934065934,0.645230769230769,0.645230769230769,0.443665934065934],"y":[0.0753144072254338,0.0800129630349322,0.0800129630349322,0.0753144072254338,0.0753144072254338],"text":"Others<br>M<br>Frequency: 7","key":["Others","M"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(163,165,0,0.8)","hoveron":"fills","name":"Others","legendgroup":"Others","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.655230769230769,0.655230769230769,0.655652747252747,0.655652747252747,0.655230769230769],"y":[0.00953462589245592,0.00953462589245592,0.00953462589245592,0.00953462589245592,0.00953462589245592],"text":"Others<br>Others<br>Frequency: 0","key":["Others","Others"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(163,165,0,0.8)","hoveron":"fills","name":"Others","legendgroup":"Others","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.665652747252747,0.665652747252747,1,1,0.665652747252747],"y":[0.17301466146578,0.194865953349343,0.194865953349343,0.17301466146578,0.17301466146578],"text":"Others<br>T<br>Frequency: 54","key":["Others","T"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(163,165,0,0.8)","hoveron":"fills","name":"Others","legendgroup":"Others","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0,0,0.292852747252747,0.292852747252747,0],"y":[0.401596302238411,0.447333232183939,0.447333232183939,0.401596302238411,0.401596302238411],"text":"PC<br>E<br>Frequency: 99","key":["PC","E"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,125,0.8)","hoveron":"fills","name":"PC","legendgroup":"PC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.302852747252747,0.302852747252747,0.433665934065934,0.433665934065934,0.302852747252747],"y":[0.427601822849342,0.492760182284934,0.492760182284934,0.427601822849342,0.427601822849342],"text":"PC<br>E10+<br>Frequency: 63","key":["PC","E10+"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,125,0.8)","hoveron":"fills","name":"PC","legendgroup":"PC","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.443665934065934,0.443665934065934,0.645230769230769,0.645230769230769,0.443665934065934],"y":[0.0895475889273881,0.251983375484333,0.251983375484333,0.0895475889273881,0.0895475889273881],"text":"PC<br>M<br>Frequency: 242","key":["PC","M"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,125,0.8)","hoveron":"fills","name":"PC","legendgroup":"PC","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.655230769230769,0.655230769230769,0.655652747252747,0.655652747252747,0.655230769230769],"y":[0.0190692517849118,0.339689750594971,0.339689750594971,0.0190692517849118,0.0190692517849118],"text":"PC<br>Others<br>Frequency: 1","key":["PC","Others"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,125,0.8)","hoveron":"fills","name":"PC","legendgroup":"PC","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.665652747252747,0.665652747252747,1,1,0.665652747252747],"y":[0.204400579241799,0.303945353378031,0.303945353378031,0.204400579241799,0.204400579241799],"text":"PC<br>T<br>Frequency: 246","key":["PC","T"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,191,125,0.8)","hoveron":"fills","name":"PC","legendgroup":"PC","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0,0,0.292852747252747,0.292852747252747,0],"y":[0.456867858076394,0.810751578665018,0.810751578665018,0.456867858076394,0.456867858076394],"text":"Playstation<br>E<br>Frequency: 766","key":["Playstation","E"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,176,246,0.8)","hoveron":"fills","name":"Playstation","legendgroup":"Playstation","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.302852747252747,0.302852747252747,0.433665934065934,0.433665934065934,0.302852747252747],"y":[0.50229480817739,0.812572710251641,0.812572710251641,0.50229480817739,0.50229480817739],"text":"Playstation<br>E10+<br>Frequency: 300","key":["Playstation","E10+"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,176,246,0.8)","hoveron":"fills","name":"Playstation","legendgroup":"Playstation","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.443665934065934,0.443665934065934,0.645230769230769,0.645230769230769,0.443665934065934],"y":[0.261518001376789,0.673648468095651,0.673648468095651,0.261518001376789,0.261518001376789],"text":"Playstation<br>M<br>Frequency: 614","key":["Playstation","M"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,176,246,0.8)","hoveron":"fills","name":"Playstation","legendgroup":"Playstation","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.655230769230769,0.655230769230769,0.655652747252747,0.655652747252747,0.655230769230769],"y":[0.349224376487427,0.669844875297485,0.669844875297485,0.349224376487427,0.349224376487427],"text":"Playstation<br>Others<br>Frequency: 1","key":["Playstation","Others"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,176,246,0.8)","hoveron":"fills","name":"Playstation","legendgroup":"Playstation","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.665652747252747,0.665652747252747,1,1,0.665652747252747],"y":[0.313479979270487,0.768715226844718,0.768715226844718,0.313479979270487,0.313479979270487],"text":"Playstation<br>T<br>Frequency: 1125","key":["Playstation","T"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(0,176,246,0.8)","hoveron":"fills","name":"Playstation","legendgroup":"Playstation","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0,0,0.292852747252747,0.292852747252747,0],"y":[0.820286204557474,1,1,0.820286204557474,0.820286204557474],"text":"Xbox<br>E<br>Frequency: 389","key":["Xbox","E"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(231,107,243,0.8)","hoveron":"fills","name":"Xbox","legendgroup":"Xbox","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.302852747252747,0.302852747252747,0.433665934065934,0.433665934065934,0.302852747252747],"y":[0.822107336144096,1,1,0.822107336144096,0.822107336144096],"text":"Xbox<br>E10+<br>Frequency: 172","key":["Xbox","E10+"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(231,107,243,0.8)","hoveron":"fills","name":"Xbox","legendgroup":"Xbox","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.443665934065934,0.443665934065934,0.645230769230769,0.645230769230769,0.443665934065934],"y":[0.683183093988107,1,1,0.683183093988107,0.683183093988107],"text":"Xbox<br>M<br>Frequency: 472","key":["Xbox","M"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(231,107,243,0.8)","hoveron":"fills","name":"Xbox","legendgroup":"Xbox","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.655230769230769,0.655230769230769,0.655652747252747,0.655652747252747,0.655230769230769],"y":[0.679379501189941,1,1,0.679379501189941,0.679379501189941],"text":"Xbox<br>Others<br>Frequency: 1","key":["Xbox","Others"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(231,107,243,0.8)","hoveron":"fills","name":"Xbox","legendgroup":"Xbox","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[0.665652747252747,0.665652747252747,1,1,0.665652747252747],"y":[0.778249852737174,1,1,0.778249852737174,0.778249852737174],"text":"Xbox<br>T<br>Frequency: 548","key":["Xbox","T"],"type":"scatter","mode":"lines","line":{"width":0.377952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(231,107,243,0.8)","hoveron":"fills","name":"Xbox","legendgroup":"Xbox","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":25.5707762557078},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Mosaic Plot","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["E","E10+","M","Others","T"],"tickvals":[0.146426373626374,0.368259340659341,0.544448351648352,0.655441758241758,0.832826373626374],"categoryorder":"array","categoryarray":["E","E10+","M","Others","T"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Rating Type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05,1.05],"tickmode":"array","ticktext":["Nintendo","Others","PC","Playstation","Xbox"],"tickvals":[0.151532454769019,0.352330605888225,0.424464767211175,0.633809718370706,0.910143102278737],"categoryorder":"array","categoryarray":["Nintendo","Others","PC","Playstation","Xbox"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Platform Type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.96751968503937},"annotations":[{"text":"Platform.type","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"69841d512911":{"x":{},"fill":{},"y":{},"x__fill__Platform.type":{},"x__Rating.type":{},"type":"scatter"}},"cur_data":"69841d512911","visdat":{"69841d512911":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 9.2: Mosaic plot between platform type and rating type.
</p>
</div>
<p>Same as we noticed previously, the Rating Type of “Others” cannot be seen here in the plot because of its small amount. For all platform and rating combinations, Playstation games occupy the biggest portion in all other three different rating types except Everyone 10 plus. Nintendo is the most popular game for Everyone 10 plus, it’s the second popular platform for rating Everyone. Xbox is the second popular platform for rating Mature and Teenage, and it’s the third favorite platform for rating Everyone and Everyone 10 plus. Most “Others” platform games are rated as Everyone.</p>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-489" class="exercise"><strong>Exercise 9.1  </strong></span></p>
Download the game sale data set and clean the data as similar as described in the beginning of this chapter, produce a masaic plot between genre and rating. Interpret your plot breifly.
</div>
</blockquote>
</div>
<div id="correlation-among-numeric-variables" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Correlation among numeric variables</h2>

<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="the-game-sales-dataset.html#cb828-1" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> game[, <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">23</span>)]  <span class="co"># Take numeric variables as goal matrix</span></span>
<span id="cb828-2"><a href="the-game-sales-dataset.html#cb828-2" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(st)</span>
<span id="cb828-3"><a href="the-game-sales-dataset.html#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)  </span>
<span id="cb828-4"><a href="the-game-sales-dataset.html#cb828-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb828-5"><a href="the-game-sales-dataset.html#cb828-5" aria-hidden="true" tabindex="-1"></a>corMatrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(st))  <span class="co"># Correlation matrix</span></span>
<span id="cb828-6"><a href="the-game-sales-dataset.html#cb828-6" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;#7F0000&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;#7FFF7F&quot;</span>,</span>
<span id="cb828-7"><a href="the-game-sales-dataset.html#cb828-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;#007FFF&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;#00007F&quot;</span>))</span>
<span id="cb828-8"><a href="the-game-sales-dataset.html#cb828-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(corMatrix, <span class="at">order =</span> <span class="st">&quot;AOE&quot;</span>, <span class="at">lower =</span> <span class="st">&quot;number&quot;</span>, <span class="at">lower.col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb828-9"><a href="the-game-sales-dataset.html#cb828-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">number.cex =</span> .<span class="dv">8</span>, <span class="at">upper =</span> <span class="st">&quot;ellipse&quot;</span>,  <span class="at">upper.col =</span> <span class="fu">col</span>(<span class="dv">10</span>), </span>
<span id="cb828-10"><a href="the-game-sales-dataset.html#cb828-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">&quot;u&quot;</span>, <span class="at">tl.pos =</span> <span class="st">&quot;lt&quot;</span>, <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-corrplot"></span>
<img src="book_files/figure-html/game-corrplot-1.png" alt="Corrplot among numeric variables." width="768" />
<p class="caption">
Figure 9.3: Corrplot among numeric variables.
</p>
</div>
<p>There are high r values of 0.75, 0.65, 0.52, and 0.42 between the log values of Global.Sales and regional sales, we will consider using Global.Sales.Log as our target sales to analyze the relationship of sales with other variables later. On the other hand, there are good positively correlations between regional sales too. User Score is positive correlated to Critic Score with r of 0.58. There is little correlation between User Count log value and User Score.</p>

<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="the-game-sales-dataset.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(<span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(st)))))  <span class="co"># Hierarchical clustering</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-dendrogram"></span>
<img src="book_files/figure-html/game-dendrogram-1.png" alt="Exercise dendrogram for numeric variables." width="672" />
<p class="caption">
Figure 9.4: Exercise dendrogram for numeric variables.
</p>
</div>
<p>All sales’ log values except JP.Sales.Log build one cluster; Scores, log values of counts, and JP.Sales build the second cluster. In the first cluster, Other.Sales.Log is closest to Global.Sales.Log, then NA.Sales.Log, and EU.Sales.Log is the next.</p>
</div>
<div id="analysis-of-score-and-count" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Analysis of score and count</h2>

<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="the-game-sales-dataset.html#cb830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)  <span class="co"># Package for function stat_poly_eq</span></span>
<span id="cb830-2"><a href="the-game-sales-dataset.html#cb830-2" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> x</span>
<span id="cb830-3"><a href="the-game-sales-dataset.html#cb830-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> User.Score, <span class="at">y =</span> Critic.Score)) <span class="sc">+</span> </span>
<span id="cb830-4"><a href="the-game-sales-dataset.html#cb830-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Platform), <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb830-5"><a href="the-game-sales-dataset.html#cb830-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">formula =</span> formula) <span class="sc">+</span>  <span class="co"># Add regression line</span></span>
<span id="cb830-6"><a href="the-game-sales-dataset.html#cb830-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb830-7"><a href="the-game-sales-dataset.html#cb830-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="at">formula =</span> formula,   <span class="co"># Add regression equation and R square value</span></span>
<span id="cb830-8"><a href="the-game-sales-dataset.html#cb830-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">eq.with.lhs =</span> <span class="st">&quot;italic(hat(y))~`=`~&quot;</span>,  <span class="co"># Add ^ on y</span></span>
<span id="cb830-9"><a href="the-game-sales-dataset.html#cb830-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(..eq.label.., ..rr.label.., <span class="at">sep =</span> <span class="st">&quot;*plain(</span><span class="sc">\&quot;</span><span class="st">,</span><span class="sc">\&quot;</span><span class="st">)~&quot;</span>)),</span>
<span id="cb830-10"><a href="the-game-sales-dataset.html#cb830-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">label.x.npc =</span> <span class="st">&quot;left&quot;</span>, <span class="at">label.y.npc =</span> <span class="fl">0.9</span>,   <span class="co"># Position of the equation label</span></span>
<span id="cb830-11"><a href="the-game-sales-dataset.html#cb830-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">parse =</span> <span class="cn">TRUE</span>)  <span class="co"># Output.type as &quot;expression&quot; </span></span>
<span id="cb830-12"><a href="the-game-sales-dataset.html#cb830-12" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb830-13"><a href="the-game-sales-dataset.html#cb830-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> game, <span class="fu">aes</span>(<span class="at">x =</span> Critic.Score), <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb830-14"><a href="the-game-sales-dataset.html#cb830-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data =</span> game, <span class="fu">aes</span>(<span class="at">x =</span> User.Score), <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>,                                       <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb830-15"><a href="the-game-sales-dataset.html#cb830-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Critic.Score-blue, User.Score-green&quot;</span>) </span>
<span id="cb830-16"><a href="the-game-sales-dataset.html#cb830-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb830-17"><a href="the-game-sales-dataset.html#cb830-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb830-18"><a href="the-game-sales-dataset.html#cb830-18" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-score"></span>
<img src="book_files/figure-html/game-score-1.png" alt="Scatter and density plot for critic score and user score." width="960" />
<p class="caption">
Figure 9.5: Scatter and density plot for critic score and user score.
</p>
</div>
<p>There is positive correlation between Critic.Score and User.Score. In total, Critic score is lower than user score.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="the-game-sales-dataset.html#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(game<span class="sc">$</span>Critic.Score, game<span class="sc">$</span>User.Score)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  game$Critic.Score and game$User.Score
## t = -6.5463, df = 13629, p-value = 6.108e-11
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.2058518 -0.1109834
## sample estimates:
## mean of x mean of y 
##  7.027209  7.185626</code></pre>
<p>T-test with a p-value of much less than 0.05 let us accept the alternative hypothesis with 95% confidence that there is a significant difference between the means of critic score and user score. The mean critic score is 7.03, and mean user score is 7.19.</p>

<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="the-game-sales-dataset.html#cb833-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hexbin)</span>
<span id="cb833-2"><a href="the-game-sales-dataset.html#cb833-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> Critic.Count.Log, <span class="at">y =</span> Critic.Score)) <span class="sc">+</span></span>
<span id="cb833-3"><a href="the-game-sales-dataset.html#cb833-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_binhex</span>() <span class="sc">+</span> <span class="co"># Bin 2d plane into hexagons</span></span>
<span id="cb833-4"><a href="the-game-sales-dataset.html#cb833-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb833-5"><a href="the-game-sales-dataset.html#cb833-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="co"># Adding a custom continuous color palette</span></span>
<span id="cb833-6"><a href="the-game-sales-dataset.html#cb833-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> User.Count.Log, <span class="at">y =</span> User.Score)) <span class="sc">+</span></span>
<span id="cb833-7"><a href="the-game-sales-dataset.html#cb833-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_binhex</span>() <span class="sc">+</span></span>
<span id="cb833-8"><a href="the-game-sales-dataset.html#cb833-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb833-9"><a href="the-game-sales-dataset.html#cb833-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Frequency&quot;</span>) <span class="co"># Color legend</span></span>
<span id="cb833-10"><a href="the-game-sales-dataset.html#cb833-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-count1"></span>
<img src="book_files/figure-html/game-count1-1.png" alt="Binhex plot for critic count and user count." width="672" />
<p class="caption">
Figure 9.6: Binhex plot for critic count and user count.
</p>
</div>
<p>Critic.Score has a pretty good correlation with Critic.Count.Log with an r-value of 0.41 in the previous correlation analysis, though Critic.Count.Log doesn’t have an overall impact on Critic.Score. From the right figure we can see that User.Score looks independent on User.Count.Log.</p>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-491" class="exercise"><strong>Exercise 9.2  </strong></span></p>
Use ggplot2 package to get a scatter plot with a smooth line between Global_Sales and NA_Sales. Use plain sentences to explain what you find in the plot.
</div>
</blockquote>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-492" class="exercise"><strong>Exercise 9.3  </strong></span></p>
Use density plot of Global_Sales, NA_Sales, EU_Sales, JP_Sales and Other_Sales to illustrate the relationship among these sales. Interpret your plot.
</div>
</blockquote>
</div>
<div id="analysis-of-sales" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Analysis of sales</h2>
<div id="by-year.release" class="section level3" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> By Year.Release</h3>

<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="the-game-sales-dataset.html#cb834-1" aria-hidden="true" tabindex="-1"></a>Year.Release <span class="ot">&lt;-</span> game<span class="sc">$</span>Year.Release </span>
<span id="cb834-2"><a href="the-game-sales-dataset.html#cb834-2" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(Year.Release))</span>
<span id="cb834-3"><a href="the-game-sales-dataset.html#cb834-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span></span>
<span id="cb834-4"><a href="the-game-sales-dataset.html#cb834-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year.Release, Global.Sales) <span class="sc">%&gt;%</span></span>
<span id="cb834-5"><a href="the-game-sales-dataset.html#cb834-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year.Release) <span class="sc">%&gt;%</span></span>
<span id="cb834-6"><a href="the-game-sales-dataset.html#cb834-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total.Sales =</span> <span class="fu">sum</span>(Global.Sales))</span>
<span id="cb834-7"><a href="the-game-sales-dataset.html#cb834-7" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(p, counts[<span class="dv">2</span>])  <span class="co"># Add counts to data frame</span></span>
<span id="cb834-8"><a href="the-game-sales-dataset.html#cb834-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(q)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;count&quot;</span></span>
<span id="cb834-9"><a href="the-game-sales-dataset.html#cb834-9" aria-hidden="true" tabindex="-1"></a>q<span class="sc">$</span>count <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(q<span class="sc">$</span>count)</span>
<span id="cb834-10"><a href="the-game-sales-dataset.html#cb834-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb834-11"><a href="the-game-sales-dataset.html#cb834-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q, <span class="fu">aes</span>(<span class="at">x =</span> Year.Release, <span class="at">y =</span> Total.Sales, <span class="at">label =</span> q<span class="sc">$</span>count)) <span class="sc">+</span></span>
<span id="cb834-12"><a href="the-game-sales-dataset.html#cb834-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb834-13"><a href="the-game-sales-dataset.html#cb834-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">y =</span> q<span class="sc">$</span>count <span class="sc">*</span> <span class="dv">500000</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;Yellow&quot;</span> ) <span class="sc">+</span></span>
<span id="cb834-14"><a href="the-game-sales-dataset.html#cb834-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">y =</span> (q<span class="sc">$</span>count <span class="sc">+</span> <span class="dv">50</span>) <span class="sc">*</span> <span class="dv">500000</span>) <span class="sc">+</span>  <span class="co"># Position of the text: count of games each year</span></span>
<span id="cb834-15"><a href="the-game-sales-dataset.html#cb834-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb834-16"><a href="the-game-sales-dataset.html#cb834-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>),</span>
<span id="cb834-17"><a href="the-game-sales-dataset.html#cb834-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb834-18"><a href="the-game-sales-dataset.html#cb834-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb834-19"><a href="the-game-sales-dataset.html#cb834-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">&quot;Year.Release&quot;</span>, <span class="at">labels =</span> <span class="fu">as.character</span>(Year.Release), <span class="at">breaks =</span> Year.Release) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesYear1"></span>
<img src="book_files/figure-html/game-SalesYear1-1.png" alt="Total global sales and game released by year." width="768" />
<p class="caption">
Figure 9.7: Total global sales and game released by year.
</p>
</div>
<p>We can see from the histogram of total sales that there were very few sales before 1996, only one game was released for each year. For several years between 1996 and 2000, the sales increased slowly. The count of games too. After that, there was a big rise in total sales and the number of released games. The top sales happened in 2008, and the most games were released in that year too. After that, both total sales and count of games went downhill.</p>
</div>
<div id="by-region" class="section level3" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> By Region</h3>

<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="the-game-sales-dataset.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb835-2"><a href="the-game-sales-dataset.html#cb835-2" aria-hidden="true" tabindex="-1"></a>game <span class="sc">%&gt;%</span></span>
<span id="cb835-3"><a href="the-game-sales-dataset.html#cb835-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year.Release, NA.Sales.Log, EU.Sales.Log, JP.Sales.Log, </span>
<span id="cb835-4"><a href="the-game-sales-dataset.html#cb835-4" aria-hidden="true" tabindex="-1"></a>         Other.Sales.Log, Global.Sales.Log) <span class="sc">%&gt;%</span></span>
<span id="cb835-5"><a href="the-game-sales-dataset.html#cb835-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">&quot;Year.Release&quot;</span>) <span class="sc">%&gt;%</span>   <span class="co"># Stacks other columns into &quot;Year.Release&quot;</span></span>
<span id="cb835-6"><a href="the-game-sales-dataset.html#cb835-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year.Release, variable) <span class="sc">%&gt;%</span> </span>
<span id="cb835-7"><a href="the-game-sales-dataset.html#cb835-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total.sales =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb835-8"><a href="the-game-sales-dataset.html#cb835-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year.Release, <span class="at">y =</span> total.sales, <span class="at">color =</span> variable, <span class="at">group =</span> variable)) <span class="sc">+</span></span>
<span id="cb835-9"><a href="the-game-sales-dataset.html#cb835-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb835-10"><a href="the-game-sales-dataset.html#cb835-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb835-11"><a href="the-game-sales-dataset.html#cb835-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year Release&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Total Sales Log Value&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Region&quot;</span>) <span class="sc">+</span></span>
<span id="cb835-12"><a href="the-game-sales-dataset.html#cb835-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb835-13"><a href="the-game-sales-dataset.html#cb835-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;pink&quot;</span>),</span>
<span id="cb835-14"><a href="the-game-sales-dataset.html#cb835-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb835-15"><a href="the-game-sales-dataset.html#cb835-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesRegion1"></span>
<img src="book_files/figure-html/game-SalesRegion1-1.png" alt="Year wise log global sales by region." width="864" />
<p class="caption">
Figure 9.8: Year wise log global sales by region.
</p>
</div>
<p>The pattern of log value for these regional sales in those years are similar for Global, North America, Europe, and Others. Japan is much different from them, which matches the previous cluster analysis.</p>
</div>
<div id="by-rating" class="section level3" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> By Rating</h3>

<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="the-game-sales-dataset.html#cb836-1" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Rating.type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Rating.type)</span>
<span id="cb836-2"><a href="the-game-sales-dataset.html#cb836-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> game[, <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>)] <span class="co"># Different sales</span></span>
<span id="cb836-3"><a href="the-game-sales-dataset.html#cb836-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">t</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">5</span>)[game<span class="sc">$</span>Rating.type])</span>
<span id="cb836-4"><a href="the-game-sales-dataset.html#cb836-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;center&quot;</span>, <span class="fu">levels</span>(game<span class="sc">$</span>Rating.type), <span class="at">fill =</span> <span class="fu">rainbow</span>(<span class="dv">5</span>), <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pt.cex =</span> <span class="dv">1</span>)</span>
<span id="cb836-5"><a href="the-game-sales-dataset.html#cb836-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="fl">1.2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">3.9</span>, <span class="fl">4.8</span>), <span class="dv">80000000</span>, <span class="fu">colnames</span>(x))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesRating1"></span>
<img src="book_files/figure-html/game-SalesRating1-1.png" alt="Sales by rating type." width="672" />
<p class="caption">
Figure 9.9: Sales by rating type.
</p>
</div>
<p>The figure shows one E game(for everyone) which was sold mainly in North America and Europe produced a sale tale of over 80 millions’ global sale, while North America contributed half of the global sales. We can check the game data and know it’s Wii Sports released in 2006. We also noticed that Mature games are popular in North America(green), which contributed a lot to global sales, Everyone games(red) have good sales in Europe, while Japanese like Teen(purple) and Everyone(red) games. The different ratings are balanced for the “other” region.</p>
</div>
<div id="by-genre" class="section level3" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> By Genre</h3>

<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="the-game-sales-dataset.html#cb837-1" aria-hidden="true" tabindex="-1"></a>game <span class="sc">%&gt;%</span> </span>
<span id="cb837-2"><a href="the-game-sales-dataset.html#cb837-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year.Release, Global.Sales.Log, Genre) <span class="sc">%&gt;%</span></span>
<span id="cb837-3"><a href="the-game-sales-dataset.html#cb837-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year.Release, Genre) <span class="sc">%&gt;%</span></span>
<span id="cb837-4"><a href="the-game-sales-dataset.html#cb837-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total.Sales.Log =</span> <span class="fu">sum</span>(Global.Sales.Log)) <span class="sc">%&gt;%</span></span>
<span id="cb837-5"><a href="the-game-sales-dataset.html#cb837-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year.Release, <span class="at">y =</span> Total.Sales.Log, <span class="at">group =</span> Genre, <span class="at">fill =</span> Genre)) <span class="sc">+</span></span>
<span id="cb837-6"><a href="the-game-sales-dataset.html#cb837-6" aria-hidden="true" tabindex="-1"></a>         <span class="fu">geom_area</span>() <span class="sc">+</span></span>
<span id="cb837-7"><a href="the-game-sales-dataset.html#cb837-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb837-8"><a href="the-game-sales-dataset.html#cb837-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb837-9"><a href="the-game-sales-dataset.html#cb837-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb837-10"><a href="the-game-sales-dataset.html#cb837-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">panel.grid.minor=</span><span class="fu">element_blank</span>()) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesGenre1"></span>
<img src="book_files/figure-html/game-SalesGenre1-1.png" alt="Year wise log global sales by Genre." width="672" />
<p class="caption">
Figure 9.10: Year wise log global sales by Genre.
</p>
</div>
<p>The figure shows the golden year for games are from 2007 to 2009. The games produced above 7000 total.sales.log in each of those years. Action and sports games keep on the top sale for almost all of those 20 years, which contribute the biggest portion of the total global sales log. Adventure, Puzzle, and Strategy are on the bottom of the sale log list.</p>
</div>
<div id="by-score" class="section level3" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> by Score</h3>

<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="the-game-sales-dataset.html#cb838-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> Critic.Score, <span class="at">y =</span> Global.Sales.Log)) <span class="sc">+</span> </span>
<span id="cb838-2"><a href="the-game-sales-dataset.html#cb838-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Genre)) <span class="sc">+</span> </span>
<span id="cb838-3"><a href="the-game-sales-dataset.html#cb838-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()  <span class="co"># Regression line</span></span>
<span id="cb838-4"><a href="the-game-sales-dataset.html#cb838-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> User.Score, <span class="at">y =</span> Global.Sales.Log)) <span class="sc">+</span> </span>
<span id="cb838-5"><a href="the-game-sales-dataset.html#cb838-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Rating)) <span class="sc">+</span> </span>
<span id="cb838-6"><a href="the-game-sales-dataset.html#cb838-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb838-7"><a href="the-game-sales-dataset.html#cb838-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesScore"></span>
<img src="book_files/figure-html/game-SalesScore-1.png" alt="Global sales by critic and user score." width="1152" />
<p class="caption">
Figure 9.11: Global sales by critic and user score.
</p>
</div>
<p>Independent from Genre and Rating, Critic Score increases with Global.Sales.Log. Especially for Critic.Score bigger than 9, Global.Sales.Log straightly rises. Global.Sales.Log rises very slowly with User.Score.</p>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="the-game-sales-dataset.html#cb839-1" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;Brain Age: Train Your Brain in Minutes a Day&quot;</span>,  <span class="co"># Shorten the game name</span></span>
<span id="cb839-2"><a href="the-game-sales-dataset.html#cb839-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Brain Age: Train Your Brain&quot;</span>, game<span class="sc">$</span>Name)</span>
<span id="cb839-3"><a href="the-game-sales-dataset.html#cb839-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span> </span>
<span id="cb839-4"><a href="the-game-sales-dataset.html#cb839-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name, User.Score, Critic.Score, Global.Sales) <span class="sc">%&gt;%</span></span>
<span id="cb839-5"><a href="the-game-sales-dataset.html#cb839-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Name) <span class="sc">%&gt;%</span></span>
<span id="cb839-6"><a href="the-game-sales-dataset.html#cb839-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total.Sales =</span> <span class="fu">sum</span>(Global.Sales), <span class="at">Avg.User.Score =</span> <span class="fu">mean</span>(User.Score), </span>
<span id="cb839-7"><a href="the-game-sales-dataset.html#cb839-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">Avg.Critic.Score =</span> <span class="fu">mean</span>(Critic.Score)) <span class="sc">%&gt;%</span></span>
<span id="cb839-8"><a href="the-game-sales-dataset.html#cb839-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total.Sales)) <span class="sc">%&gt;%</span></span>
<span id="cb839-9"><a href="the-game-sales-dataset.html#cb839-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb839-10"><a href="the-game-sales-dataset.html#cb839-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p1, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Name, <span class="at">levels =</span> Name))) <span class="sc">+</span></span>
<span id="cb839-11"><a href="the-game-sales-dataset.html#cb839-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> Total.Sales<span class="sc">/</span><span class="dv">10000000</span>), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb839-12"><a href="the-game-sales-dataset.html#cb839-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg.User.Score, <span class="at">group =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;Avg.User.Score&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb839-13"><a href="the-game-sales-dataset.html#cb839-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="fu">aes</span>(<span class="at">y =</span> Avg.User.Score), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;Yellow&quot;</span> ) <span class="sc">+</span></span>
<span id="cb839-14"><a href="the-game-sales-dataset.html#cb839-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg.Critic.Score,  <span class="at">group =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;Avg.Critic.Score&quot;</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb839-15"><a href="the-game-sales-dataset.html#cb839-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Avg.Critic.Score), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb839-16"><a href="the-game-sales-dataset.html#cb839-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb839-17"><a href="the-game-sales-dataset.html#cb839-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Top Global Sales Game with Score&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Name of the top games&quot;</span> ) <span class="sc">+</span>  </span>
<span id="cb839-18"><a href="the-game-sales-dataset.html#cb839-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-493-1.png" width="672" /></p>
<p>Among these 20 top sale games, the first two games, Wii Sports and Grand Theft Auto V have much better sales than the others. For most games, the average critic score is higher than the average user score, which agrees with our density plot in Figure <a href="the-game-sales-dataset.html#fig:game-score">9.5</a>. Two Call of Duty games got a much lower average user score comparing with other top sales games.</p>
</div>
<div id="by-rating-genre-critic-score" class="section level3" number="9.5.6">
<h3><span class="header-section-number">9.5.6</span> By Rating &amp; Genre &amp; Critic score</h3>

<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="the-game-sales-dataset.html#cb840-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span></span>
<span id="cb840-2"><a href="the-game-sales-dataset.html#cb840-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Rating.type, Global.Sales, Genre, Critic.Score) <span class="sc">%&gt;%</span></span>
<span id="cb840-3"><a href="the-game-sales-dataset.html#cb840-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Rating.type, Genre) <span class="sc">%&gt;%</span></span>
<span id="cb840-4"><a href="the-game-sales-dataset.html#cb840-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total.Sales =</span> <span class="fu">sum</span>(Global.Sales) <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">8</span>, <span class="at">Avg.Score =</span> <span class="fu">mean</span>(Critic.Score)) </span>
<span id="cb840-5"><a href="the-game-sales-dataset.html#cb840-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p1 <span class="sc">%&gt;%</span> </span>
<span id="cb840-6"><a href="the-game-sales-dataset.html#cb840-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Genre) <span class="sc">%&gt;%</span> </span>
<span id="cb840-7"><a href="the-game-sales-dataset.html#cb840-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg.Critic.Score =</span> <span class="fu">mean</span>(Avg.Score))</span>
<span id="cb840-8"><a href="the-game-sales-dataset.html#cb840-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb840-9"><a href="the-game-sales-dataset.html#cb840-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data =</span> p1, <span class="fu">aes</span>(<span class="at">x =</span> Genre, <span class="at">y =</span> Total.Sales, <span class="at">fill =</span> Rating.type), </span>
<span id="cb840-10"><a href="the-game-sales-dataset.html#cb840-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">&quot;Identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb840-11"><a href="the-game-sales-dataset.html#cb840-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> p2, </span>
<span id="cb840-12"><a href="the-game-sales-dataset.html#cb840-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Genre, <span class="at">y =</span> Avg.Critic.Score, <span class="at">group =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;Avg.Critic.Score&quot;</span>), </span>
<span id="cb840-13"><a href="the-game-sales-dataset.html#cb840-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb840-14"><a href="the-game-sales-dataset.html#cb840-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> p2, <span class="fu">aes</span>(<span class="at">x =</span> Genre, <span class="at">y =</span> Avg.Critic.Score, <span class="at">shape =</span> <span class="st">&quot;Avg.Critic.Score&quot;</span>), </span>
<span id="cb840-15"><a href="the-game-sales-dataset.html#cb840-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;Blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb840-16"><a href="the-game-sales-dataset.html#cb840-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="st">&quot;Score&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;Avg.Critic.Score&quot;</span>, <span class="at">values =</span> <span class="st">&quot;yellow&quot;</span>) <span class="sc">+</span> </span>
<span id="cb840-17"><a href="the-game-sales-dataset.html#cb840-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="st">&quot;Score&quot;</span>, <span class="at">values =</span> <span class="dv">19</span>) <span class="sc">+</span>   <span class="co"># Add scale for line and point plot</span></span>
<span id="cb840-18"><a href="the-game-sales-dataset.html#cb840-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>), </span>
<span id="cb840-19"><a href="the-game-sales-dataset.html#cb840-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb840-20"><a href="the-game-sales-dataset.html#cb840-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb840-21"><a href="the-game-sales-dataset.html#cb840-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb840-22"><a href="the-game-sales-dataset.html#cb840-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-Sales1"></span>
<img src="book_files/figure-html/game-Sales1-1.png" alt="Total sales for genre and rating with critic score." width="1152" />
<p class="caption">
Figure 9.12: Total sales for genre and rating with critic score.
</p>
</div>
<p>Among genre &amp; rating &amp; Global.sale combinations, Everyone*sports game is so popular that it occupies the first in global sales among all combinations. Rating Mature contributes big portions in both Action and Shooter global sales. On average these three genres, Action, Shooter, and Sports with top total sales show relatively higher critic scores. Fighting, adventure, and racing games get relatively lower average critic scores. We can also see from the figure that adventure, puzzle, and strategy do sell less comparing with other genres.</p>
</div>
<div id="by-platform" class="section level3" number="9.5.7">
<h3><span class="header-section-number">9.5.7</span> By Platform</h3>

<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="the-game-sales-dataset.html#cb841-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb841-2"><a href="the-game-sales-dataset.html#cb841-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb841-3"><a href="the-game-sales-dataset.html#cb841-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span></span>
<span id="cb841-4"><a href="the-game-sales-dataset.html#cb841-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Platform.type, Year.Release) <span class="sc">%&gt;%</span></span>
<span id="cb841-5"><a href="the-game-sales-dataset.html#cb841-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(Global.Sales))</span>
<span id="cb841-6"><a href="the-game-sales-dataset.html#cb841-6" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>Year.Release. <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(p<span class="sc">$</span>Year.Release))</span>
<span id="cb841-7"><a href="the-game-sales-dataset.html#cb841-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p, <span class="fu">aes</span>(<span class="at">x =</span> Year.Release., <span class="at">fill =</span> Platform.type)) <span class="sc">+</span></span>
<span id="cb841-8"><a href="the-game-sales-dataset.html#cb841-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="sc">+</span></span>
<span id="cb841-9"><a href="the-game-sales-dataset.html#cb841-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Market Share&quot;</span>) <span class="sc">+</span></span>
<span id="cb841-10"><a href="the-game-sales-dataset.html#cb841-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb841-11"><a href="the-game-sales-dataset.html#cb841-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>()) </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-SalesPlatform1"></span>
<img src="book_files/figure-html/game-SalesPlatform1-1.png" alt="Yearly market share by platform type." width="672" />
<p class="caption">
Figure 9.13: Yearly market share by platform type.
</p>
</div>
<p>Nintendo and Xbox came after 1990. Before that PC and Playstation occupied the game market, PC was the main platform at that time. After 1995, the portion of PC and Playstation shrank, while Nintendo and Xbox grew fast and took over more portion than Playstation and PC in the market. Together with Nintendo and Xbox, other game platforms sprouted out in early 1990s, but they last for about 20 years and disappeared. From around 2010, the portions of Nintendo, PC, Playstation, and Xbox kept relatively evenly and stably.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="the-game-sales-dataset.html#cb842-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 1-way ANOVA test for log value of global sales by Platform Type</span></span>
<span id="cb842-2"><a href="the-game-sales-dataset.html#cb842-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Global.Sales.Log <span class="sc">~</span> Platform.type, <span class="at">data =</span> game)</span>
<span id="cb842-3"><a href="the-game-sales-dataset.html#cb842-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>##                 Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Platform.type    4   1283   320.8   181.2 &lt;2e-16 ***
## Residuals     6820  12077     1.8                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="the-game-sales-dataset.html#cb844-1" aria-hidden="true" tabindex="-1"></a>tukey <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(model)</span>
<span id="cb844-2"><a href="the-game-sales-dataset.html#cb844-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb844-3"><a href="the-game-sales-dataset.html#cb844-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey, <span class="at">las =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-494-1.png" width="672" /></p>
<p>ANOVA test shows that at least one of the mean values of Global.Sales.Log for those platform types is significantly different from the others. In detail, the plot of Turkey tests tells us that there is a significant difference between all other pairs of platform types but between Xbox and Nintendo, others and Nintendo.</p>

<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="the-game-sales-dataset.html#cb845-1" aria-hidden="true" tabindex="-1"></a>game<span class="sc">$</span>Platform.type <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(game<span class="sc">$</span>Platform.type)</span>
<span id="cb845-2"><a href="the-game-sales-dataset.html#cb845-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(game, <span class="fu">aes</span>(<span class="at">x =</span> Platform.type, <span class="at">y =</span> Global.Sales.Log, <span class="at">fill =</span> Rating.type)) <span class="sc">+</span></span>
<span id="cb845-3"><a href="the-game-sales-dataset.html#cb845-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-PlatformRating"></span>
<img src="book_files/figure-html/game-PlatformRating-1.png" alt="Global sales log by platform and rating type." width="960" />
<p class="caption">
Figure 9.14: Global sales log by platform and rating type.
</p>
</div>
<p>In total, PC has lower Global sales log comparing with other platform types, while Playstation and Xbox have higher sale mediums for different rating types. Rating of Everyone sold pretty well in all platform types, while rating Mature sold better in PC, Playstation and Xbox.</p>

<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="the-game-sales-dataset.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(game, <span class="fu">aes</span>(Critic.Score, Global.Sales.Log, <span class="at">color =</span> Platform.type)) <span class="sc">+</span> </span>
<span id="cb846-2"><a href="the-game-sales-dataset.html#cb846-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb846-3"><a href="the-game-sales-dataset.html#cb846-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Genre)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-PlatformScore"></span>
<img src="book_files/figure-html/game-PlatformScore-1.png" alt="Global sales log by critic score for different platform type and genre." width="960" />
<p class="caption">
Figure 9.15: Global sales log by critic score for different platform type and genre.
</p>
</div>
<p>Most genre plots in Figure <a href="the-game-sales-dataset.html#fig:game-PlatformScore">9.15</a> illustrate that there is positive correlation between Global.Sales.Log and Critic Score, the higher the critic score, the better the global sales log value. Most puzzle games were from Nintendo, while lots of stratege games are PC. For other genres, all platforms shared the portion relatively evenly. Lots of PC(green) shared lower market portion in different genres, while some of Nintendo(red) games in sports, racing, platform, and misc were sold very well. At the same time, Playstation with the genre of action, fighting, and racing games, Xbox with the genre of misc, action, and shooter games show higher global sales log too.</p>
</div>
</div>
<div id="effect-of-platform-type-to-priciple-components" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Effect of platform type to priciple components</h2>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="the-game-sales-dataset.html#cb847-1" aria-hidden="true" tabindex="-1"></a>st <span class="ot">&lt;-</span> game[, <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">17</span><span class="sc">:</span><span class="dv">23</span>)]</span>
<span id="cb847-2"><a href="the-game-sales-dataset.html#cb847-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(st, <span class="at">scale =</span> T)  <span class="co"># Scale = T to normalize the data</span></span>
<span id="cb847-3"><a href="the-game-sales-dataset.html#cb847-3" aria-hidden="true" tabindex="-1"></a>percentVar <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">summary</span>(pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>], <span class="dv">0</span>)  <span class="co"># Compute % variances</span></span></code></pre></div>

<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="the-game-sales-dataset.html#cb848-1" aria-hidden="true" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="co"># First and Second principal component value</span></span>
<span id="cb848-2"><a href="the-game-sales-dataset.html#cb848-2" aria-hidden="true" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pcaData, game<span class="sc">$</span>Platform.type)  <span class="co"># Add platform type as third col. for cluster purpose</span></span>
<span id="cb848-3"><a href="the-game-sales-dataset.html#cb848-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pcaData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;Platform&quot;</span>)</span>
<span id="cb848-4"><a href="the-game-sales-dataset.html#cb848-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pcaData, <span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Platform, <span class="at">shape =</span> Platform)) <span class="sc">+</span>  </span>
<span id="cb848-5"><a href="the-game-sales-dataset.html#cb848-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb848-6"><a href="the-game-sales-dataset.html#cb848-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">paste0</span>(<span class="st">&quot;PC1: &quot;</span>, percentVar[<span class="dv">1</span>], <span class="st">&quot;% variance&quot;</span>)) <span class="sc">+</span>  <span class="co"># x label</span></span>
<span id="cb848-7"><a href="the-game-sales-dataset.html#cb848-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">paste0</span>(<span class="st">&quot;PC2: &quot;</span>, percentVar[<span class="dv">2</span>], <span class="st">&quot;% variance&quot;</span>)) <span class="sc">+</span>  <span class="co"># y label</span></span>
<span id="cb848-8"><a href="the-game-sales-dataset.html#cb848-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)  <span class="co"># Width and height ratio</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-pca"></span>
<img src="book_files/figure-html/game-pca-1.png" alt="PCA plot colored with platform type." width="672" />
<p class="caption">
Figure 9.16: PCA plot colored with platform type.
</p>
</div>
<p>PC, Xbox, Playstation and Nintendo occupy in their own positions in the PCA figure, which illustrates that they play different important role in components of the variance of PC1 and PC2.</p>

<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="the-game-sales-dataset.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb849-2"><a href="the-game-sales-dataset.html#cb849-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb849-3"><a href="the-game-sales-dataset.html#cb849-3" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">kmeans</span>(st, <span class="dv">3</span>), <span class="at">data =</span> st, <span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">label.size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:game-Kmeans"></span>
<img src="book_files/figure-html/game-Kmeans-1.png" alt="Kmeans PCA figure using ggfortify." width="672" />
<p class="caption">
Figure 9.17: Kmeans PCA figure using ggfortify.
</p>
</div>
<p>Together with PCA Figure <a href="the-game-sales-dataset.html#fig:game-pca">9.16</a>, we will find that the first cluster is contributed mainly by Playstation, Xbox, Nintendo, and PC. The second cluster is contributed mainly by Xbox, Nintendo and Playstation. PC and Playstation build the third cluster.</p>
</div>
<div id="models-for-global-sales" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Models for global sales</h2>
<p>Because there are too many levels in Publisher and Developer, and there is an apparent correlation between them, we use only the top 12 levels of Publisher and classified the other publishers as “Others”; Because of the good correlation between Critic.Score and User.Score, we use only critic score; Also we use only log value of user score count because of its closer correlation to global sales log. We will not put other sales log variables in our model because of their apparent correlation with the global sales log.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="the-game-sales-dataset.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-categorize publisher into 13 groups</span></span>
<span id="cb850-2"><a href="the-game-sales-dataset.html#cb850-2" aria-hidden="true" tabindex="-1"></a>Publisher. <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(game<span class="sc">$</span>Publisher), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)), <span class="dv">12</span>)</span>
<span id="cb850-3"><a href="the-game-sales-dataset.html#cb850-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-4"><a href="the-game-sales-dataset.html#cb850-4" aria-hidden="true" tabindex="-1"></a>game <span class="ot">&lt;-</span> game <span class="sc">%&gt;%</span></span>
<span id="cb850-5"><a href="the-game-sales-dataset.html#cb850-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Publisher.type =</span> <span class="fu">ifelse</span>(Publisher <span class="sc">%in%</span> Publisher., <span class="fu">as.character</span>(Publisher), <span class="st">&quot;Others&quot;</span>)) </span>
<span id="cb850-6"><a href="the-game-sales-dataset.html#cb850-6" aria-hidden="true" tabindex="-1"></a>game.lm <span class="ot">&lt;-</span> game[, <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">21</span>, <span class="dv">23</span><span class="sc">:</span><span class="dv">26</span>)] <span class="co"># Take columns for linear model</span></span></code></pre></div>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="the-game-sales-dataset.html#cb851-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Global.Sales.Log <span class="sc">~</span> ., <span class="at">data =</span> game.lm)</span>
<span id="cb851-2"><a href="the-game-sales-dataset.html#cb851-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Global.Sales.Log ~ ., data = game.lm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.9221 -0.5558  0.0254  0.5789  4.1009 
## 
## Coefficients:
##                                             Estimate Std. Error t value
## (Intercept)                                10.187752   0.922104  11.048
## Year.Release1988                           -3.088268   1.300919  -2.374
## Year.Release1992                           -1.796072   1.300851  -1.381
## Year.Release1994                            2.930510   1.302000   2.251
## Year.Release1996                            1.488582   0.987461   1.507
## Year.Release1997                            1.188658   0.955613   1.244
## Year.Release1998                            0.744742   0.939532   0.793
## Year.Release1999                            0.653088   0.936406   0.697
## Year.Release2000                            0.785921   0.925467   0.849
## Year.Release2001                            0.772488   0.922728   0.837
## Year.Release2002                            0.570865   0.922008   0.619
## Year.Release2003                            0.340110   0.921843   0.369
## Year.Release2004                            0.550812   0.921901   0.597
## Year.Release2005                            0.210534   0.921694   0.228
## Year.Release2006                            0.141533   0.921703   0.154
## Year.Release2007                            0.373361   0.921629   0.405
## Year.Release2008                            0.529829   0.921677   0.575
## Year.Release2009                            0.446508   0.921648   0.484
## Year.Release2010                            0.596658   0.921889   0.647
## Year.Release2011                            0.389514   0.921944   0.422
## Year.Release2012                           -0.031458   0.922540  -0.034
## Year.Release2013                           -0.170252   0.922985  -0.184
## Year.Release2014                           -0.383671   0.923096  -0.416
## Year.Release2015                           -0.478979   0.923302  -0.519
## Year.Release2016                           -0.826950   0.923192  -0.896
## GenreAdventure                             -0.335989   0.063305  -5.307
## GenreFighting                               0.072835   0.055338   1.316
## GenreMisc                                   0.357196   0.054323   6.575
## GenrePlatform                              -0.184139   0.054854  -3.357
## GenrePuzzle                                -0.345253   0.091582  -3.770
## GenreRacing                                -0.097943   0.048451  -2.021
## GenreRole-Playing                          -0.357837   0.043093  -8.304
## GenreShooter                               -0.142624   0.040372  -3.533
## GenreSimulation                             0.405629   0.060887   6.662
## GenreSports                                 0.011217   0.046986   0.239
## GenreStrategy                              -0.483702   0.063838  -7.577
## Critic.Score                                0.114744   0.009865  11.632
## User.Count.Log                              0.615776   0.011589  53.134
## Platform.typeOthers                        -0.188799   0.066011  -2.860
## Platform.typePC                            -2.442802   0.051704 -47.246
## Platform.typePlaystation                    0.135254   0.033868   3.994
## Platform.typeXbox                          -0.106733   0.036927  -2.890
## Rating.typeE10+                            -0.058393   0.040759  -1.433
## Rating.typeM                               -0.467923   0.045704 -10.238
## Rating.typeOthers                           0.144593   0.545092   0.265
## Rating.typeT                               -0.331696   0.035692  -9.293
## Publisher.typeAtari                        -0.506235   0.082442  -6.141
## Publisher.typeCapcom                       -0.759855   0.078983  -9.620
## Publisher.typeElectronic Arts              -0.114754   0.053315  -2.152
## Publisher.typeKonami Digital Entertainment -0.705932   0.073042  -9.665
## Publisher.typeNamco Bandai Games           -0.569621   0.074819  -7.613
## Publisher.typeNintendo                      0.111592   0.074409   1.500
## Publisher.typeOthers                       -0.618870   0.046433 -13.328
## Publisher.typeSega                         -0.517708   0.069222  -7.479
## Publisher.typeSony Computer Entertainment  -0.585506   0.069125  -8.470
## Publisher.typeTake-Two Interactive         -0.276947   0.070848  -3.909
## Publisher.typeTHQ                          -0.117032   0.068824  -1.700
## Publisher.typeUbisoft                      -0.377192   0.059101  -6.382
##                                            Pr(&gt;|t|)    
## (Intercept)                                 &lt; 2e-16 ***
## Year.Release1988                           0.017628 *  
## Year.Release1992                           0.167420    
## Year.Release1994                           0.024432 *  
## Year.Release1996                           0.131733    
## Year.Release1997                           0.213591    
## Year.Release1998                           0.427996    
## Year.Release1999                           0.485550    
## Year.Release2000                           0.395791    
## Year.Release2001                           0.402522    
## Year.Release2002                           0.535836    
## Year.Release2003                           0.712180    
## Year.Release2004                           0.550211    
## Year.Release2005                           0.819326    
## Year.Release2006                           0.877964    
## Year.Release2007                           0.685409    
## Year.Release2008                           0.565410    
## Year.Release2009                           0.628070    
## Year.Release2010                           0.517516    
## Year.Release2011                           0.672679    
## Year.Release2012                           0.972799    
## Year.Release2013                           0.853660    
## Year.Release2014                           0.677690    
## Year.Release2015                           0.603940    
## Year.Release2016                           0.370418    
## GenreAdventure                             1.15e-07 ***
## GenreFighting                              0.188157    
## GenreMisc                                  5.22e-11 ***
## GenrePlatform                              0.000793 ***
## GenrePuzzle                                0.000165 ***
## GenreRacing                                0.043269 *  
## GenreRole-Playing                           &lt; 2e-16 ***
## GenreShooter                               0.000414 ***
## GenreSimulation                            2.91e-11 ***
## GenreSports                                0.811327    
## GenreStrategy                              4.01e-14 ***
## Critic.Score                                &lt; 2e-16 ***
## User.Count.Log                              &lt; 2e-16 ***
## Platform.typeOthers                        0.004248 ** 
## Platform.typePC                             &lt; 2e-16 ***
## Platform.typePlaystation                   6.58e-05 ***
## Platform.typeXbox                          0.003859 ** 
## Rating.typeE10+                            0.152006    
## Rating.typeM                                &lt; 2e-16 ***
## Rating.typeOthers                          0.790814    
## Rating.typeT                                &lt; 2e-16 ***
## Publisher.typeAtari                        8.69e-10 ***
## Publisher.typeCapcom                        &lt; 2e-16 ***
## Publisher.typeElectronic Arts              0.031403 *  
## Publisher.typeKonami Digital Entertainment  &lt; 2e-16 ***
## Publisher.typeNamco Bandai Games           3.04e-14 ***
## Publisher.typeNintendo                     0.133735    
## Publisher.typeOthers                        &lt; 2e-16 ***
## Publisher.typeSega                         8.44e-14 ***
## Publisher.typeSony Computer Entertainment   &lt; 2e-16 ***
## Publisher.typeTake-Two Interactive         9.36e-05 ***
## Publisher.typeTHQ                          0.089092 .  
## Publisher.typeUbisoft                      1.86e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9177 on 6767 degrees of freedom
## Multiple R-squared:  0.5735, Adjusted R-squared:  0.5699 
## F-statistic: 159.6 on 57 and 6767 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="the-game-sales-dataset.html#cb853-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Global.Sales.Log <span class="sc">~</span> ., <span class="at">data =</span> game.lm)</span>
<span id="cb853-2"><a href="the-game-sales-dataset.html#cb853-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Year.Release     24    521    21.7   25.78 &lt;2e-16 ***
## Genre            11    527    47.9   56.87 &lt;2e-16 ***
## Critic.Score      1   1771  1771.3 2103.34 &lt;2e-16 ***
## User.Count.Log    1   1344  1344.0 1595.92 &lt;2e-16 ***
## Platform.type     4   2944   736.1  874.11 &lt;2e-16 ***
## Rating.type       4    165    41.2   48.93 &lt;2e-16 ***
## Publisher.type   12    389    32.4   38.53 &lt;2e-16 ***
## Residuals      6767   5699     0.8                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Log value of lobal sales is mostly affected by factors of critic score, user count log, platform type, Publisher type, and genre in glm analysis. ANOVA shows every factor is significant in the contribution to the log value of global sales. Critic.Score and User.Count.Log are the most important factors.</p>
<p>Critic.Score and User.Count.Log positively affect the global sales log, while other factors like Platform type and Genre either lift up or pull down the global sales according to their types. This model will explain the global sales log with an R-Square of 0.57.</p>
<p>Because of the curve smooth line at plot of global sale ~ critic score in our previous analysis(Figure <a href="the-game-sales-dataset.html#fig:game-SalesScore">9.11</a>) and critic score’s big contribution in linear model analysis, We try a polynomial fit of critic score only.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="the-game-sales-dataset.html#cb855-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Global.Sales.Log <span class="sc">~</span> </span>
<span id="cb855-2"><a href="the-game-sales-dataset.html#cb855-2" aria-hidden="true" tabindex="-1"></a>           Critic.Score <span class="sc">+</span> <span class="fu">I</span>(Critic.Score<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(Critic.Score<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(Critic.Score<span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb855-3"><a href="the-game-sales-dataset.html#cb855-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> game.lm)</span>
<span id="cb855-4"><a href="the-game-sales-dataset.html#cb855-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Global.Sales.Log ~ Critic.Score + I(Critic.Score^2) + 
##     I(Critic.Score^3) + I(Critic.Score^4), data = game.lm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.0029 -0.7972  0.0916  0.8801  5.6201 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       12.030638   1.468428   8.193 3.02e-16 ***
## Critic.Score      -0.840810   1.095444  -0.768   0.4428    
## I(Critic.Score^2)  0.385671   0.292104   1.320   0.1868    
## I(Critic.Score^3) -0.060971   0.033147  -1.839   0.0659 .  
## I(Critic.Score^4)  0.003434   0.001358   2.528   0.0115 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.281 on 6820 degrees of freedom
## Multiple R-squared:  0.1623, Adjusted R-squared:  0.1618 
## F-statistic: 330.4 on 4 and 6820 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The first two levels are not statistically significant according to our pre-analysis, so here we use the third and fourth levels only.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="the-game-sales-dataset.html#cb857-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Global.Sales.Log <span class="sc">~</span> <span class="fu">I</span>(Critic.Score<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(Critic.Score<span class="sc">^</span><span class="dv">4</span>),  <span class="at">data =</span> game.lm)</span>
<span id="cb857-2"><a href="the-game-sales-dataset.html#cb857-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Global.Sales.Log ~ I(Critic.Score^3) + I(Critic.Score^4), 
##     data = game.lm)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8634 -0.7892  0.0950  0.8837  5.5807 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        1.193e+01  7.115e-02 167.722  &lt; 2e-16 ***
## I(Critic.Score^3) -2.989e-03  7.972e-04  -3.749 0.000179 ***
## I(Critic.Score^4)  6.076e-04  8.224e-05   7.387 1.67e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.283 on 6822 degrees of freedom
## Multiple R-squared:  0.1597, Adjusted R-squared:  0.1595 
## F-statistic: 648.3 on 2 and 6822 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In total, the coefficients are statistically significant, the model of two levels of critic score itself will explain the Global.Sales.Log with R square 0.16.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="the-game-sales-dataset.html#cb859-1" aria-hidden="true" tabindex="-1"></a>ModelFunc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {model<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> x<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>model<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb859-2"><a href="the-game-sales-dataset.html#cb859-2" aria-hidden="true" tabindex="-1"></a>                          x<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>model<span class="sc">$</span>coefficients[<span class="dv">3</span>]}</span>
<span id="cb859-3"><a href="the-game-sales-dataset.html#cb859-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> game.lm, <span class="fu">aes</span>(<span class="at">x =</span> Critic.Score, <span class="at">y =</span> Global.Sales.Log)) <span class="sc">+</span> </span>
<span id="cb859-4"><a href="the-game-sales-dataset.html#cb859-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb859-5"><a href="the-game-sales-dataset.html#cb859-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> ModelFunc, <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-500-1.png" width="672" /></p>
<p>Here is the scatter plot of Global.Sales.Log ~ Critic Score and the model line which predicts the global sales log using critic score.</p>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-501" class="exercise"><strong>Exercise 9.4  </strong></span></p>
Use different plots to visualize the distribution of NA_Sales by Year_of_Release, Genre, Rating, and Platform individually or combinedly. Explain the relationship between NA_Sales with these factors. Hint: Take log value for NA_Sales first. It is better to regroup the platform first.
</div>
</blockquote>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-502" class="exercise"><strong>Exercise 9.5  </strong></span></p>
What is the correlation between NA_Sales and Critic_Score? Use scatter plot with smooth line or polynomial model line to show the trend. Give your interpretation.
</div>
</blockquote>
<blockquote>

<div class="exercise">
<p><span id="exr:unnamed-chunk-503" class="exercise"><strong>Exercise 9.6  </strong></span></p>
Use linear model and ANOVA to analyze NA_Sales with all the factors which contribute to its variance. Interpret your result briefly. Hint: Check the corrplot in Figure <a href="the-game-sales-dataset.html#fig:game-corrplot">9.3</a> and pay attention to the high correlation among those sales and between those scores.
</div>
</blockquote>
</div>
<div id="conclusion-1" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Conclusion</h2>
<p>Global and regional sales are not distributed normally, while their log values are close to normal distribution. Most regional sales have similar pattern as global sales.</p>
<p>There is a positive correlation between critic score and user score. In total, Critic score is lower than user score for most games. No apparent correlation was found between scores and their counts.</p>
<p>Critic score, user score count log, genre, rating, platform, and publisher together affect the global sales log. Critic score is the most important contributor.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-state-dataset.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-messy-salary-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
