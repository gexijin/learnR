<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Visualizing the iris flower data set | Learn R through examples</title>
  <meta name="description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Visualizing the iris flower data set | Learn R through examples" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="github-repo" content="gexijin/learnR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Visualizing the iris flower data set | Learn R through examples" />
  
  <meta name="twitter:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  

<meta name="author" content="Xijin Ge, Jianli Qi, and Rong Fan" />


<meta name="date" content="2024-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="step-into-r-programmingthe-iris-flower-dataset.html"/>
<link rel="next" href="data-structures.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html"><i class="fa fa-check"></i><b>1</b> Step into R programming:The iris flower dataset</a>
<ul>
<li class="chapter" data-level="1.1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting started</a></li>
<li class="chapter" data-level="1.2" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#the-proper-way-of-using-rstudio"><i class="fa fa-check"></i><b>1.2</b> The proper way of using RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#data-frames-contain-rows-and-columns-the-iris-flower-dataset"><i class="fa fa-check"></i><b>1.3</b> Data frames contain rows and columns: the iris flower dataset</a></li>
<li class="chapter" data-level="1.4" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-one-set-of-numbers"><i class="fa fa-check"></i><b>1.4</b> Analyzing one set of numbers</a></li>
<li class="chapter" data-level="1.5" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-a-categorical-variable"><i class="fa fa-check"></i><b>1.5</b> Analyzing a categorical variable</a></li>
<li class="chapter" data-level="1.6" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#the-relationship-between-two-numerical-variables"><i class="fa fa-check"></i><b>1.6</b> The relationship between two numerical variables</a></li>
<li class="chapter" data-level="1.7" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-the-differences-between-two-groups"><i class="fa fa-check"></i><b>1.7</b> Testing the differences between two groups</a></li>
<li class="chapter" data-level="1.8" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-differences-among-multiple-groups-anova"><i class="fa fa-check"></i><b>1.8</b> Testing differences among multiple groups (ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html"><i class="fa fa-check"></i><b>2</b> Visualizing the iris flower data set</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#basic-concepts-of-r-graphics"><i class="fa fa-check"></i><b>2.1</b> Basic concepts of R graphics</a></li>
<li class="chapter" data-level="2.2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#scatter-plot-matrix"><i class="fa fa-check"></i><b>2.2</b> Scatter plot matrix</a></li>
<li class="chapter" data-level="2.3" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#star-and-segment-diagrams"><i class="fa fa-check"></i><b>2.3</b> Star and segment diagrams</a></li>
<li class="chapter" data-level="2.4" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#the-ggplot2-package-is-intuitive-and-powerful"><i class="fa fa-check"></i><b>2.4</b> The ggplot2 package is intuitive and powerful</a></li>
<li class="chapter" data-level="2.5" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#other-types-of-plots-with-ggplot2"><i class="fa fa-check"></i><b>2.5</b> Other types of plots with ggplot2</a></li>
<li class="chapter" data-level="2.6" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#hierarchical-clustering-and-heat-map"><i class="fa fa-check"></i><b>2.6</b> Hierarchical clustering and heat map</a></li>
<li class="chapter" data-level="2.7" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>2.7</b> Principal component analysis (PCA)</a></li>
<li class="chapter" data-level="2.8" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#logistic-regression-for-binary-outcomes-prediction"><i class="fa fa-check"></i><b>2.8</b> Logistic Regression for Binary Outcomes Prediction</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-structures.html"><a href="data-structures.html#basic-concepts"><i class="fa fa-check"></i><b>3.1</b> Basic concepts</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-structures.html"><a href="data-structures.html#expressions"><i class="fa fa-check"></i><b>3.1.1</b> Expressions</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-structures.html"><a href="data-structures.html#logical-values"><i class="fa fa-check"></i><b>3.1.2</b> Logical Values</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-structures.html"><a href="data-structures.html#variables"><i class="fa fa-check"></i><b>3.1.3</b> Variables</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-structures.html"><a href="data-structures.html#functions"><i class="fa fa-check"></i><b>3.1.4</b> Functions</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-structures.html"><a href="data-structures.html#seeking-help-and-example-code"><i class="fa fa-check"></i><b>3.1.5</b> Seeking help and example Code</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-structures.html"><a href="data-structures.html#data-structures-1"><i class="fa fa-check"></i><b>3.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>3.2.2</b> Matrices</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>3.2.3</b> Data Frames</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-structures.html"><a href="data-structures.html#strings-and-string-vectors"><i class="fa fa-check"></i><b>3.2.4</b> Strings and string vectors</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.2.5</b> Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html"><i class="fa fa-check"></i><b>4</b> Importing data and managing files</a>
<ul>
<li class="chapter" data-level="4.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#project-oriented-workflow"><i class="fa fa-check"></i><b>4.1</b> Project-oriented workflow</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-project-in-a-new-folder"><i class="fa fa-check"></i><b>4.1.1</b> Create a project in a new folder</a></li>
<li class="chapter" data-level="4.1.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-script-file-and-comment-please"><i class="fa fa-check"></i><b>4.1.2</b> Create a script file (and Comment, Please!)</a></li>
<li class="chapter" data-level="4.1.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#copy-data-files-to-the-new-directory"><i class="fa fa-check"></i><b>4.1.3</b> Copy data files to the new directory</a></li>
<li class="chapter" data-level="4.1.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#import-data-files"><i class="fa fa-check"></i><b>4.1.4</b> Import data files</a></li>
<li class="chapter" data-level="4.1.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#check-and-convert-data-types"><i class="fa fa-check"></i><b>4.1.5</b> Check and convert data types</a></li>
<li class="chapter" data-level="4.1.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#close-a-project-when-you-are-done"><i class="fa fa-check"></i><b>4.1.6</b> Close a project when you are done</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#read-files-directly-using-read.table"><i class="fa fa-check"></i><b>4.2</b> Read files directly using read.table</a></li>
<li class="chapter" data-level="4.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#general-procedure-to-read-data-into-r"><i class="fa fa-check"></i><b>4.3</b> General procedure to read data into R:</a></li>
<li class="chapter" data-level="4.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#enter-data-manually"><i class="fa fa-check"></i><b>4.4</b> Enter data manually</a></li>
<li class="chapter" data-level="4.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-manipulation-in-a-data-frame"><i class="fa fa-check"></i><b>4.5</b> Data manipulation in a data frame</a></li>
<li class="chapter" data-level="4.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-transformation-using-the-dplyr"><i class="fa fa-check"></i><b>4.6</b> Data transformation using the dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html"><i class="fa fa-check"></i><b>5</b> The heart attack data set (I)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#begin-your-analysis-by-examining-each-column-individually"><i class="fa fa-check"></i><b>5.1</b> Begin your analysis by examining each column individually</a></li>
<li class="chapter" data-level="5.2" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#possible-correlation-between-two-numeric-columns"><i class="fa fa-check"></i><b>5.2</b> Possible correlation between two numeric columns</a></li>
<li class="chapter" data-level="5.3" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Associations between categorical variables</a></li>
<li class="chapter" data-level="5.4" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-a-categorical-and-a-numeric-variables"><i class="fa fa-check"></i><b>5.4</b> Associations between a categorical and a numeric variables</a></li>
<li class="chapter" data-level="5.5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-multiple-columns"><i class="fa fa-check"></i><b>5.5</b> Associations between multiple columns</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html"><i class="fa fa-check"></i><b>6</b> The heart attack dataset (II)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#scatter-plot-in-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Scatter plot in ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>6.2</b> Histograms and density plots</a></li>
<li class="chapter" data-level="6.3" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#box-plots-and-violin-plots"><i class="fa fa-check"></i><b>6.3</b> Box plots and Violin plots</a></li>
<li class="chapter" data-level="6.4" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#bar-plot-with-error-bars"><i class="fa fa-check"></i><b>6.4</b> Bar plot with error bars</a></li>
<li class="chapter" data-level="6.5" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#statistical-models-easy-to-run-tricky-to-interpret"><i class="fa fa-check"></i><b>6.5</b> Statistical models: Easy to Run, tricky to interpret!</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-topics.html"><a href="advanced-topics.html"><i class="fa fa-check"></i><b>7</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-topics.html"><a href="advanced-topics.html#introduction-to-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Introduction to R Markdown</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-topics.html"><a href="advanced-topics.html#tidyverse"><i class="fa fa-check"></i><b>7.2</b> Tidyverse</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-topics.html"><a href="advanced-topics.html#interactive-plots-made-easy-with-plotly"><i class="fa fa-check"></i><b>7.3</b> Interactive plots made easy with Plotly</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-topics.html"><a href="advanced-topics.html#shiny-apps"><i class="fa fa-check"></i><b>7.4</b> Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-topics.html"><a href="advanced-topics.html#install-the-shiny-package"><i class="fa fa-check"></i><b>7.4.1</b> Install the Shiny package</a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-topics.html"><a href="advanced-topics.html#create-a-shiny-web-app-is-a-piece-of-cake"><i class="fa fa-check"></i><b>7.4.2</b> Create a Shiny web app is a piece of cake</a></li>
<li class="chapter" data-level="7.4.3" data-path="advanced-topics.html"><a href="advanced-topics.html#lets-play"><i class="fa fa-check"></i><b>7.4.3</b> Let’s play!</a></li>
<li class="chapter" data-level="7.4.4" data-path="advanced-topics.html"><a href="advanced-topics.html#publish-your-app"><i class="fa fa-check"></i><b>7.4.4</b> Publish your app</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-topics.html"><a href="advanced-topics.html#define-your-own-function"><i class="fa fa-check"></i><b>7.5</b> Define your own function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="state-dataset.html"><a href="state-dataset.html"><i class="fa fa-check"></i><b>8</b> State dataset</a>
<ul>
<li class="chapter" data-level="8.1" data-path="state-dataset.html"><a href="state-dataset.html#data-import-and-manipulation"><i class="fa fa-check"></i><b>8.1</b> Data Import and Manipulation</a></li>
<li class="chapter" data-level="8.2" data-path="state-dataset.html"><a href="state-dataset.html#visualizing-data"><i class="fa fa-check"></i><b>8.2</b> Visualizing data</a></li>
<li class="chapter" data-level="8.3" data-path="state-dataset.html"><a href="state-dataset.html#analyzing-the-relationship-among-variables"><i class="fa fa-check"></i><b>8.3</b> Analyzing the relationship among variables</a></li>
<li class="chapter" data-level="8.4" data-path="state-dataset.html"><a href="state-dataset.html#the-whole-picture-of-the-data-set"><i class="fa fa-check"></i><b>8.4</b> The whole picture of the data set</a></li>
<li class="chapter" data-level="8.5" data-path="state-dataset.html"><a href="state-dataset.html#linear-model-analysis"><i class="fa fa-check"></i><b>8.5</b> Linear model analysis</a></li>
<li class="chapter" data-level="8.6" data-path="state-dataset.html"><a href="state-dataset.html#conclusion"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html"><i class="fa fa-check"></i><b>9</b> The game sales dataset</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#reading-in-data-and-managing-the-dataset"><i class="fa fa-check"></i><b>9.1</b> Reading in data and managing the dataset</a></li>
<li class="chapter" data-level="9.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#visualization-of-categorical-variables"><i class="fa fa-check"></i><b>9.2</b> Visualization of categorical variables</a></li>
<li class="chapter" data-level="9.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#correlation-among-numeric-variables"><i class="fa fa-check"></i><b>9.3</b> Correlation among numeric variables</a></li>
<li class="chapter" data-level="9.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-score-and-count"><i class="fa fa-check"></i><b>9.4</b> Analysis of score and count</a></li>
<li class="chapter" data-level="9.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-sales"><i class="fa fa-check"></i><b>9.5</b> Analysis of sales</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-year.release"><i class="fa fa-check"></i><b>9.5.1</b> By Year.Release</a></li>
<li class="chapter" data-level="9.5.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-region"><i class="fa fa-check"></i><b>9.5.2</b> By Region</a></li>
<li class="chapter" data-level="9.5.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating"><i class="fa fa-check"></i><b>9.5.3</b> By Rating</a></li>
<li class="chapter" data-level="9.5.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-genre"><i class="fa fa-check"></i><b>9.5.4</b> By Genre</a></li>
<li class="chapter" data-level="9.5.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-score"><i class="fa fa-check"></i><b>9.5.5</b> by Score</a></li>
<li class="chapter" data-level="9.5.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating-genre-critic-score"><i class="fa fa-check"></i><b>9.5.6</b> By Rating &amp; Genre &amp; Critic score</a></li>
<li class="chapter" data-level="9.5.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-platform"><i class="fa fa-check"></i><b>9.5.7</b> By Platform</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#effect-of-platform-type-on-principle-components"><i class="fa fa-check"></i><b>9.6</b> Effect of platform type on principle components</a></li>
<li class="chapter" data-level="9.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#models-for-global-sales"><i class="fa fa-check"></i><b>9.7</b> Models for global sales</a></li>
<li class="chapter" data-level="9.8" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#conclusion-1"><i class="fa fa-check"></i><b>9.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html"><i class="fa fa-check"></i><b>10</b> The messy salary data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#data-preparation-and-cleaning"><i class="fa fa-check"></i><b>10.1</b> Data Preparation and Cleaning</a></li>
<li class="chapter" data-level="10.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#variable-analysis"><i class="fa fa-check"></i><b>10.2</b> Variable Analysis</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#income-and-age"><i class="fa fa-check"></i><b>10.2.1</b> Income and age</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group"><i class="fa fa-check"></i><b>10.2.2</b> Ethnic group</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex"><i class="fa fa-check"></i><b>10.2.3</b> Sex</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#union-descreption"><i class="fa fa-check"></i><b>10.2.4</b> Union descreption</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income"><i class="fa fa-check"></i><b>10.3</b> Analysis of gross income</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#age"><i class="fa fa-check"></i><b>10.3.1</b> Age</a></li>
<li class="chapter" data-level="10.3.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex-1"><i class="fa fa-check"></i><b>10.3.2</b> Sex</a></li>
<li class="chapter" data-level="10.3.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group-1"><i class="fa fa-check"></i><b>10.3.3</b> Ethnic Group</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income-types"><i class="fa fa-check"></i><b>10.4</b> Analysis of gross income types</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#defining-gross-income-types"><i class="fa fa-check"></i><b>10.4.1</b> Defining Gross income types</a></li>
<li class="chapter" data-level="10.4.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#the-intersection-of-ethnic-sex-and-age"><i class="fa fa-check"></i><b>10.4.2</b> The Intersection of Ethnic, Sex and age</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#lm-and-anova-analysis"><i class="fa fa-check"></i><b>10.5</b> LM and ANOVA analysis</a></li>
<li class="chapter" data-level="10.6" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#conclusion-2"><i class="fa fa-check"></i><b>10.6</b> Conclusion</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learn R through examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizing-the-iris-flower-data-set" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Visualizing the iris flower data set<a href="visualizing-the-iris-flower-data-set.html#visualizing-the-iris-flower-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Learning objectives:</p>
<ul>
<li>Understand basic concepts of R graphics</li>
<li>Install and load R packages</li>
<li>Create basic plots with ggplot2</li>
<li>Explore various methods to visualize the iris flower dataset</li>
</ul>
<div id="basic-concepts-of-r-graphics" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Basic concepts of R graphics<a href="visualizing-the-iris-flower-data-set.html#basic-concepts-of-r-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s start with base R graphics. We have two main categories of graphics functions in base R: high-level and low-level. High-level functions are the initiators, starting a new plot and setting the stage for further additions using low-level functions. Here’s a table for a clearer picture:</p>
<table>
<caption>High-level graphics functions that start a new plot.</caption>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>plot</td>
<td>Generic plotting function</td>
</tr>
<tr class="even">
<td>boxplot</td>
<td>boxplot. Works with matrix columns or equations (e.g., boxplot(y ~ x))</td>
</tr>
<tr class="odd">
<td>hist</td>
<td>histogram</td>
</tr>
<tr class="even">
<td>qqnorm</td>
<td>Quantile-quantile (Q-Q) plot to check for normality</td>
</tr>
<tr class="odd">
<td>curve</td>
<td>Graph an arithmetic function</td>
</tr>
<tr class="even">
<td>barplot</td>
<td>Barplot</td>
</tr>
<tr class="odd">
<td>mosaicplot</td>
<td>Using mosaics to represent the frequencies of tabulated counts.</td>
</tr>
<tr class="even">
<td>heatmap</td>
<td>Using colors to visualize a matrix of numeric values.</td>
</tr>
</tbody>
</table>
<p>In contrast, Low-level functions are the collaborators, adding elements to an existing plot without starting afresh, as shown below:</p>
<table>
<caption>Low-level graphics functions that add elements to an existing plot.</caption>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>points</td>
<td>Add points to a plot</td>
</tr>
<tr class="even">
<td>lines</td>
<td>Draw lines on a plot</td>
</tr>
<tr class="odd">
<td>abline</td>
<td>Plot a straight line</td>
</tr>
<tr class="even">
<td>segments</td>
<td>Add line segments</td>
</tr>
<tr class="odd">
<td>text</td>
<td>Insert text into a plot</td>
</tr>
<tr class="even">
<td>legend</td>
<td>Append a legend to a plot</td>
</tr>
<tr class="odd">
<td>arrows</td>
<td>Add arrows to a plot</td>
</tr>
</tbody>
</table>
<p>Another crucial distinction about data visualization is between plain, exploratory plots and
refined, annotated ones. Both types are essential. To get some sense of what the data looks like, Exploratory Data Analysis (EDA) often involves generating numerous “plain” graphics with <strong>default settings</strong>. R is a very powerful EDA tool.</p>
<p>When certain aspects of the data catch our eye, we may aim for more polished graphics suitable for publications or presentations. This often involves additional coding to tweak various parameters. For many, including myself, this process is a mix of Google searches, example code snippets, and a healthy dose of trial and error.</p>
<p>One of the open secrets of R programming is that you can start from a plain figure and <strong>refine it step by step</strong>. Here is an example using the base R graphics, which produces a basic scatter plot with the petal length on the x-axis and petal width on the y-axis. Since iris is a data frame, we will use the <code>iris$Petal.Length</code> to refer to the Petal.Length column.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="visualizing-the-iris-flower-data-set.html#cb61-1" tabindex="-1"></a>PL <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Length</span>
<span id="cb61-2"><a href="visualizing-the-iris-flower-data-set.html#cb61-2" tabindex="-1"></a>PW <span class="ot">&lt;-</span> iris<span class="sc">$</span>Petal.Width</span>
<span id="cb61-3"><a href="visualizing-the-iris-flower-data-set.html#cb61-3" tabindex="-1"></a><span class="fu">plot</span>(PL, PW)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-46-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>To change the type of symbols:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="visualizing-the-iris-flower-data-set.html#cb62-1" tabindex="-1"></a><span class="fu">plot</span>(PL, PW, <span class="at">pch =</span> <span class="dv">2</span>) <span class="co"># pch = 2 means triangle symbols</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-47-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The <strong>pch</strong> parameter ranges from 0 to 25, with each number representing a different symbol. Figure <a href="visualizing-the-iris-flower-data-set.html#fig:pchsymbols">2.1</a> illustrates commonly used values and symbols.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pchsymbols"></span>
<img src="images/ch2_1_pch_symbols.png" alt="Points Symbols" width="100%" />
<p class="caption">
Figure 2.1: Points Symbols
</p>
</div>
<p>To explore more customization options for the <strong>plot</strong> function, consult the R documentation:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="visualizing-the-iris-flower-data-set.html#cb63-1" tabindex="-1"></a>? plot</span></code></pre></div>
<p>Altering data point colors is effortless with the <strong>col = </strong> parameter.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="visualizing-the-iris-flower-data-set.html#cb64-1" tabindex="-1"></a><span class="fu">plot</span>(PL, PW, <span class="at">pch =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>) <span class="co"># Change the symbol color to green</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-49-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Next, Let’s use different symbols for different species. Begin by extracting the species information.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="visualizing-the-iris-flower-data-set.html#cb65-1" tabindex="-1"></a>iris<span class="sc">$</span>Species</span></code></pre></div>
<pre><code>##   [1] setosa     setosa     setosa     setosa     setosa     setosa    
##   [7] setosa     setosa     setosa     setosa     setosa     setosa    
##  [13] setosa     setosa     setosa     setosa     setosa     setosa    
##  [19] setosa     setosa     setosa     setosa     setosa     setosa    
##  [25] setosa     setosa     setosa     setosa     setosa     setosa    
##  [31] setosa     setosa     setosa     setosa     setosa     setosa    
##  [37] setosa     setosa     setosa     setosa     setosa     setosa    
##  [43] setosa     setosa     setosa     setosa     setosa     setosa    
##  [49] setosa     setosa     versicolor versicolor versicolor versicolor
##  [55] versicolor versicolor versicolor versicolor versicolor versicolor
##  [61] versicolor versicolor versicolor versicolor versicolor versicolor
##  [67] versicolor versicolor versicolor versicolor versicolor versicolor
##  [73] versicolor versicolor versicolor versicolor versicolor versicolor
##  [79] versicolor versicolor versicolor versicolor versicolor versicolor
##  [85] versicolor versicolor versicolor versicolor versicolor versicolor
##  [91] versicolor versicolor versicolor versicolor versicolor versicolor
##  [97] versicolor versicolor versicolor versicolor virginica  virginica 
## [103] virginica  virginica  virginica  virginica  virginica  virginica 
## [109] virginica  virginica  virginica  virginica  virginica  virginica 
## [115] virginica  virginica  virginica  virginica  virginica  virginica 
## [121] virginica  virginica  virginica  virginica  virginica  virginica 
## [127] virginica  virginica  virginica  virginica  virginica  virginica 
## [133] virginica  virginica  virginica  virginica  virginica  virginica 
## [139] virginica  virginica  virginica  virginica  virginica  virginica 
## [145] virginica  virginica  virginica  virginica  virginica  virginica 
## Levels: setosa versicolor virginica</code></pre>
<p>This output shows that the 150 observations are classed into three species: <em>setosa</em>, <em>versicolor</em>, and <em>virginica</em>. If reading the iris data from a file, like what we did in Chapter 1, it’s necessary to convert the Species column into a <strong>factor</strong> from <strong>character</strong>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="visualizing-the-iris-flower-data-set.html#cb67-1" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb67-2"><a href="visualizing-the-iris-flower-data-set.html#cb67-2" tabindex="-1"></a><span class="fu">str</span>(iris<span class="sc">$</span>Species)</span></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;setosa&quot;,&quot;versicolor&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p><strong>factors</strong> are used to store categorical variables as levels. Once converted into a factor, each observation is represented by one of the three species.
To numerically plot these factors, use the <em>as.numeric</em> function. Since we do not want to change the data frame, we will define a new variable called speciesID.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="visualizing-the-iris-flower-data-set.html#cb69-1" tabindex="-1"></a>speciesID <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb69-2"><a href="visualizing-the-iris-flower-data-set.html#cb69-2" tabindex="-1"></a>speciesID</span></code></pre></div>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3
## [112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [149] 3 3</code></pre>
<p>Now, assign different markers to different species using <em>pch = speciesID</em>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="visualizing-the-iris-flower-data-set.html#cb71-1" tabindex="-1"></a><span class="fu">plot</span>(PL, PW, <span class="at">pch =</span> speciesID, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-53-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here, 150 integers stored in the speciesID factor are used
to alter marker types. The first 50 data points (<em>setosa</em>) are represented by open
circles (pch = 1), the next 50 (<em>versicolor</em>) by triangles (pch = 2), while the last
50 (<em>virginica</em>) by crosses (pch = 3).</p>
<p>Similarly, different colors can be assigned to each species.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="visualizing-the-iris-flower-data-set.html#cb72-1" tabindex="-1"></a><span class="co"># Red, green, and blue for *setosa*, *versicolor*, and *virginica* respectively</span></span>
<span id="cb72-2"><a href="visualizing-the-iris-flower-data-set.html#cb72-2" tabindex="-1"></a><span class="fu">plot</span>(PL, PW, <span class="at">pch =</span> speciesID, <span class="at">col =</span> speciesID)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-54-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Our figure is starting to look nice, with each iris species distinctly marked by color and shape. This might seem like overkill, but it’s incredibly helpful, especially considering that some folks are colorblind. Let’s enhance our plot further by adjusting labels and adding a title.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="visualizing-the-iris-flower-data-set.html#cb73-1" tabindex="-1"></a><span class="fu">plot</span>(PL, PW, <span class="co"># x and y</span></span>
<span id="cb73-2"><a href="visualizing-the-iris-flower-data-set.html#cb73-2" tabindex="-1"></a>  <span class="at">pch =</span> speciesID, <span class="co"># Symbol type</span></span>
<span id="cb73-3"><a href="visualizing-the-iris-flower-data-set.html#cb73-3" tabindex="-1"></a>  <span class="at">col =</span> speciesID, <span class="co"># Color</span></span>
<span id="cb73-4"><a href="visualizing-the-iris-flower-data-set.html#cb73-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Petal length (cm)&quot;</span>, <span class="co"># x label</span></span>
<span id="cb73-5"><a href="visualizing-the-iris-flower-data-set.html#cb73-5" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Petal width (cm)&quot;</span>, <span class="co"># y label</span></span>
<span id="cb73-6"><a href="visualizing-the-iris-flower-data-set.html#cb73-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Petal width vs. length&quot;</span>  <span class="co"># Chart title</span></span>
<span id="cb73-7"><a href="visualizing-the-iris-flower-data-set.html#cb73-7" tabindex="-1"></a>) </span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-55-1.png" width="80%" style="display: block; margin: auto;" />
Notice the multi-line structure of this chunk? Breaking long lines into shorter ones enhances clarity and readability. And fear not when typing in the Console window, R knows that you are not done, and waits patiently for your closing parenthesis.</p>
<p>Remember: indentation with two spaces and ending with a right parenthesis are key for reusable and understandable code, for others or your future self. Check out these style guides for more tips:
<a href="http://adv-r.had.co.nz/Style.html">breif</a> and
<a href="https://style.tidyverse.org/">detailed</a>. It’s like knowing the dress code for a fancy event.</p>
<p>A true perfectionist never settles. Spot the strong linear correlation between petal length and width? Let’s add a trend line using <strong>abline()</strong>, a low level graphics function.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="visualizing-the-iris-flower-data-set.html#cb74-1" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(PW <span class="sc">~</span> PL)) <span class="co"># The order is reversed as we need y ~ x.</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;" />
Here, <code>lm(PW ~ PL)</code> generates a linear model (lm) of petal width as a function of petal
length. y ~ x is <strong>formula notation</strong> that used in many different situations.
The linear regression model is used to plot the trend line.</p>
<p>Next, we calculate the Pearson’s correlation coefficient and mark it on the plot.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="visualizing-the-iris-flower-data-set.html#cb75-1" tabindex="-1"></a>PCC <span class="ot">&lt;-</span> <span class="fu">cor</span>(PW, PL) <span class="co"># Pearson&#39;s correlation coefficient</span></span>
<span id="cb75-2"><a href="visualizing-the-iris-flower-data-set.html#cb75-2" tabindex="-1"></a>PCC <span class="ot">&lt;-</span> <span class="fu">round</span>(PCC, <span class="dv">2</span>) <span class="co"># Round to the 2nd place after decimal point.</span></span>
<span id="cb75-3"><a href="visualizing-the-iris-flower-data-set.html#cb75-3" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;R =&quot;</span>, PCC)</span></code></pre></div>
<pre><code>## [1] &quot;R = 0.96&quot;</code></pre>
<p>The <em>paste</em> function glues two strings together. Then we use the <strong>text</strong> function to
place the merged string in the lower right corner by specifying the coordinate of (x=5, y=0.5).</p>

<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="visualizing-the-iris-flower-data-set.html#cb77-1" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>, <span class="fl">0.5</span>, <span class="fu">paste</span>(<span class="st">&quot;R=&quot;</span>, PCC)) <span class="co"># Add text annotation</span></span>
<span id="cb77-2"><a href="visualizing-the-iris-flower-data-set.html#cb77-2" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="co"># Specify the location of the legend</span></span>
<span id="cb77-3"><a href="visualizing-the-iris-flower-data-set.html#cb77-3" tabindex="-1"></a>  <span class="fu">levels</span>(iris<span class="sc">$</span>Species), <span class="co"># Specify the levels of species</span></span>
<span id="cb77-4"><a href="visualizing-the-iris-flower-data-set.html#cb77-4" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="co"># Symbol parade</span></span>
<span id="cb77-5"><a href="visualizing-the-iris-flower-data-set.html#cb77-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="co"># Color fiesta</span></span>
<span id="cb77-6"><a href="visualizing-the-iris-flower-data-set.html#cb77-6" tabindex="-1"></a>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:23-5"></span>
<img src="book_files/figure-html/23-5-1.png" alt="A refined scatter plot using base R graphics." width="80%" />
<p class="caption">
Figure 2.2: A refined scatter plot using base R graphics.
</p>
</div>
<p>The last expression adds a legend at the top left using the <em>legend</em> function.
While <strong>plot</strong> is a high-level graphics function that starts a new plot,
<strong>abline</strong>, <strong>text</strong>, and <strong>legend</strong> are low-level functions that add to our existing plot.</p>
<p>Now you should be proud of yourself if you are able to generate such a plot. This is how we create complex plots step-by-step with trial-and-error. Creating such intricate plots is an exercise in patience and creativity. But let’s not forget another open secret of coding: “borrowing” ideas and code is totally fine! The <a href="https://r-graphics.org/">R Graphics Cookbook</a> includes all kinds of R plots and
sample code. And websites? Check out <a href="http://www.r-graph-gallery.com/">website:</a> <a href="http://www.r-graph-gallery.com/" class="uri">http://www.r-graph-gallery.com/</a> for more than 200 examples or dive into another collection at <a href="http://bxhorn.com/r-graphics-gallery/">here:</a> <a href="http://bxhorn.com/r-graphics-gallery/" class="uri">http://bxhorn.com/r-graphics-gallery/</a>.
These resources are goldmines when you have a graph in mind and just need the right template to tweak.</p>
</div>
<div id="scatter-plot-matrix" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Scatter plot matrix<a href="visualizing-the-iris-flower-data-set.html#scatter-plot-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While data frames can have a mixture of numbers and characters in different
columns, <strong>matrices typically contain only numbers</strong>. Let’s extract the first 4
columns from the data frame iris and convert them into a matrix:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="visualizing-the-iris-flower-data-set.html#cb78-1" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># Convert to matrix</span></span>
<span id="cb78-2"><a href="visualizing-the-iris-flower-data-set.html#cb78-2" tabindex="-1"></a><span class="fu">colMeans</span>(ma) <span class="co"># Calculate column means</span></span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##     5.843333     3.057333     3.758000     1.199333</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="visualizing-the-iris-flower-data-set.html#cb80-1" tabindex="-1"></a><span class="fu">colSums</span>(ma)  <span class="co"># Calculate column sums</span></span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##        876.5        458.6        563.7        179.9</code></pre>
<p>This technique can also be applied to rows using <em>rowMeans(x)</em> and <em>rowSums(x)</em>.</p>
<p>Next up, let’s create a scatter plot matrix using <em>pairs()</em> function.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="visualizing-the-iris-flower-data-set.html#cb82-1" tabindex="-1"></a><span class="fu">pairs</span>(ma)</span></code></pre></div>
<p>For a more colorful representation:</p>

<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="visualizing-the-iris-flower-data-set.html#cb83-1" tabindex="-1"></a><span class="fu">pairs</span>(ma, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">3</span>)[speciesID]) <span class="co"># Set colors by species</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spm2-2"></span>
<img src="book_files/figure-html/spm2-2-1.png" alt="Scatter plot matrix" width="100%" />
<p class="caption">
Figure 2.3: Scatter plot matrix
</p>
</div>
<blockquote>
<p>::: {.exercise #unnamed-chunk-60}</p>
</blockquote>
<blockquote>
<p>Interpret the scatter plot matrix in Figure <a href="visualizing-the-iris-flower-data-set.html#fig:spm2-2">2.3</a>.
:::</p>
<p> <br />
</p>
<p>::: {.exercise #unnamed-chunk-61}</p>
</blockquote>
<blockquote>
<p>Plot a scatter plot matrix for dataset <strong>mtcars</strong>, utilizing different point symbols and colors based on the types of <em>cyl</em>.
:::</p>
</blockquote>
</div>
<div id="star-and-segment-diagrams" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Star and segment diagrams<a href="visualizing-the-iris-flower-data-set.html#star-and-segment-diagrams" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Star plot, also known as Radar chart, uses stars to visualize multidimensional data.</strong> It is a useful way to display multivariate observations with an arbitrary number of variables. Each observation is represented as a star-shaped figure with one ray for each variable. For a given observation, the length of each ray is made proportional to the size of that variable. The star plot was firstly used by Georg von Mayr in 1877!</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="visualizing-the-iris-flower-data-set.html#cb84-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb84-2"><a href="visualizing-the-iris-flower-data-set.html#cb84-2" tabindex="-1"></a><span class="fu">stars</span>(df) <span class="co"># Do I see any diamonds?</span></span>
<span id="cb84-3"><a href="visualizing-the-iris-flower-data-set.html#cb84-3" tabindex="-1"></a><span class="fu">stars</span>(df, <span class="at">key.loc =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">0</span>)) <span class="co"># What does this tell you?</span></span></code></pre></div>
<blockquote>
<p>::: {.exercise #unnamed-chunk-63}</p>
</blockquote>
<blockquote>
<p>Based on the star plot, What insights can you gather about the differences among the three iris species?
:::</p>
</blockquote>
<p>The stars() function can also be used to generate segment diagrams, where each variable is used to generate colorful segments. The sizes of the segments are proportional to the measurements.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="visualizing-the-iris-flower-data-set.html#cb85-1" tabindex="-1"></a><span class="fu">stars</span>(df, <span class="at">key.loc =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="fl">0.5</span>), <span class="at">draw.segments =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:12-4"></span>
<img src="images/img1204n_starsegment.png" alt="Star plots and segments diagrams."  />
<p class="caption">
Figure 2.4: Star plots and segments diagrams.
</p>
</div>
<blockquote>
<p>::: {.exercise #unnamed-chunk-65}</p>
</blockquote>
<blockquote>
<p>Produce the segments diagram for the state data (state.x77) and offer interpretation of the results, especially in relation to South Dakota compared to other states. Hints: Convert the matrix to a data frame using <em>df.state.x77 &lt;- as.data.frame(state.x77)</em>, then plot the segments diagram based on the dataset <em>df.state.x77</em>.
:::</p>
</blockquote>
</div>
<div id="the-ggplot2-package-is-intuitive-and-powerful" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> The ggplot2 package is intuitive and powerful<a href="visualizing-the-iris-flower-data-set.html#the-ggplot2-package-is-intuitive-and-powerful" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In our R graphics toolkit, we have not just the base R graphics, but also the lattice and ggplot2 packages. These are the three musketeers of R graphics! Lattice builds upon base R for multi-faceted graphs, while ggplot2, developed on the principles of the Grammar of Graphics(hence the “gg”), adds layers to create complex graphics. Renowned for its intuitive design and powerful features, ggplot2 is becoming increasingly popular.</p>
<p>ggplot2’s magic lies in its modular approach, enabling step-by-step refinement of charts through:</p>
<ul>
<li><strong>Aesthetic mapping</strong>:Linking variables to visual characteristics.</li>
<li><strong>Geometric shapes</strong>: Crafting the visuals (points, lines, boxes, bars, histograms, maps, etc)</li>
<li><strong>Scales</strong> and <strong>statistical transformations</strong>: Adjusting scales, applying transformations like log, reverse, count, etc.</li>
<li><strong>coordinate systems</strong>: Framing the plot space.</li>
<li><strong>facets</strong>: Creating multiple plots for comparative analysis.</li>
<li><strong>Labels</strong> and <strong>annotations</strong>: Adding textual elements for clarity.</li>
</ul>
<p>For a deeper dive, check out these comprehensive tutorials on ggplot2 <a href="https://uc-r.github.io/ggplot_intro">here</a> and
by its <a href="https://r4ds.had.co.nz/data-visualisation.html">author</a>.</p>
<p>Not part of the base R distribution, ggplot2 is available on the CRAN <a href="https://cran.r-project.org/web/packages/ggplot2/index.html">website</a>.
It need to be downloaded and installed. One of the main advantages of R is that it
is open, and users can contribute their codes as packages. If you are using
<strong>RStudio</strong>, you can choose <strong>Tools-&gt;Install packages</strong> from the main menu, and
then enter the name of the package. If you are using R software, you can install
additional packages, by clicking <strong>Packages</strong> in the main menu, and select a
mirror site. All these mirror sites work the same, but some may be faster. After
choosing a mirror and clicking “OK”, you can scroll down the long list to find
your package. Alternatively, you can type this command to install packages.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="visualizing-the-iris-flower-data-set.html#cb86-1" tabindex="-1"></a><span class="co"># Install the package. You can also do it through the Packages Tab</span></span>
<span id="cb86-2"><a href="visualizing-the-iris-flower-data-set.html#cb86-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Installation of a new package is a one-time affair, but remember, you need to <strong>load</strong> it from your hard drive into memory every time you use its <strong>functions or data</strong>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="visualizing-the-iris-flower-data-set.html#cb87-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># Load the ggplot2 package</span></span></code></pre></div>
<p>Let’s walk through the steps of creating a scatter plot using ggplot2, adding layers one at a time.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="visualizing-the-iris-flower-data-set.html#cb88-1" tabindex="-1"></a><span class="co"># Start with the canvas</span></span>
<span id="cb88-2"><a href="visualizing-the-iris-flower-data-set.html#cb88-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris)</span></code></pre></div>

<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="visualizing-the-iris-flower-data-set.html#cb89-1" tabindex="-1"></a><span class="co"># Map data to x and y coordinates</span></span>
<span id="cb89-2"><a href="visualizing-the-iris-flower-data-set.html#cb89-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb89-3"><a href="visualizing-the-iris-flower-data-set.html#cb89-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-6-1"></span>
<img src="book_files/figure-html/2-6-1.png" alt="Basic scatter plot using the ggplot2 package." width="100%" />
<p class="caption">
Figure 2.5: Basic scatter plot using the ggplot2 package.
</p>
</div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="visualizing-the-iris-flower-data-set.html#cb90-1" tabindex="-1"></a><span class="co"># Add data points</span></span>
<span id="cb90-2"><a href="visualizing-the-iris-flower-data-set.html#cb90-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb90-3"><a href="visualizing-the-iris-flower-data-set.html#cb90-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width) <span class="sc">+</span></span>
<span id="cb90-4"><a href="visualizing-the-iris-flower-data-set.html#cb90-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-6-2"></span>
<img src="book_files/figure-html/2-6-2.png" alt="Basic scatter plot using the ggplot2 package." width="100%" />
<p class="caption">
Figure 2.6: Basic scatter plot using the ggplot2 package.
</p>
</div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="visualizing-the-iris-flower-data-set.html#cb91-1" tabindex="-1"></a><span class="co"># Customize color &amp; symbol type</span></span>
<span id="cb91-2"><a href="visualizing-the-iris-flower-data-set.html#cb91-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb91-3"><a href="visualizing-the-iris-flower-data-set.html#cb91-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width) <span class="sc">+</span></span>
<span id="cb91-4"><a href="visualizing-the-iris-flower-data-set.html#cb91-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-6-3"></span>
<img src="book_files/figure-html/2-6-3.png" alt="Basic scatter plot using the ggplot2 package." width="100%" />
<p class="caption">
Figure 2.7: Basic scatter plot using the ggplot2 package.
</p>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="visualizing-the-iris-flower-data-set.html#cb92-1" tabindex="-1"></a><span class="co"># Incorporate a trend line</span></span>
<span id="cb92-2"><a href="visualizing-the-iris-flower-data-set.html#cb92-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb92-3"><a href="visualizing-the-iris-flower-data-set.html#cb92-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width) <span class="sc">+</span></span>
<span id="cb92-4"><a href="visualizing-the-iris-flower-data-set.html#cb92-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb92-5"><a href="visualizing-the-iris-flower-data-set.html#cb92-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-6-4"></span>
<img src="book_files/figure-html/2-6-4.png" alt="Basic scatter plot using the ggplot2 package." width="100%" />
<p class="caption">
Figure 2.8: Basic scatter plot using the ggplot2 package.
</p>
</div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="visualizing-the-iris-flower-data-set.html#cb93-1" tabindex="-1"></a><span class="co"># Annotate with text to a specified location by setting coordinates x = , y =</span></span>
<span id="cb93-2"><a href="visualizing-the-iris-flower-data-set.html#cb93-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb93-3"><a href="visualizing-the-iris-flower-data-set.html#cb93-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width) <span class="sc">+</span></span>
<span id="cb93-4"><a href="visualizing-the-iris-flower-data-set.html#cb93-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb93-5"><a href="visualizing-the-iris-flower-data-set.html#cb93-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb93-6"><a href="visualizing-the-iris-flower-data-set.html#cb93-6" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">&quot;R=0.96&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-6-5"></span>
<img src="book_files/figure-html/2-6-5.png" alt="Basic scatter plot using the ggplot2 package." width="100%" />
<p class="caption">
Figure 2.9: Basic scatter plot using the ggplot2 package.
</p>
</div>
<p>ggplot2 commands often span multiple lines. Each command is like a brushstroke, gradually building up your visual masterpiece. The ‘+’ sign is a cue of the addition of another layer to your plot. ggplot2 takes care of many details, simplifying the process of creating complex plots like Figure <a href="visualizing-the-iris-flower-data-set.html#fig:23-5">2.2</a>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="visualizing-the-iris-flower-data-set.html#cb94-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span></span>
<span id="cb94-2"><a href="visualizing-the-iris-flower-data-set.html#cb94-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">y =</span> Petal.Width) <span class="sc">+</span> <span class="co"># Define the space</span></span>
<span id="cb94-3"><a href="visualizing-the-iris-flower-data-set.html#cb94-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span> <span class="co"># Add points</span></span>
<span id="cb94-4"><a href="visualizing-the-iris-flower-data-set.html#cb94-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span> <span class="co"># Add trend line</span></span>
<span id="cb94-5"><a href="visualizing-the-iris-flower-data-set.html#cb94-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">&quot;R=0.96&quot;</span>) <span class="sc">+</span> <span class="co"># Annotate with text</span></span>
<span id="cb94-6"><a href="visualizing-the-iris-flower-data-set.html#cb94-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Petal length (cm)&quot;</span>) <span class="sc">+</span> <span class="co"># X-axis labels</span></span>
<span id="cb94-7"><a href="visualizing-the-iris-flower-data-set.html#cb94-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Petal width (cm)&quot;</span>) <span class="sc">+</span> <span class="co"># Y-axis labels</span></span>
<span id="cb94-8"><a href="visualizing-the-iris-flower-data-set.html#cb94-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Correlation between petal length and width&quot;</span>) <span class="co"># Title</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="book_files/figure-html/unnamed-chunk-69-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Creating a plot in ggplot2 resembles painting: startING with a blank canvas, gradually sketching the background, outlining the main features, and finally adding the detailed touches. Imagine yourself as an artist, with data as your palette.
<img src="https://github.com/gexijin/learnR/raw/master/images/drawing.gif" alt="The process of painting from GIPHY by (maluduque?)" /></p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-71}</p>
</blockquote>
<blockquote>
<p>Create a scatter plot of sepal length vs sepal width, differentiate species by colors and shapes, and include a trend line.
:::</p>
</blockquote>
</div>
<div id="other-types-of-plots-with-ggplot2" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Other types of plots with ggplot2<a href="visualizing-the-iris-flower-data-set.html#other-types-of-plots-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Creating box plots, a fundamental data visualization tool, is straightforward with ggplot2. For instance, examining sepal length across different iris species:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="visualizing-the-iris-flower-data-set.html#cb96-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># Load ggplot2</span></span>
<span id="cb96-2"><a href="visualizing-the-iris-flower-data-set.html#cb96-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb96-3"><a href="visualizing-the-iris-flower-data-set.html#cb96-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length, <span class="at">color =</span> Species) <span class="sc">+</span></span>
<span id="cb96-4"><a href="visualizing-the-iris-flower-data-set.html#cb96-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="co"># Classic box plot</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-72-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here, the categorical variable ‘Species’ is used on the x-axis to group data. The y-axis displays the distribution of sepal lengths. One of ggplot2’s strengths is its ability to refine plots effortlessly.</p>

<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="visualizing-the-iris-flower-data-set.html#cb97-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb97-2"><a href="visualizing-the-iris-flower-data-set.html#cb97-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length, <span class="at">color =</span> Species) <span class="sc">+</span></span>
<span id="cb97-3"><a href="visualizing-the-iris-flower-data-set.html#cb97-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb97-4"><a href="visualizing-the-iris-flower-data-set.html#cb97-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.2</span>)) <span class="co"># Add jittered raw data points</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-73"></span>
<img src="book_files/figure-html/unnamed-chunk-73-1.png" alt="Enhancing box plot with raw data points" width="80%" />
<p class="caption">
Figure 2.10: Enhancing box plot with raw data points
</p>
</div>
<p>Adding raw data points on top of the boxplot provides a richer view. To avoid cluttering, we jitter these points within each subgroup. The color-coding is simply achieved with “color = Species”. ggplot2 gracefully handles the finer details, like the automatic generation of legends in these density plots.</p>

<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="visualizing-the-iris-flower-data-set.html#cb98-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb98-2"><a href="visualizing-the-iris-flower-data-set.html#cb98-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">fill =</span> Species) <span class="sc">+</span></span>
<span id="cb98-3"><a href="visualizing-the-iris-flower-data-set.html#cb98-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="co"># A density plot with a touch of transparency</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2-7"></span>
<img src="book_files/figure-html/2-7-1.png" alt="Density plot of petal length by species." width="60%" />
<p class="caption">
Figure 2.11: Density plot of petal length by species.
</p>
</div>

<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="visualizing-the-iris-flower-data-set.html#cb99-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris) <span class="sc">+</span></span>
<span id="cb99-2"><a href="visualizing-the-iris-flower-data-set.html#cb99-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">fill =</span> Species) <span class="sc">+</span></span>
<span id="cb99-3"><a href="visualizing-the-iris-flower-data-set.html#cb99-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="visualizing-the-iris-flower-data-set.html#cb99-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">nrow =</span> <span class="dv">3</span>)  <span class="co"># Facet for comparison across species</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-74"></span>
<img src="book_files/figure-html/unnamed-chunk-74-1.png" alt="Density plot by subgroups using facets." width="80%" />
<p class="caption">
Figure 2.12: Density plot by subgroups using facets.
</p>
</div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="visualizing-the-iris-flower-data-set.html#cb100-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span></span>
<span id="cb100-2"><a href="visualizing-the-iris-flower-data-set.html#cb100-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Width, <span class="at">fill =</span> Species) <span class="sc">+</span></span>
<span id="cb100-3"><a href="visualizing-the-iris-flower-data-set.html#cb100-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;bar&quot;</span>, <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="visualizing-the-iris-flower-data-set.html#cb100-4" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="at">fun.data =</span> <span class="st">&quot;mean_se&quot;</span>, <span class="at">width =</span> .<span class="dv">3</span>) <span class="co"># Mean and error bar</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dynamite"></span>
<img src="book_files/figure-html/dynamite-1.png" alt="Dynamite Plot" width="80%" />
<p class="caption">
Figure 2.13: Dynamite Plot
</p>
</div>
<p>The bar plot with error bar, as seen in <a href="visualizing-the-iris-flower-data-set.html#fig:dynamite">2.13</a> is humorously termed as “dynamite plot” due to its appearance. Rafael Irizarry, a renowned statistician, criticized dynamite plot in his <a href="https://simplystatistics.org/2019/02/21/dynamite-plots-must-die/">blog</a>: <strong>“The dynamite plots must die!”</strong>. He pointed out dynamite plots’ limitations in conveying detailed data information, obscure the outliers and overall distribution. So many scientists prefer box plots with jittered points for a more comprehensive view.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-75}</p>
</blockquote>
<blockquote>
<p>Use boxplot and density plots to investigate the similarity and differences of petal width across the three species in the <strong>iris</strong> dataset.
:::</p>
</blockquote>
</div>
<div id="hierarchical-clustering-and-heat-map" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Hierarchical clustering and heat map<a href="visualizing-the-iris-flower-data-set.html#hierarchical-clustering-and-heat-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Hierarchical clustering</strong> summarizes observations into trees representing the overall similarities. This technique is superb for visualizing how different samples relate to each other.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="visualizing-the-iris-flower-data-set.html#cb101-1" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># Convert to matrix</span></span>
<span id="cb101-2"><a href="visualizing-the-iris-flower-data-set.html#cb101-2" tabindex="-1"></a>disMatarix <span class="ot">&lt;-</span> <span class="fu">dist</span>(ma) <span class="co"># Calculate distance matrix</span></span>
<span id="cb101-3"><a href="visualizing-the-iris-flower-data-set.html#cb101-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(disMatarix)) <span class="co"># Generate and plot hierarchical clustering tree</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>The <strong>dist()</strong> function calculates a distance matrix with the default Euclidean
distance method. The distance matrix is then used by the <strong>hclust()</strong> function to generate a
hierarchical clustering tree with the default complete linkage method, which is then plotted in a nested command.</p>
<p>The 150 samples of flowers are organized in this cluster dendrogram based on their Euclidean
distance, which is labeled vertically by the bar to the left side. Highly similar flowers are
grouped together in smaller branches, and their distances can be found according to the vertical
position of the branching point. We are often more interested in looking at the overall structure
of the dendrogram. For example, we see two big clusters.</p>
<p>The detailed process of Hierarchical clustering: First, each of the flower samples is treated as a cluster. The algorithm joins
the two most similar clusters based on a distance function. This is performed
iteratively until there is just a single cluster containing all 150 flowers. At
each iteration, the distances between clusters are recalculated according to one
of the methods—<em>Single linkage, complete linkage, average linkage, and so on</em>.
In the single-linkage method, the distance between two clusters is defined by
the smallest distance among the all possible object pairs. This approach puts
‘friends of friends’ into a cluster. On the contrary, the complete linkage
method defines the distance as the largest distance between object pairs. It
finds similar clusters. Between these two extremes, there are many options in
between. The most robust linkage method is the average linkage, which uses the average of all distances. However, the default seems to be the complete linkage. Thus we need to change that in our final version.</p>
<p><strong>Heat maps</strong>, especially when combined with hierarchical clustering, are fantastic for visualizing data matrices. The rows and columns are reorganized based on hierarchical clustering, and the values in the matrix are coded by colors. Heat maps can directly visualize millions of numbers in one plot. The hierarchical trees also show the similarity among rows and columns.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualizing-the-iris-flower-data-set.html#cb102-1" tabindex="-1"></a><span class="fu">heatmap</span>(ma,</span>
<span id="cb102-2"><a href="visualizing-the-iris-flower-data-set.html#cb102-2" tabindex="-1"></a>  <span class="at">scale =</span> <span class="st">&quot;column&quot;</span>,</span>
<span id="cb102-3"><a href="visualizing-the-iris-flower-data-set.html#cb102-3" tabindex="-1"></a>  <span class="at">RowSideColors =</span> <span class="fu">rainbow</span>(<span class="dv">3</span>)[iris<span class="sc">$</span>Species]</span>
<span id="cb102-4"><a href="visualizing-the-iris-flower-data-set.html#cb102-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>Scaling is handled by the <strong>scale()</strong> function, which subtracts the mean from each
column and then divides by the standard division. Afterward, all the columns
have the same mean of approximately 0 and standard deviation of 1. This is also
called standardization. The default color scheme uses yellow for higher values and red for lower ones. The color bar on the left corresponds to different species. This basic heatmap lacks a legend and could use some polishing. Instead of going down the rabbit hole of adjusting dozens of parameters to basic
heatmap function (or it’s enhanced version heatmap.2 from the gplots package), We
will refine this plot using another R package called <strong>pheatmap</strong>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="visualizing-the-iris-flower-data-set.html#cb103-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pheatmap&quot;</span>)</span></code></pre></div>

<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="visualizing-the-iris-flower-data-set.html#cb104-1" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb104-2"><a href="visualizing-the-iris-flower-data-set.html#cb104-2" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># Convert to matrix</span></span>
<span id="cb104-3"><a href="visualizing-the-iris-flower-data-set.html#cb104-3" tabindex="-1"></a><span class="fu">row.names</span>(ma) <span class="ot">&lt;-</span> <span class="fu">row.names</span>(iris) <span class="co"># Assign row names in the matrix</span></span>
<span id="cb104-4"><a href="visualizing-the-iris-flower-data-set.html#cb104-4" tabindex="-1"></a><span class="fu">pheatmap</span>(ma,</span>
<span id="cb104-5"><a href="visualizing-the-iris-flower-data-set.html#cb104-5" tabindex="-1"></a>  <span class="at">scale =</span> <span class="st">&quot;column&quot;</span>,</span>
<span id="cb104-6"><a href="visualizing-the-iris-flower-data-set.html#cb104-6" tabindex="-1"></a>  <span class="at">clustering_method =</span> <span class="st">&quot;average&quot;</span>, <span class="co"># Use average linkage</span></span>
<span id="cb104-7"><a href="visualizing-the-iris-flower-data-set.html#cb104-7" tabindex="-1"></a>  <span class="at">annotation_row =</span> iris[, <span class="dv">5</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="co"># Add the 5th column as color bar</span></span>
<span id="cb104-8"><a href="visualizing-the-iris-flower-data-set.html#cb104-8" tabindex="-1"></a>  <span class="at">show_rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb104-9"><a href="visualizing-the-iris-flower-data-set.html#cb104-9" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:12-3"></span>
<img src="book_files/figure-html/12-3-1.png" alt="Heatmap for the iris flower dataset." width="672" />
<p class="caption">
Figure 2.14: Heatmap for the iris flower dataset.
</p>
</div>
<p>First, we convert the first 4 columns of the iris data frame into a matrix. Then
the row names are assigned to be the same, namely, “1” to “150”. This is
required because row names are used to match with the column annotation
information, specified by the annotation_row parameter. Even though we only
need the 5th column, i.e., Species, this has to be a data frame. To prevent R
from automatically converting a one-column data frame into a vector, we used
<em>drop = FALSE</em> option. Multiple columns can be contained in the column
annotation data frame to display multiple color bars. The rows could be
annotated the same way.</p>
<p>More information about the pheatmap function can be obtained by reading the help
document. But most of the times, I rely on the online tutorials. Beyond the
official documents prepared by the author, there are many documents created by R
users across the world. The R user community is uniquely open and supportive. For instance, when I
was researching heatmap.2, a more refined version of heatmap, part of the gplots
package, and landed on Dave Tang’s
<a href="https://davetang.org/muse/2010/12/06/making-a-heatmap-with-r/">blog</a>, which
mentioned that there is a more user-friendly package called pheatmap described
in his other
<a href="https://davetang.org/muse/2018/05/15/making-a-heatmap-in-r-with-the-pheatmap-package/">blog</a>.
Kamil Slowikowski’s <a href="https://slowkow.com/notes/pheatmap-tutorial/">blog</a> also provide valuable insights into function pheatmap.</p>
<p>Come back to our Figure <a href="visualizing-the-iris-flower-data-set.html#fig:12-3">2.14</a>. It offers deep insights into the dataset. The 150 flowers in the rows are organized into different clusters. <em>I. Setosa</em> samples obviously formed a unique cluster, characterized by smaller (blue) petal length, petal width, and sepal length. The other two subspecies are not clearly separated but <em>I. Virginica</em> samples form a small subcluster showing bigger petals. The columns are also organized into dendrograms, reaffirming the strong correlation between petal length and width.</p>
</div>
<div id="principal-component-analysis-pca" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Principal component analysis (PCA)<a href="visualizing-the-iris-flower-data-set.html#principal-component-analysis-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Principal Component Analysis (PCA) is a linear dimension-reduction method, simplifying the complexity in high-dimensional data by reducing its number of dimensions. This section may be skipped if you would like, as it contains more statistics than R programming. However, PCA is crucial for visualizing and interpreting data in a more comprehensible manner.</p>
<p>As illustrated in Figure <a href="visualizing-the-iris-flower-data-set.html#fig:13-4">2.15</a>, PCA transforms the data into a new set of orthogonal coordinates, ranking them based on the variation or information they capture. PCA process results in:</p>
<ul>
<li>Definitions of new coordinates,</li>
<li>Percentages of variances captured by these coordinates,</li>
<li>Representations of data points on these new coordinates.</li>
</ul>
<p>Here the first component x’ gives a relatively accurate representation of the data.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:13-4"></span>
<img src="images/img1304_PCA.png" alt="Concept of PCA." width="75%" />
<p class="caption">
Figure 2.15: Concept of PCA.
</p>
</div>
<p>Let’s take the first 4 columns of the iris data for a PCA spin. Note that “scale = TRUE” normalizes the data before conducting PCA, ensuring each variable has unit variance.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="visualizing-the-iris-flower-data-set.html#cb105-1" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">scale =</span> <span class="cn">TRUE</span>) </span>
<span id="cb105-2"><a href="visualizing-the-iris-flower-data-set.html#cb105-2" tabindex="-1"></a>pca <span class="co"># Display PCA results.</span></span></code></pre></div>
<pre><code>## Standard deviations (1, .., p=4):
## [1] 1.7083611 0.9560494 0.3830886 0.1439265
## 
## Rotation (n x k) = (4 x 4):
##                     PC1         PC2        PC3        PC4
## Sepal.Length  0.5210659 -0.37741762  0.7195664  0.2612863
## Sepal.Width  -0.2693474 -0.92329566 -0.2443818 -0.1235096
## Petal.Length  0.5804131 -0.02449161 -0.1421264 -0.8014492
## Petal.Width   0.5648565 -0.06694199 -0.6342727  0.5235971</code></pre>
<p>The first principal component is positively correlated with Sepal length, petal length, and petal width. Recall that these three variables are highly correlated. Sepal width, which is relatively constant across species, influences PC2 the most, while sepal length influences PC2 the least.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="visualizing-the-iris-flower-data-set.html#cb107-1" tabindex="-1"></a><span class="fu">plot</span>(pca) <span class="co"># Plot the variance captured by each principal component.</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-80-1.png" width="50%" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="visualizing-the-iris-flower-data-set.html#cb108-1" tabindex="-1"></a><span class="fu">str</span>(pca) <span class="co">#  Explore PCA object structure</span></span></code></pre></div>
<pre><code>## List of 5
##  $ sdev    : num [1:4] 1.708 0.956 0.383 0.144
##  $ rotation: num [1:4, 1:4] 0.521 -0.269 0.58 0.565 -0.377 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:4] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot;
##   .. ..$ : chr [1:4] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot;
##  $ center  : Named num [1:4] 5.84 3.06 3.76 1.2
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot;
##  $ scale   : Named num [1:4] 0.828 0.436 1.765 0.762
##   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot; &quot;Petal.Length&quot; &quot;Petal.Width&quot;
##  $ x       : num [1:150, 1:4] -2.26 -2.07 -2.36 -2.29 -2.38 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:4] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;prcomp&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="visualizing-the-iris-flower-data-set.html#cb110-1" tabindex="-1"></a><span class="fu">head</span>(pca<span class="sc">$</span>x) <span class="co"># New coordinate values for the 150 iris samples</span></span></code></pre></div>
<pre><code>##            PC1        PC2         PC3          PC4
## [1,] -2.257141 -0.4784238  0.12727962  0.024087508
## [2,] -2.074013  0.6718827  0.23382552  0.102662845
## [3,] -2.356335  0.3407664 -0.04405390  0.028282305
## [4,] -2.291707  0.5953999 -0.09098530 -0.065735340
## [5,] -2.381863 -0.6446757 -0.01568565 -0.035802870
## [6,] -2.068701 -1.4842053 -0.02687825  0.006586116</code></pre>
<p>To visualize the PCA results, we first construct a data frame suitable for ggplot2 format.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="visualizing-the-iris-flower-data-set.html#cb112-1" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="co"># Extract first two components</span></span>
<span id="cb112-2"><a href="visualizing-the-iris-flower-data-set.html#cb112-2" tabindex="-1"></a>pcaData <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pcaData, iris<span class="sc">$</span>Species) <span class="co"># Add species information</span></span>
<span id="cb112-3"><a href="visualizing-the-iris-flower-data-set.html#cb112-3" tabindex="-1"></a><span class="fu">colnames</span>(pcaData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PC1&quot;</span>, <span class="st">&quot;PC2&quot;</span>, <span class="st">&quot;Species&quot;</span>) <span class="co"># Rename columns</span></span>
<span id="cb112-4"><a href="visualizing-the-iris-flower-data-set.html#cb112-4" tabindex="-1"></a></span>
<span id="cb112-5"><a href="visualizing-the-iris-flower-data-set.html#cb112-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-6"><a href="visualizing-the-iris-flower-data-set.html#cb112-6" tabindex="-1"></a><span class="fu">ggplot</span>(pcaData) <span class="sc">+</span></span>
<span id="cb112-7"><a href="visualizing-the-iris-flower-data-set.html#cb112-7" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Species, <span class="at">shape =</span> Species) <span class="sc">+</span> <span class="co"># Define plot area</span></span>
<span id="cb112-8"><a href="visualizing-the-iris-flower-data-set.html#cb112-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="co"># Add data points</span></span></code></pre></div>
<p>Now we have a basic plot. We can add elements one by one using the “+”
sign at the end of each line to add details to this plot.</p>

<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="visualizing-the-iris-flower-data-set.html#cb113-1" tabindex="-1"></a>percentVar <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">summary</span>(pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">0</span>) <span class="co"># Calculate percentage variances</span></span>
<span id="cb113-2"><a href="visualizing-the-iris-flower-data-set.html#cb113-2" tabindex="-1"></a><span class="fu">ggplot</span>(pcaData, <span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="visualizing-the-iris-flower-data-set.html#cb113-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># Add data points</span></span>
<span id="cb113-4"><a href="visualizing-the-iris-flower-data-set.html#cb113-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">paste0</span>(<span class="st">&quot;PC1: &quot;</span>, percentVar[<span class="dv">1</span>], <span class="st">&quot;% variance&quot;</span>)) <span class="sc">+</span> <span class="co"># x label</span></span>
<span id="cb113-5"><a href="visualizing-the-iris-flower-data-set.html#cb113-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">paste0</span>(<span class="st">&quot;PC2: &quot;</span>, percentVar[<span class="dv">2</span>], <span class="st">&quot;% variance&quot;</span>)) <span class="sc">+</span> <span class="co"># y label</span></span>
<span id="cb113-6"><a href="visualizing-the-iris-flower-data-set.html#cb113-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Principal component analysis (PCA)&quot;</span>) <span class="sc">+</span> <span class="co"># Title</span></span>
<span id="cb113-7"><a href="visualizing-the-iris-flower-data-set.html#cb113-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>) <span class="co"># Width and height ratio</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:13-5"></span>
<img src="book_files/figure-html/13-5-1.png" alt="PCA plot of the iris flower dataset" width="80%" />
<p class="caption">
Figure 2.16: PCA plot of the iris flower dataset
</p>
</div>
<p>The plot (Figure <a href="visualizing-the-iris-flower-data-set.html#fig:13-5">2.16</a>) projects the 4-dimensional iris data onto a 2-dimensional space using the first two principal components. Based on its value, PC1 alone can distinguish the three species quite effectively:
PC1 &lt; -1: Iris setosa;
PC1 &gt; 1.5: Iris virginica;
-1 &lt; PC1 &lt; 1: Iris versicolor.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-83}</p>
</blockquote>
<blockquote>
<p>Perform PCA on the state.x77 dataset (converted to a data frame) using state.region for color coding. Don’t forget to normalize the data using scale function. Interpret your findings.
:::</p>
</blockquote>
</div>
<div id="logistic-regression-for-binary-outcomes-prediction" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Logistic Regression for Binary Outcomes Prediction<a href="visualizing-the-iris-flower-data-set.html#logistic-regression-for-binary-outcomes-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Because this section contains more statistics than R programming like PCA, you may skip it too if you would like.
PCA helps us see the big picture, which reveals that <em>I. setosa</em> is easy to be distinguished from the other two species based on petal length alone. While logistic regression is a statistical method for predicting binary outcomes, particularly between <em>I. versicolor</em> and <em>I. virginica</em>. Let’s build a model using the odds ratio of being <em>I. virginica</em> as a function of all
of the 4 measurements:</p>
<p><span class="math display">\[ln(odds)=ln(\frac{p}{1-p})
                     =a×Sepal.Length + b×Sepal.Width + c×Petal.Length + d×Petal.Width+c+e.\]</span></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="visualizing-the-iris-flower-data-set.html#cb114-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> iris[<span class="dv">51</span><span class="sc">:</span><span class="dv">150</span>, ] <span class="co"># ocus on versicolor and virginica.</span></span>
<span id="cb114-2"><a href="visualizing-the-iris-flower-data-set.html#cb114-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(df) <span class="co"># Removes setosa, now an empty levels of species</span></span>
<span id="cb114-3"><a href="visualizing-the-iris-flower-data-set.html#cb114-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Species <span class="sc">~</span> ., <span class="co"># Model: Species as a function of other variables</span></span>
<span id="cb114-4"><a href="visualizing-the-iris-flower-data-set.html#cb114-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb114-5"><a href="visualizing-the-iris-flower-data-set.html#cb114-5" tabindex="-1"></a>  <span class="at">data =</span> df</span>
<span id="cb114-6"><a href="visualizing-the-iris-flower-data-set.html#cb114-6" tabindex="-1"></a>)</span>
<span id="cb114-7"><a href="visualizing-the-iris-flower-data-set.html#cb114-7" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Species ~ ., family = binomial(link = &quot;logit&quot;), 
##     data = df)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)   -42.638     25.707  -1.659   0.0972 .
## Sepal.Length   -2.465      2.394  -1.030   0.3032  
## Sepal.Width    -6.681      4.480  -1.491   0.1359  
## Petal.Length    9.429      4.737   1.991   0.0465 *
## Petal.Width    18.286      9.743   1.877   0.0605 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 138.629  on 99  degrees of freedom
## Residual deviance:  11.899  on 95  degrees of freedom
## AIC: 21.899
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<p>Interestingly, sepal measurements are not very helpful in distinguishing <strong>versicolor</strong> from
<em>virginica</em>. Petal length, however, emerges as a significant factor with P=0.0465. One unit
increase in petal length will increase the log-odds of being <em>virginica</em> by
9.429. Petal.Width is a marginally significant effect.</p>
<p>Don’t worry if the mathematics behind logistic regression or logistic regression seems complex for you. The key is learning how to apply these analyses in R and interpret the results. Think R is a tool best learned through practice, much like a computer. I do not understand how computers work, yet I <strong>use</strong> it every day.</p>
<p>You do not need to finish the rest of this book. Now it’s entirely possible to start working on one of your own datasets after reading the first two chapters.
If you do not have a dataset, consider sources such as <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a>. Set a research question and start experimenting. Feel free to borrow some example code as needed.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-85}</p>
</blockquote>
<blockquote>
<p>So far, we used a variety of techniques to investigate the iris flower dataset. Recall that in the very beginning, I asked you to eyeball the data and answer two questions:</p>
<ol style="list-style-type: lower-alpha">
<li>What distinguishes these three species?</li>
<li>If we have a flower with sepals of 6.5cm long and 3.0cm wide, petals of 6.2cm long, and 2.2cm wide, which species does it most likely belong to?</li>
</ol>
<p>Review the raw data and previous analyses, write a paragraph with your conclusions supported by evidence. Feel free to conduct additional analysis if necessary.
:::</p>
</blockquote>
<p>References:
1 Beckerman, A. (2017). Getting started with r second edition. New York, NY, Oxford University Press.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="step-into-r-programmingthe-iris-flower-dataset.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-structures.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
