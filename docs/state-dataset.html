<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 State dataset | Learn R through examples</title>
  <meta name="description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 State dataset | Learn R through examples" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  <meta name="github-repo" content="gexijin/learnR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 State dataset | Learn R through examples" />
  
  <meta name="twitter:description" content="This is a draft of a book for learning data analysis with the R language. This book emphasizes hands activities. Comments and suggestions are welcome." />
  

<meta name="author" content="Xijin Ge, Jianli Qi, and Rong Fan" />


<meta name="date" content="2024-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advanced-topics.html"/>
<link rel="next" href="the-game-sales-dataset.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html"><i class="fa fa-check"></i><b>1</b> Step into R programming:The iris flower dataset</a>
<ul>
<li class="chapter" data-level="1.1" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting started</a></li>
<li class="chapter" data-level="1.2" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#the-proper-way-of-using-rstudio"><i class="fa fa-check"></i><b>1.2</b> The proper way of using RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#data-frames-contain-rows-and-columns-the-iris-flower-dataset"><i class="fa fa-check"></i><b>1.3</b> Data frames contain rows and columns: the iris flower dataset</a></li>
<li class="chapter" data-level="1.4" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-one-set-of-numbers"><i class="fa fa-check"></i><b>1.4</b> Analyzing one set of numbers</a></li>
<li class="chapter" data-level="1.5" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#analyzing-a-categorical-variable"><i class="fa fa-check"></i><b>1.5</b> Analyzing a categorical variable</a></li>
<li class="chapter" data-level="1.6" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#the-relationship-between-two-numerical-variables"><i class="fa fa-check"></i><b>1.6</b> The relationship between two numerical variables</a></li>
<li class="chapter" data-level="1.7" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-the-differences-between-two-groups"><i class="fa fa-check"></i><b>1.7</b> Testing the differences between two groups</a></li>
<li class="chapter" data-level="1.8" data-path="step-into-r-programmingthe-iris-flower-dataset.html"><a href="step-into-r-programmingthe-iris-flower-dataset.html#testing-differences-among-multiple-groups-anova"><i class="fa fa-check"></i><b>1.8</b> Testing differences among multiple groups (ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html"><i class="fa fa-check"></i><b>2</b> Visualizing the iris flower data set</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#basic-concepts-of-r-graphics"><i class="fa fa-check"></i><b>2.1</b> Basic concepts of R graphics</a></li>
<li class="chapter" data-level="2.2" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#scatter-plot-matrix"><i class="fa fa-check"></i><b>2.2</b> Scatter plot matrix</a></li>
<li class="chapter" data-level="2.3" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#star-and-segment-diagrams"><i class="fa fa-check"></i><b>2.3</b> Star and segment diagrams</a></li>
<li class="chapter" data-level="2.4" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#the-ggplot2-package-is-intuitive-and-powerful"><i class="fa fa-check"></i><b>2.4</b> The ggplot2 package is intuitive and powerful</a></li>
<li class="chapter" data-level="2.5" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#other-types-of-plots-with-ggplot2"><i class="fa fa-check"></i><b>2.5</b> Other types of plots with ggplot2</a></li>
<li class="chapter" data-level="2.6" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#hierarchical-clustering-and-heat-map"><i class="fa fa-check"></i><b>2.6</b> Hierarchical clustering and heat map</a></li>
<li class="chapter" data-level="2.7" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>2.7</b> Principal component analysis (PCA)</a></li>
<li class="chapter" data-level="2.8" data-path="visualizing-the-iris-flower-data-set.html"><a href="visualizing-the-iris-flower-data-set.html#logistic-regression-for-binary-outcomes-prediction"><i class="fa fa-check"></i><b>2.8</b> Logistic Regression for Binary Outcomes Prediction</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-structures.html"><a href="data-structures.html"><i class="fa fa-check"></i><b>3</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-structures.html"><a href="data-structures.html#basic-concepts"><i class="fa fa-check"></i><b>3.1</b> Basic concepts</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-structures.html"><a href="data-structures.html#expressions"><i class="fa fa-check"></i><b>3.1.1</b> Expressions</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-structures.html"><a href="data-structures.html#logical-values"><i class="fa fa-check"></i><b>3.1.2</b> Logical Values</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-structures.html"><a href="data-structures.html#variables"><i class="fa fa-check"></i><b>3.1.3</b> Variables</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-structures.html"><a href="data-structures.html#functions"><i class="fa fa-check"></i><b>3.1.4</b> Functions</a></li>
<li class="chapter" data-level="3.1.5" data-path="data-structures.html"><a href="data-structures.html#seeking-help-and-example-code"><i class="fa fa-check"></i><b>3.1.5</b> Seeking help and example Code</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-structures.html"><a href="data-structures.html#data-structures-1"><i class="fa fa-check"></i><b>3.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-structures.html"><a href="data-structures.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="data-structures.html"><a href="data-structures.html#matrices"><i class="fa fa-check"></i><b>3.2.2</b> Matrices</a></li>
<li class="chapter" data-level="3.2.3" data-path="data-structures.html"><a href="data-structures.html#data-frames"><i class="fa fa-check"></i><b>3.2.3</b> Data Frames</a></li>
<li class="chapter" data-level="3.2.4" data-path="data-structures.html"><a href="data-structures.html#strings-and-string-vectors"><i class="fa fa-check"></i><b>3.2.4</b> Strings and string vectors</a></li>
<li class="chapter" data-level="3.2.5" data-path="data-structures.html"><a href="data-structures.html#lists"><i class="fa fa-check"></i><b>3.2.5</b> Lists</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html"><i class="fa fa-check"></i><b>4</b> Importing data and managing files</a>
<ul>
<li class="chapter" data-level="4.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#project-oriented-workflow"><i class="fa fa-check"></i><b>4.1</b> Project-oriented workflow</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-project-in-a-new-folder"><i class="fa fa-check"></i><b>4.1.1</b> Create a project in a new folder</a></li>
<li class="chapter" data-level="4.1.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#create-a-script-file-and-comment-please"><i class="fa fa-check"></i><b>4.1.2</b> Create a script file (and Comment, Please!)</a></li>
<li class="chapter" data-level="4.1.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#copy-data-files-to-the-new-directory"><i class="fa fa-check"></i><b>4.1.3</b> Copy data files to the new directory</a></li>
<li class="chapter" data-level="4.1.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#import-data-files"><i class="fa fa-check"></i><b>4.1.4</b> Import data files</a></li>
<li class="chapter" data-level="4.1.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#check-and-convert-data-types"><i class="fa fa-check"></i><b>4.1.5</b> Check and convert data types</a></li>
<li class="chapter" data-level="4.1.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#close-a-project-when-you-are-done"><i class="fa fa-check"></i><b>4.1.6</b> Close a project when you are done</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#read-files-directly-using-read.table"><i class="fa fa-check"></i><b>4.2</b> Read files directly using read.table</a></li>
<li class="chapter" data-level="4.3" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#general-procedure-to-read-data-into-r"><i class="fa fa-check"></i><b>4.3</b> General procedure to read data into R:</a></li>
<li class="chapter" data-level="4.4" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#enter-data-manually"><i class="fa fa-check"></i><b>4.4</b> Enter data manually</a></li>
<li class="chapter" data-level="4.5" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-manipulation-in-a-data-frame"><i class="fa fa-check"></i><b>4.5</b> Data manipulation in a data frame</a></li>
<li class="chapter" data-level="4.6" data-path="importing-data-and-managing-files.html"><a href="importing-data-and-managing-files.html#data-transformation-using-the-dplyr"><i class="fa fa-check"></i><b>4.6</b> Data transformation using the dplyr</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html"><i class="fa fa-check"></i><b>5</b> The heart attack data set (I)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#begin-your-analysis-by-examining-each-column-individually"><i class="fa fa-check"></i><b>5.1</b> Begin your analysis by examining each column individually</a></li>
<li class="chapter" data-level="5.2" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#possible-correlation-between-two-numeric-columns"><i class="fa fa-check"></i><b>5.2</b> Possible correlation between two numeric columns</a></li>
<li class="chapter" data-level="5.3" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Associations between categorical variables</a></li>
<li class="chapter" data-level="5.4" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-a-categorical-and-a-numeric-variables"><i class="fa fa-check"></i><b>5.4</b> Associations between a categorical and a numeric variables</a></li>
<li class="chapter" data-level="5.5" data-path="the-heart-attack-data-set-i.html"><a href="the-heart-attack-data-set-i.html#associations-between-multiple-columns"><i class="fa fa-check"></i><b>5.5</b> Associations between multiple columns</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html"><i class="fa fa-check"></i><b>6</b> The heart attack dataset (II)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#scatter-plot-in-ggplot2"><i class="fa fa-check"></i><b>6.1</b> Scatter plot in ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#histograms-and-density-plots"><i class="fa fa-check"></i><b>6.2</b> Histograms and density plots</a></li>
<li class="chapter" data-level="6.3" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#box-plots-and-violin-plots"><i class="fa fa-check"></i><b>6.3</b> Box plots and Violin plots</a></li>
<li class="chapter" data-level="6.4" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#bar-plot-with-error-bars"><i class="fa fa-check"></i><b>6.4</b> Bar plot with error bars</a></li>
<li class="chapter" data-level="6.5" data-path="the-heart-attack-dataset-ii.html"><a href="the-heart-attack-dataset-ii.html#statistical-models-easy-to-run-tricky-to-interpret"><i class="fa fa-check"></i><b>6.5</b> Statistical models: Easy to Run, tricky to interpret!</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-topics.html"><a href="advanced-topics.html"><i class="fa fa-check"></i><b>7</b> Advanced topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-topics.html"><a href="advanced-topics.html#introduction-to-r-markdown"><i class="fa fa-check"></i><b>7.1</b> Introduction to R Markdown</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-topics.html"><a href="advanced-topics.html#tidyverse"><i class="fa fa-check"></i><b>7.2</b> Tidyverse</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-topics.html"><a href="advanced-topics.html#interactive-plots-made-easy-with-plotly"><i class="fa fa-check"></i><b>7.3</b> Interactive plots made easy with Plotly</a></li>
<li class="chapter" data-level="7.4" data-path="advanced-topics.html"><a href="advanced-topics.html#shiny-apps"><i class="fa fa-check"></i><b>7.4</b> Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-topics.html"><a href="advanced-topics.html#install-the-shiny-package"><i class="fa fa-check"></i><b>7.4.1</b> Install the Shiny package</a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-topics.html"><a href="advanced-topics.html#create-a-shiny-web-app-is-a-piece-of-cake"><i class="fa fa-check"></i><b>7.4.2</b> Create a Shiny web app is a piece of cake</a></li>
<li class="chapter" data-level="7.4.3" data-path="advanced-topics.html"><a href="advanced-topics.html#lets-play"><i class="fa fa-check"></i><b>7.4.3</b> Let’s play!</a></li>
<li class="chapter" data-level="7.4.4" data-path="advanced-topics.html"><a href="advanced-topics.html#publish-your-app"><i class="fa fa-check"></i><b>7.4.4</b> Publish your app</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-topics.html"><a href="advanced-topics.html#define-your-own-function"><i class="fa fa-check"></i><b>7.5</b> Define your own function</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="state-dataset.html"><a href="state-dataset.html"><i class="fa fa-check"></i><b>8</b> State dataset</a>
<ul>
<li class="chapter" data-level="8.1" data-path="state-dataset.html"><a href="state-dataset.html#data-import-and-manipulation"><i class="fa fa-check"></i><b>8.1</b> Data Import and Manipulation</a></li>
<li class="chapter" data-level="8.2" data-path="state-dataset.html"><a href="state-dataset.html#visualizing-data"><i class="fa fa-check"></i><b>8.2</b> Visualizing data</a></li>
<li class="chapter" data-level="8.3" data-path="state-dataset.html"><a href="state-dataset.html#analyzing-the-relationship-among-variables"><i class="fa fa-check"></i><b>8.3</b> Analyzing the relationship among variables</a></li>
<li class="chapter" data-level="8.4" data-path="state-dataset.html"><a href="state-dataset.html#the-whole-picture-of-the-data-set"><i class="fa fa-check"></i><b>8.4</b> The whole picture of the data set</a></li>
<li class="chapter" data-level="8.5" data-path="state-dataset.html"><a href="state-dataset.html#linear-model-analysis"><i class="fa fa-check"></i><b>8.5</b> Linear model analysis</a></li>
<li class="chapter" data-level="8.6" data-path="state-dataset.html"><a href="state-dataset.html#conclusion"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html"><i class="fa fa-check"></i><b>9</b> The game sales dataset</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#reading-in-data-and-managing-the-dataset"><i class="fa fa-check"></i><b>9.1</b> Reading in data and managing the dataset</a></li>
<li class="chapter" data-level="9.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#visualization-of-categorical-variables"><i class="fa fa-check"></i><b>9.2</b> Visualization of categorical variables</a></li>
<li class="chapter" data-level="9.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#correlation-among-numeric-variables"><i class="fa fa-check"></i><b>9.3</b> Correlation among numeric variables</a></li>
<li class="chapter" data-level="9.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-score-and-count"><i class="fa fa-check"></i><b>9.4</b> Analysis of score and count</a></li>
<li class="chapter" data-level="9.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#analysis-of-sales"><i class="fa fa-check"></i><b>9.5</b> Analysis of sales</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-year.release"><i class="fa fa-check"></i><b>9.5.1</b> By Year.Release</a></li>
<li class="chapter" data-level="9.5.2" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-region"><i class="fa fa-check"></i><b>9.5.2</b> By Region</a></li>
<li class="chapter" data-level="9.5.3" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating"><i class="fa fa-check"></i><b>9.5.3</b> By Rating</a></li>
<li class="chapter" data-level="9.5.4" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-genre"><i class="fa fa-check"></i><b>9.5.4</b> By Genre</a></li>
<li class="chapter" data-level="9.5.5" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-score"><i class="fa fa-check"></i><b>9.5.5</b> by Score</a></li>
<li class="chapter" data-level="9.5.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-rating-genre-critic-score"><i class="fa fa-check"></i><b>9.5.6</b> By Rating &amp; Genre &amp; Critic score</a></li>
<li class="chapter" data-level="9.5.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#by-platform"><i class="fa fa-check"></i><b>9.5.7</b> By Platform</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#effect-of-platform-type-on-principle-components"><i class="fa fa-check"></i><b>9.6</b> Effect of platform type on principle components</a></li>
<li class="chapter" data-level="9.7" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#models-for-global-sales"><i class="fa fa-check"></i><b>9.7</b> Models for global sales</a></li>
<li class="chapter" data-level="9.8" data-path="the-game-sales-dataset.html"><a href="the-game-sales-dataset.html#conclusion-1"><i class="fa fa-check"></i><b>9.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html"><i class="fa fa-check"></i><b>10</b> The messy salary data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#data-preparation-and-cleaning"><i class="fa fa-check"></i><b>10.1</b> Data Preparation and Cleaning</a></li>
<li class="chapter" data-level="10.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#variable-analysis"><i class="fa fa-check"></i><b>10.2</b> Variable Analysis</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#income-and-age"><i class="fa fa-check"></i><b>10.2.1</b> Income and age</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group"><i class="fa fa-check"></i><b>10.2.2</b> Ethnic group</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex"><i class="fa fa-check"></i><b>10.2.3</b> Sex</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#union-descreption"><i class="fa fa-check"></i><b>10.2.4</b> Union descreption</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income"><i class="fa fa-check"></i><b>10.3</b> Analysis of gross income</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#age"><i class="fa fa-check"></i><b>10.3.1</b> Age</a></li>
<li class="chapter" data-level="10.3.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#sex-1"><i class="fa fa-check"></i><b>10.3.2</b> Sex</a></li>
<li class="chapter" data-level="10.3.3" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#ethnic-group-1"><i class="fa fa-check"></i><b>10.3.3</b> Ethnic Group</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#analysis-of-gross-income-types"><i class="fa fa-check"></i><b>10.4</b> Analysis of gross income types</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#defining-gross-income-types"><i class="fa fa-check"></i><b>10.4.1</b> Defining Gross income types</a></li>
<li class="chapter" data-level="10.4.2" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#the-intersection-of-ethnic-sex-and-age"><i class="fa fa-check"></i><b>10.4.2</b> The Intersection of Ethnic, Sex and age</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#lm-and-anova-analysis"><i class="fa fa-check"></i><b>10.5</b> LM and ANOVA analysis</a></li>
<li class="chapter" data-level="10.6" data-path="the-messy-salary-data.html"><a href="the-messy-salary-data.html#conclusion-2"><i class="fa fa-check"></i><b>10.6</b> Conclusion</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learn R through examples</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="state-dataset" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> State dataset<a href="state-dataset.html#state-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="data-import-and-manipulation" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Data Import and Manipulation<a href="state-dataset.html#data-import-and-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Welcome to the wild world of state datasets! We’re time-traveling back to the groovy 1970s in the USA. Our mission? To explore three datasets: state.abb, state.x77, and state.region. Here’s a snappy overview:</p>
<p><strong>state.abb</strong>: A vector of 2-letter state name abbreviations. <em>“Who’s CA? Oh, California!”</em></p>
<p><strong>state.x77</strong>: A 50x8 matrix containing the following statistics in its columns:</p>
<ul>
<li><p>Population: population estimate as of July 1, 1975</p></li>
<li><p>Income: per capita income (1974)</p></li>
<li><p>Illiteracy: illiteracy (1970, percent of population)</p></li>
<li><p>Life Exp: life expectancy in years (1969-71)</p></li>
<li><p>Murder: murder and non-negligent manslaughter rate per 100,000 population (1976)</p></li>
<li><p>HS Grad: percent high-school graduates (1970)</p></li>
<li><p>Frost: mean number of days with minimum temperature below freezing (1931-1960) in capital or large city</p></li>
<li><p>Area: land area in square miles</p></li>
</ul>
<p><strong>state.region</strong>:
A factor containing the regions (Northeast, South, North Central, West) that each state belongs to.</p>
<p>To avoid a data scavenger hunt, let’s merge these three datasets into one mega data frame “sta” with 10 columns and 50 rows!</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="state-dataset.html#cb784-1" tabindex="-1"></a>tem <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(state.x77)               <span class="co"># Transform matrix into data frame</span></span>
<span id="cb784-2"><a href="state-dataset.html#cb784-2" tabindex="-1"></a>sta <span class="ot">&lt;-</span> <span class="fu">cbind</span>(state.abb, tem, state.region) <span class="co"># Combine the three data sets</span></span>
<span id="cb784-3"><a href="state-dataset.html#cb784-3" tabindex="-1"></a><span class="fu">colnames</span>(sta)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;State&quot;</span>                <span class="co"># Rename first column</span></span>
<span id="cb784-4"><a href="state-dataset.html#cb784-4" tabindex="-1"></a><span class="fu">colnames</span>(sta)[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Region&quot;</span>              <span class="co"># Rename the 10th column</span></span>
<span id="cb784-5"><a href="state-dataset.html#cb784-5" tabindex="-1"></a><span class="fu">head</span>(sta)</span></code></pre></div>
<pre><code>##            State Population Income Illiteracy Life.Exp Murder HS.Grad Frost
## Alabama       AL       3615   3624        2.1    69.05   15.1    41.3    20
## Alaska        AK        365   6315        1.5    69.31   11.3    66.7   152
## Arizona       AZ       2212   4530        1.8    70.55    7.8    58.1    15
## Arkansas      AR       2110   3378        1.9    70.66   10.1    39.9    65
## California    CA      21198   5114        1.1    71.71   10.3    62.6    20
## Colorado      CO       2541   4884        0.7    72.06    6.8    63.9   166
##              Area Region
## Alabama     50708  South
## Alaska     566432   West
## Arizona    113417   West
## Arkansas    51945  South
## California 156361   West
## Colorado   103766   West</code></pre>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="state-dataset.html#cb786-1" tabindex="-1"></a><span class="fu">str</span>(sta)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    50 obs. of  10 variables:
##  $ State     : chr  &quot;AL&quot; &quot;AK&quot; &quot;AZ&quot; &quot;AR&quot; ...
##  $ Population: num  3615 365 2212 2110 21198 ...
##  $ Income    : num  3624 6315 4530 3378 5114 ...
##  $ Illiteracy: num  2.1 1.5 1.8 1.9 1.1 0.7 1.1 0.9 1.3 2 ...
##  $ Life.Exp  : num  69 69.3 70.5 70.7 71.7 ...
##  $ Murder    : num  15.1 11.3 7.8 10.1 10.3 6.8 3.1 6.2 10.7 13.9 ...
##  $ HS.Grad   : num  41.3 66.7 58.1 39.9 62.6 63.9 56 54.6 52.6 40.6 ...
##  $ Frost     : num  20 152 15 65 20 166 139 103 11 60 ...
##  $ Area      : num  50708 566432 113417 51945 156361 ...
##  $ Region    : Factor w/ 4 levels &quot;Northeast&quot;,&quot;South&quot;,..: 2 4 4 2 4 4 1 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="state-dataset.html#cb788-1" tabindex="-1"></a><span class="fu">summary</span>(sta)</span></code></pre></div>
<pre><code>##     State             Population        Income       Illiteracy   
##  Length:50          Min.   :  365   Min.   :3098   Min.   :0.500  
##  Class :character   1st Qu.: 1080   1st Qu.:3993   1st Qu.:0.625  
##  Mode  :character   Median : 2838   Median :4519   Median :0.950  
##                     Mean   : 4246   Mean   :4436   Mean   :1.170  
##                     3rd Qu.: 4968   3rd Qu.:4814   3rd Qu.:1.575  
##                     Max.   :21198   Max.   :6315   Max.   :2.800  
##     Life.Exp         Murder          HS.Grad          Frost       
##  Min.   :67.96   Min.   : 1.400   Min.   :37.80   Min.   :  0.00  
##  1st Qu.:70.12   1st Qu.: 4.350   1st Qu.:48.05   1st Qu.: 66.25  
##  Median :70.67   Median : 6.850   Median :53.25   Median :114.50  
##  Mean   :70.88   Mean   : 7.378   Mean   :53.11   Mean   :104.46  
##  3rd Qu.:71.89   3rd Qu.:10.675   3rd Qu.:59.15   3rd Qu.:139.75  
##  Max.   :73.60   Max.   :15.100   Max.   :67.30   Max.   :188.00  
##       Area                  Region  
##  Min.   :  1049   Northeast    : 9  
##  1st Qu.: 36985   South        :16  
##  Median : 54277   North Central:12  
##  Mean   : 70736   West         :13  
##  3rd Qu.: 81163                     
##  Max.   :566432</code></pre>
</div>
<div id="visualizing-data" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Visualizing data<a href="state-dataset.html#visualizing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s start by visualizing the distributions of numeric variables, where numbers transform into stories! In many cases, we want to know if our data follows a normal distribution or not so that we can decide whether some analysis methods are suitable or not. Let’s dive into the world of histograms, Q-Q plots, and the intriguing Shapiro-Wilk test. Ready? Here we go!</p>
<ul>
<li><p>Histogram: Does the histogram approach a normal density curve? If yes, then the variable more likely follows a normal distribution.</p></li>
<li><p>Q-Q plot: Do the sample quantiles almost fall into a straight line? A yes here also hints a normal distribution.</p></li>
<li><p>Shapiro-Wilk test: This is a widely used normality test. The null hypothesis is that a variable follows a normal distribution. A tiny p-value indicates a non-normality of the variable.</p></li>
</ul>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="state-dataset.html#cb790-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">colnames</span>(sta)[<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>] <span class="co"># Pick up all numeric columns/variables according to the names </span></span>
<span id="cb790-2"><a href="state-dataset.html#cb790-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>))    <span class="co"># Layout outputs in 4 rows and 4 columns</span></span>
<span id="cb790-3"><a href="state-dataset.html#cb790-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)){ </span>
<span id="cb790-4"><a href="state-dataset.html#cb790-4" tabindex="-1"></a>  sub <span class="ot">=</span> sta[a[i]][, <span class="dv">1</span>]   <span class="co"># Extract corresponding variable a[i] in sta</span></span>
<span id="cb790-5"><a href="state-dataset.html#cb790-5" tabindex="-1"></a>  <span class="fu">hist</span>(sub, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Hist. of&quot;</span>, a[i], <span class="at">sep =</span> <span class="st">&quot; &quot;</span>), <span class="at">xlab =</span> a[i])</span>
<span id="cb790-6"><a href="state-dataset.html#cb790-6" tabindex="-1"></a>  <span class="fu">qqnorm</span>(sub, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Q-Q Plot of&quot;</span>, a[i], <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)) <span class="co">#</span></span>
<span id="cb790-7"><a href="state-dataset.html#cb790-7" tabindex="-1"></a>  <span class="fu">qqline</span>(sub)           <span class="co"># Add a QQ plot line. </span></span>
<span id="cb790-8"><a href="state-dataset.html#cb790-8" tabindex="-1"></a> </span>
<span id="cb790-9"><a href="state-dataset.html#cb790-9" tabindex="-1"></a>   <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb790-10"><a href="state-dataset.html#cb790-10" tabindex="-1"></a>     s.t <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(sub) <span class="co"># Normality test for population</span></span>
<span id="cb790-11"><a href="state-dataset.html#cb790-11" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb790-12"><a href="state-dataset.html#cb790-12" tabindex="-1"></a>     s.t <span class="ot">&lt;-</span> <span class="fu">rbind</span>(s.t, <span class="fu">shapiro.test</span>(sub)) <span class="co"># Bind a new test result to previous row</span></span>
<span id="cb790-13"><a href="state-dataset.html#cb790-13" tabindex="-1"></a> }</span>
<span id="cb790-14"><a href="state-dataset.html#cb790-14" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-446-1.png" width="768" /></p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="state-dataset.html#cb791-1" tabindex="-1"></a>s.t <span class="ot">&lt;-</span> s.t[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]       <span class="co"># Take the first two columns of shapiro.test result</span></span>
<span id="cb791-2"><a href="state-dataset.html#cb791-2" tabindex="-1"></a>s.t <span class="ot">&lt;-</span> <span class="fu">cbind</span>(a, s.t)    <span class="co"># Add variable name for the result</span></span>
<span id="cb791-3"><a href="state-dataset.html#cb791-3" tabindex="-1"></a>s.t</span></code></pre></div>
<pre><code>##     a            statistic p.value     
## s.t &quot;Population&quot; 0.769992  1.906393e-07
##     &quot;Income&quot;     0.9769037 0.4300105   
##     &quot;Illiteracy&quot; 0.8831491 0.0001396258
##     &quot;Life.Exp&quot;   0.97724   0.4423285   
##     &quot;Murder&quot;     0.9534691 0.04744626  
##     &quot;HS.Grad&quot;    0.9531029 0.04581562  
##     &quot;Frost&quot;      0.9545618 0.05267472  
##     &quot;Area&quot;       0.5717872 7.591835e-11</code></pre>
<p>From the histograms and QQ plots we can see that the distributions of Population, Illiteracy, and Area are doing a leftward lean. Income and Life.Exp, however, are playing it close to normal. The shapiro tests reveal Income, Life.Exp and Frost as normal party-goers with p-values greater than 0.05, while Murder and HS.Grad are almost normal, but not quite there. Population, Illiteracy, and Area, unfortunately, didn’t get the normality invite.</p>
<p>Now, what about the categorical variable, region? Let’s peek into how states are spread across regions.</p>

<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="state-dataset.html#cb793-1" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(sta<span class="sc">$</span>Region), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)  <span class="co"># Number of states in each region</span></span>
<span id="cb793-2"><a href="state-dataset.html#cb793-2" tabindex="-1"></a>percentages <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> counts <span class="sc">/</span> <span class="fu">length</span>(sta<span class="sc">$</span>Region)      </span>
<span id="cb793-3"><a href="state-dataset.html#cb793-3" tabindex="-1"></a><span class="fu">barplot</span>(percentages, <span class="at">ylab =</span> <span class="st">&quot;Percentage&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>) </span>
<span id="cb793-4"><a href="state-dataset.html#cb793-4" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="fl">0.7</span>, <span class="dv">5</span>, <span class="fl">1.2</span>), <span class="dv">2</span>, <span class="fu">paste</span>(<span class="st">&quot;n=&quot;</span>, counts))      <span class="co"># Add count to each bar</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-region"></span>
<img src="book_files/figure-html/state-region-1.png" alt="State count in each region." width="672" />
<p class="caption">
Figure 8.1: State count in each region.
</p>
</div>
<p>The barplot tells us that we have relatively more states in the South(16) and fewer states in the Northeast(9). North Central and West are almost twins with 12 and 13 states respectively.</p>
<p>Ever heard of a lollipop plot? It’s a hybrid of a scatter plot and a barplot. Here is the lollipop chart showcases the relationship between states and their population.</p>

<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="state-dataset.html#cb794-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb794-2"><a href="state-dataset.html#cb794-2" tabindex="-1"></a><span class="fu">ggplot</span>(sta, <span class="fu">aes</span>(<span class="at">x =</span> State, <span class="at">y =</span> Population)) <span class="sc">+</span></span>
<span id="cb794-3"><a href="state-dataset.html#cb794-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb794-4"><a href="state-dataset.html#cb794-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> State, <span class="at">xend =</span> State, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> Population)) <span class="sc">+</span></span>
<span id="cb794-5"><a href="state-dataset.html#cb794-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Rotate axis label</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-pop"></span>
<img src="book_files/figure-html/state-pop-1.png" alt="Loppipop plot of the population in each state." width="672" />
<p class="caption">
Figure 8.2: Loppipop plot of the population in each state.
</p>
</div>
<p>Even back in the early days, California and New York were the hotspots, while South Dakota was more of a quiet retreat.</p>
<p>More Questions to Ponder: How did the murder rate vary across states and regions in those days? What influenced it? Could other factors explain the murder rate?</p>
<p>A choropleth map may give us an overall view.</p>

<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="state-dataset.html#cb795-1" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb795-2"><a href="state-dataset.html#cb795-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb795-3"><a href="state-dataset.html#cb795-3" tabindex="-1"></a>sta<span class="sc">$</span>region <span class="ot">&lt;-</span> <span class="fu">tolower</span>(state.name)  <span class="co"># Lowercase states&#39; names</span></span>
<span id="cb795-4"><a href="state-dataset.html#cb795-4" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">&quot;state&quot;</span>)        <span class="co"># Extract state data</span></span>
<span id="cb795-5"><a href="state-dataset.html#cb795-5" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">merge</span>(states, sta, <span class="at">by =</span> <span class="st">&quot;region&quot;</span>, <span class="at">all.x =</span> T)  <span class="co"># Merge states and state.x77 data</span></span>
<span id="cb795-6"><a href="state-dataset.html#cb795-6" tabindex="-1"></a>map <span class="ot">&lt;-</span> map[<span class="fu">order</span>(map<span class="sc">$</span>order), ]     <span class="co"># Must order first</span></span>
<span id="cb795-7"><a href="state-dataset.html#cb795-7" tabindex="-1"></a><span class="fu">ggplot</span>(map, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span>  </span>
<span id="cb795-8"><a href="state-dataset.html#cb795-8" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Murder)) <span class="sc">+</span>   </span>
<span id="cb795-9"><a href="state-dataset.html#cb795-9" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb795-10"><a href="state-dataset.html#cb795-10" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">heat.colors</span>(<span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb795-11"><a href="state-dataset.html#cb795-11" tabindex="-1"></a>  <span class="fu">coord_map</span>() <span class="sc">+</span></span>
<span id="cb795-12"><a href="state-dataset.html#cb795-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb795-13"><a href="state-dataset.html#cb795-13" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">&quot;Murder Rate&quot;</span>))   </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-map"></span>
<img src="book_files/figure-html/state-map-1.png" alt="Map of murder rate distribution." width="672" />
<p class="caption">
Figure 8.3: Map of murder rate distribution.
</p>
</div>
<p>A glance at the map reveals a gradient of concern: redder shapes in the South and East, suggesting higher danger, while the North Central, Northwest, and Northeast appear calmer in yellow.</p>

<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="state-dataset.html#cb796-1" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb796-2"><a href="state-dataset.html#cb796-2" tabindex="-1"></a><span class="fu">ggplot</span>(sta, <span class="fu">aes</span>(<span class="at">x =</span> Murder, <span class="at">y =</span> Region, <span class="at">fill =</span> Region)) <span class="sc">+</span></span>
<span id="cb796-3"><a href="state-dataset.html#cb796-3" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb796-4"><a href="state-dataset.html#cb796-4" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span>                                 <span class="co"># No color on backgroud</span></span>
<span id="cb796-5"><a href="state-dataset.html#cb796-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,                  <span class="co"># No show legend</span></span>
<span id="cb796-6"><a href="state-dataset.html#cb796-6" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  <span class="co"># x axis title in the center</span></span>
<span id="cb796-7"><a href="state-dataset.html#cb796-7" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))  <span class="co"># y axis title in the center</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-murder"></span>
<img src="book_files/figure-html/state-murder-1.png" alt="Ridgeline plot for murder rate in each region." width="672" />
<p class="caption">
Figure 8.4: Ridgeline plot for murder rate in each region.
</p>
</div>
<p>The ridgeline plot confirms our map’s story. South is leaning right with higher murder rates, while the other regions are more left-leaning.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-447}</p>
</blockquote>
<blockquote>
<p>Similar to Figure <a href="state-dataset.html#fig:state-map">8.3</a>, weave your magic to craft an Illiteracy map using state.x77 data set and give a brief interpretation. Hint: Combine state.abb and state.x77 first or use the row names of state.x77 data set directly. You may start from importing the data:</p>
<p>tem &lt;- data.frame(state.x77)</p>
<p>sta &lt;- cbind(state.abb, tem, state.region)</p>
<p>colnames(sta)[10] &lt;- “Region”</p>
<p>:::</p>
</blockquote>
<blockquote>
<p>::: {.exercise #unnamed-chunk-448}</p>
</blockquote>
<blockquote>
<p>Similar to Figure <a href="state-dataset.html#fig:state-murder">8.4</a>, conjure up a ridgeline plot to explore the regional distribution of Illiteracy using state.x77 and state.region data sets and interpret your figure.
:::</p>
</blockquote>
</div>
<div id="analyzing-the-relationship-among-variables" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Analyzing the relationship among variables<a href="state-dataset.html#analyzing-the-relationship-among-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A scatter matrix is a pair-wise scatter plot of multiple variables presented in a matrix format. It’s perfect for eyeballing linear relationships among variables in a single plot. The correlation coefficient, ranging from -1 to 1, is the gossip scale. A -1 coefficient means two variables are in a bitter feud (think y=-x), while a 1 indicates a blossoming friendship (like y=2x+1). Now, let’s peek into the lives of our state data variables.</p>

<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="state-dataset.html#cb797-1" tabindex="-1"></a>st <span class="ot">&lt;-</span> sta[, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>] <span class="co"># Take numeric variables as goal matrix</span></span>
<span id="cb797-2"><a href="state-dataset.html#cb797-2" tabindex="-1"></a><span class="fu">library</span>(ellipse) </span>
<span id="cb797-3"><a href="state-dataset.html#cb797-3" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb797-4"><a href="state-dataset.html#cb797-4" tabindex="-1"></a>corMatrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(st)) <span class="co"># Calculate correlation matrix</span></span>
<span id="cb797-5"><a href="state-dataset.html#cb797-5" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;blue&quot;</span>))  <span class="co"># 3 colors to represent coefficients -1 to 1.</span></span>
<span id="cb797-6"><a href="state-dataset.html#cb797-6" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(corMatrix, <span class="at">order =</span> <span class="st">&quot;AOE&quot;</span>, <span class="at">lower =</span> <span class="st">&quot;number&quot;</span>, <span class="at">lower.col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb797-7"><a href="state-dataset.html#cb797-7" tabindex="-1"></a>               <span class="at">number.cex =</span> .<span class="dv">8</span>, <span class="at">upper =</span> <span class="st">&quot;ellipse&quot;</span>,  <span class="at">upper.col =</span> <span class="fu">col</span>(<span class="dv">10</span>), </span>
<span id="cb797-8"><a href="state-dataset.html#cb797-8" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">&quot;u&quot;</span>, <span class="at">tl.pos =</span> <span class="st">&quot;lt&quot;</span>, <span class="at">tl.col =</span> <span class="st">&quot;black&quot;</span>) <span class="co"># Mix plots of &quot;number&quot; and &quot;ellipse&quot;</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-corrplot"></span>
<img src="book_files/figure-html/state-corrplot-1.png" alt="Corrplot for numeric variables." width="576" />
<p class="caption">
Figure 8.5: Corrplot for numeric variables.
</p>
</div>
<p>Look at the top-right of the correlation figure. A stark red, narrow ellipse between Murder and Life.Exp signalizes a high negative correlation. Conversely, the cozy blue showing between Murder and Illiteracy implies a high positive correlation. The red-orange hues between Murder and Frost, HS.Grad suggest a mild negative correlation. The orange shape between Murder and Income shows slight negative correlation. While light-blue tones between Murder and both Area and Population indicate a small positive correlation.</p>
<p>The pearson and spearman correlation matrix on the bottom-left gives us the r-values between each pair of the variables, which confirm the correlation details on the top-right.</p>
<p>Positive correlation between Murder and Illiteracy (r-value: 0.70) is like saying, “Less school, more trouble”. Negative correlations between Murder and Life.Exp, Frost (r-values: -0.78, -0.54) can be interpreted as “More mayhem, shorter lifespans”, and “Murderers dislike winter”. Fascinating, isn’t it?</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-449}</p>
</blockquote>
<blockquote>
<p>Similar to Figure <a href="state-dataset.html#fig:state-corrplot">8.5</a>, creat a scatter matrix among 7 variables: <em>mpg</em>, <em>cyl</em>, <em>disp</em>, <em>hp</em>, <em>drat</em>, <em>wt</em> and <em>qsec</em> in the data set <em>mtcars</em>. Give a brief interpretation of the plot.
:::</p>
</blockquote>
<p>Now let’s see the cluster situation of these variables.</p>

<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="state-dataset.html#cb798-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(<span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(st)))))  <span class="co"># Hierarchical clustering</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-dendrogram"></span>
<img src="book_files/figure-html/state-dendrogram-1.png" alt="Cluster dendrogram for state numeric variables." width="672" />
<p class="caption">
Figure 8.6: Cluster dendrogram for state numeric variables.
</p>
</div>
<p>The cluster Dendrogram reveals two clusters for these variables. Murder cozies up to Illiteracy mostly, and then to Population and Area. Meanwhile, HS.Grad prefers hanging out with Income mostly, then with Life.Exp and Frost. Though illiteracy and HS.Grad are in the different clusters, they share a bond: for the same state, the lower the illiteracy, the higher the high school graduation rate. An r-value of -0.66 between Illiteracy and HS.Grad in the corrplot confirms this clandestine relationship.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-450}</p>
</blockquote>
<blockquote>
<p>Similar to Figure <a href="state-dataset.html#fig:state-dendrogram">8.6</a>, creat a cluster dendrogram of the 7 variables: <em>mpg</em>, <em>cyl</em>, <em>disp</em>, <em>hp</em>, <em>drat</em>, <em>wt</em> and <em>qsec</em> in the data set <em>mtcars</em>. What does your output reveal?
:::</p>
</blockquote>
<p>Now, who’s ready to talk about illiteracy? Let’s see a density plot about the distribution of Illiteracy by region.</p>

<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="state-dataset.html#cb799-1" tabindex="-1"></a><span class="fu">ggplot</span>(sta, <span class="fu">aes</span>(<span class="at">x =</span> Illiteracy, <span class="at">fill =</span> Region)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-illiteracy"></span>
<img src="book_files/figure-html/state-illiteracy-1.png" alt="Illiteracy distribution by region." width="672" />
<p class="caption">
Figure 8.7: Illiteracy distribution by region.
</p>
</div>
<p>Here’s a juicy tidbit: The North-Central region seems to have its illiteracy act together, mostly under 1%. While the south region has an open and bell-shaped distribution with illiteracy ranging from 0.5 to 3. Though region west has a spread out distribution too, it’s left-skewed; Most west states keep illiteracy of less than 1% of their populations. The Northeast, mostly under 1.5%, is also keeping illiteracy on a short leash.</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-451}</p>
</blockquote>
<blockquote>
<p>Similar to Figure <a href="state-dataset.html#fig:state-illiteracy">8.7</a>, use density plot to explore the distribution of <em>mpg</em> by <em>cyl</em> in the data set <em>mtcars</em>.
:::</p>
</blockquote>
<p>Because of the relationship of Murder with both Population and Area, now We add one more column of Pop.Density in the mix, which is the population per square miles of area.</p>

<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="state-dataset.html#cb800-1" tabindex="-1"></a>sta<span class="sc">$</span>Pop.Density <span class="ot">&lt;-</span> sta<span class="sc">$</span>Population<span class="sc">/</span>sta<span class="sc">$</span>Area</span>
<span id="cb800-2"><a href="state-dataset.html#cb800-2" tabindex="-1"></a><span class="fu">boxplot</span>(sta<span class="sc">$</span>Pop.Density <span class="sc">~</span> sta<span class="sc">$</span>Region, <span class="at">xlab =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Population Density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-population"></span>
<img src="book_files/figure-html/state-population-1.png" alt="Box plot of population density by region." width="672" />
<p class="caption">
Figure 8.8: Box plot of population density by region.
</p>
</div>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="state-dataset.html#cb801-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(sta<span class="sc">$</span>Pop.Density <span class="sc">~</span> sta<span class="sc">$</span>Region, sta)</span>
<span id="cb801-2"><a href="state-dataset.html#cb801-2" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## sta$Region   3  1.051  0.3502      12 6.3e-06 ***
## Residuals   46  1.343  0.0292                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The box plot shows that the mean Pop.Density of Northeast is much more than the other regions, while West has the lowest mean Pop.Density. The ANOVA test with a p-value of 6.3e-06 gives us the evidence to reject the null hypothesis that the mean Pop.Densities are the same for different regions, which means at least one of the regional mean population densities is different from the others. Not all regional Pop.Densities are created equal. Scandalous!</p>
<p>But wait, there’s more! Let’s check out Illiteracy and Murder with a dash of Population per area, and the region too.</p>

<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="state-dataset.html#cb803-1" tabindex="-1"></a><span class="fu">ggplot</span>(sta, <span class="fu">aes</span>(<span class="at">x =</span> Illiteracy, <span class="at">y =</span> Murder)) <span class="sc">+</span> </span>
<span id="cb803-2"><a href="state-dataset.html#cb803-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> Pop.Density, <span class="at">color =</span> Region)) <span class="sc">+</span> </span>
<span id="cb803-3"><a href="state-dataset.html#cb803-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>,<span class="at">formula =</span> y <span class="sc">~</span> x)  <span class="co"># Add regression line</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-IlliteracyMurder"></span>
<img src="book_files/figure-html/state-IlliteracyMurder-1.png" alt="Scatterplot for illiteracy and murder sized by population density and colored by region." width="672" />
<p class="caption">
Figure 8.9: Scatterplot for illiteracy and murder sized by population density and colored by region.
</p>
</div>
<p>The scatter plot shows that many Northeast states have big population densities but middle-of-the-road illiteracy rates compared with the states in the other three regions. Murder and illiteracy are positively correlated. Southern states take the spotlight with higher murder rates and illiteracy levels.</p>
<p>Because of the high correlation of murder and Life.Exp, we will take a look at the distribution of Life.Exp.</p>

<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="state-dataset.html#cb804-1" tabindex="-1"></a><span class="fu">ggplot</span>(sta, <span class="fu">aes</span>(<span class="at">x =</span> Region, <span class="at">y =</span> Life.Exp, <span class="at">fill =</span> Region)) <span class="sc">+</span> </span>
<span id="cb804-2"><a href="state-dataset.html#cb804-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb804-3"><a href="state-dataset.html#cb804-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-LifeExp"></span>
<img src="book_files/figure-html/state-LifeExp-1.png" alt="Regional life expectancy." width="672" />
<p class="caption">
Figure 8.10: Regional life expectancy.
</p>
</div>
<p>On average, the south is singing the blues with a lower life expectancy than the other three regions. North Central, on the other hand, is living its best life with the highest Life.Exp. West has extending distribution with two long tails on each end, which means some west states have very long life expectancy, while some expect short life expectancy though they are in the same region.</p>
<p>Now, let’s talk about murder’s relationship drama with Life.Exp, HS.Grad, and Income.</p>
<p>First we categorize the income into 5 IncomeTypes.</p>

<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="state-dataset.html#cb805-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb805-2"><a href="state-dataset.html#cb805-2" tabindex="-1"></a><span class="co"># Group income into IncomeType first</span></span>
<span id="cb805-3"><a href="state-dataset.html#cb805-3" tabindex="-1"></a>sta.income <span class="ot">&lt;-</span> sta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">IncomeType =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(Income <span class="sc">&lt;</span> <span class="dv">3500</span>, <span class="st">&quot;Under3500&quot;</span>,  </span>
<span id="cb805-4"><a href="state-dataset.html#cb805-4" tabindex="-1"></a>                             <span class="fu">ifelse</span>(Income <span class="sc">&lt;</span> <span class="dv">4000</span> <span class="sc">&amp;</span> Income <span class="sc">&gt;=</span> <span class="dv">3500</span>, <span class="st">&quot;3500-4000&quot;</span>,</span>
<span id="cb805-5"><a href="state-dataset.html#cb805-5" tabindex="-1"></a>                               <span class="fu">ifelse</span>(Income <span class="sc">&lt;</span> <span class="dv">4500</span> <span class="sc">&amp;</span> Income <span class="sc">&gt;=</span> <span class="dv">4000</span>, <span class="st">&quot;4000-4500&quot;</span>,</span>
<span id="cb805-6"><a href="state-dataset.html#cb805-6" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(Income <span class="sc">&lt;</span> <span class="dv">5000</span> <span class="sc">&amp;</span> Income <span class="sc">&gt;=</span> <span class="dv">4500</span>, <span class="st">&quot;4500-5000&quot;</span>, </span>
<span id="cb805-7"><a href="state-dataset.html#cb805-7" tabindex="-1"></a>                                   <span class="st">&quot;Above5000&quot;</span>))))))</span>
<span id="cb805-8"><a href="state-dataset.html#cb805-8" tabindex="-1"></a><span class="fu">ggplot</span>(sta.income, <span class="fu">aes</span>(<span class="at">x =</span> Murder, <span class="at">y =</span> Life.Exp)) <span class="sc">+</span> </span>
<span id="cb805-9"><a href="state-dataset.html#cb805-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> IncomeType, <span class="at">color =</span> Region, <span class="at">size =</span> HS.Grad)) <span class="sc">+</span> </span>
<span id="cb805-10"><a href="state-dataset.html#cb805-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-LifeMurder"></span>
<img src="book_files/figure-html/state-LifeMurder-1.png" alt="Relationship between murder rate and life expectancy, high school graduation, and income." width="672" />
<p class="caption">
Figure 8.11: Relationship between murder rate and life expectancy, high school graduation, and income.
</p>
</div>
<p>Murder rate is negatively correlated with Life.Exp. Those small symbols with high murder rates? They’re from the South with lower HS.Grad rates and lower Life.Exp.</p>
<p>Left-skewing of most square and triangle symbols hints that wealthier states are often less murderous. But it’s a complex factor, some high income states with incomes above 5000 and cross symbols had high Murder rate too(close to 12).</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-452}</p>
</blockquote>
<blockquote>
<p>Now it’s your turn to be the director. Use a scatter plot to analyze the correlation between Illiteracy and those variables in the other cluster shown in Figure <a href="state-dataset.html#fig:state-dendrogram">8.6</a>. Interpret your plot.
:::</p>
</blockquote>
</div>
<div id="the-whole-picture-of-the-data-set" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> The whole picture of the data set<a href="state-dataset.html#the-whole-picture-of-the-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve been analyzing the connections between murder rate and the various other variables in both clusters. It turns out that all variables are correlated, more or less. Now, let’s take a helicopter view and see the whole landscape of these variables. Ready for some heat maps and starry diagrams?</p>

<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="state-dataset.html#cb806-1" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb806-2"><a href="state-dataset.html#cb806-2" tabindex="-1"></a>st.matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(st)    <span class="co"># Transfer the data frame to matrix</span></span>
<span id="cb806-3"><a href="state-dataset.html#cb806-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">apply</span>(st.matrix, <span class="dv">2</span>, <span class="cf">function</span>(y)(y <span class="sc">-</span> <span class="fu">mean</span>(y)) <span class="sc">/</span> <span class="fu">sd</span>(y))  <span class="co"># Standardize data</span></span>
<span id="cb806-4"><a href="state-dataset.html#cb806-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">heatmap.2</span>(s, </span>
<span id="cb806-5"><a href="state-dataset.html#cb806-5" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">greenred</span>(<span class="dv">75</span>), <span class="co"># Color green red</span></span>
<span id="cb806-6"><a href="state-dataset.html#cb806-6" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb806-7"><a href="state-dataset.html#cb806-7" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb806-8"><a href="state-dataset.html#cb806-8" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb806-9"><a href="state-dataset.html#cb806-9" tabindex="-1"></a>          <span class="at">RowSideColors =</span> <span class="fu">rainbow</span>(<span class="dv">4</span>)[sta<span class="sc">$</span>Region],  </span>
<span id="cb806-10"><a href="state-dataset.html#cb806-10" tabindex="-1"></a>          <span class="at">srtCol =</span> <span class="dv">45</span>,        <span class="co"># Column labels at 45 degree</span></span>
<span id="cb806-11"><a href="state-dataset.html#cb806-11" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">8</span>),  <span class="co"># Bottom and right margins</span></span>
<span id="cb806-12"><a href="state-dataset.html#cb806-12" tabindex="-1"></a>          <span class="at">lhei =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)     <span class="co"># Relative heights of the rows</span></span>
<span id="cb806-13"><a href="state-dataset.html#cb806-13" tabindex="-1"></a>) </span>
<span id="cb806-14"><a href="state-dataset.html#cb806-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">levels</span>(sta<span class="sc">$</span>Region), <span class="at">fill =</span> <span class="fu">rainbow</span>(<span class="dv">4</span>), <span class="at">cex =</span> <span class="fl">0.8</span>)  <span class="co"># Add legend </span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-heatmap"></span>
<img src="book_files/figure-html/state-heatmap-1.png" alt="Heat map for whole state data set." width="768" />
<p class="caption">
Figure 8.12: Heat map for whole state data set.
</p>
</div>
<p>Much like the cluster Dendrogram plot, Heatmap shows two clusters: Life.Exp, Income, HS.Grad, together with Frost build one cluster, while Illiteracy, Murder, Population, and Area build another cluster.</p>
<p>Compared with other states, lots of southern states with lower Life.Exp, Income, and HS.Grad have higher Murder rates and Illiteracy(Look at Mississippi and Alabama!). On the flip side, some northern and western states, like Nebraska and South Dakota, are living a higher Life.Exp, Income, and HS.Grad but lower Area, Population, Murder, and Illiteracy. South Dakota’s income, though, is a bit green with envy.</p>

<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="state-dataset.html#cb807-1" tabindex="-1"></a><span class="fu">row.names</span>(st) <span class="ot">&lt;-</span> sta<span class="sc">$</span>State</span>
<span id="cb807-2"><a href="state-dataset.html#cb807-2" tabindex="-1"></a><span class="fu">stars</span>(st, <span class="at">key.loc =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="fl">1.5</span>), <span class="at">draw.segments =</span> T)   </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-segment"></span>
<img src="book_files/figure-html/state-segment-1.png" alt="Segment diagram for all states." width="768" />
<p class="caption">
Figure 8.13: Segment diagram for all states.
</p>
</div>
<p>The segment Diagram reveals different facets of each state. Take South Dakota, for instance. It boasts big Frost(yellow), high Life Expectancy(blue), a solid high school graduation rate(pink) and good income(red). On the other side, it has a small area and population. Thankfully, the illiteracy and murder rate are very tiny compared with the other states.</p>
<p>Let’s dive deeper with principal components analysis!</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="state-dataset.html#cb808-1" tabindex="-1"></a>pca <span class="ot">=</span> <span class="fu">prcomp</span>(st, <span class="at">scale =</span> T)  <span class="co"># scale = T to normalize the data</span></span>
<span id="cb808-2"><a href="state-dataset.html#cb808-2" tabindex="-1"></a>pca</span></code></pre></div>
<pre><code>## Standard deviations (1, .., p=8):
## [1] 1.8970755 1.2774659 1.0544862 0.8411327 0.6201949 0.5544923 0.3800642
## [8] 0.3364338
## 
## Rotation (n x k) = (8 x 8):
##                    PC1         PC2         PC3         PC4          PC5
## Population  0.12642809  0.41087417 -0.65632546 -0.40938555 -0.405946365
## Income     -0.29882991  0.51897884 -0.10035919 -0.08844658  0.637586953
## Illiteracy  0.46766917  0.05296872  0.07089849  0.35282802 -0.003525994
## Life.Exp   -0.41161037 -0.08165611 -0.35993297  0.44256334 -0.326599685
## Murder      0.44425672  0.30694934  0.10846751 -0.16560017  0.128068739
## HS.Grad    -0.42468442  0.29876662  0.04970850  0.23157412  0.099264551
## Frost      -0.35741244 -0.15358409  0.38711447 -0.61865119 -0.217363791
## Area       -0.03338461  0.58762446  0.51038499  0.20112550 -0.498506338
##                    PC6          PC7         PC8
## Population  0.01065617  0.062158658  0.21924645
## Income     -0.46177023 -0.009104712 -0.06029200
## Illiteracy -0.38741578  0.619800310  0.33868838
## Life.Exp   -0.21908161  0.256213054 -0.52743331
## Murder      0.32519611  0.295043151 -0.67825134
## HS.Grad     0.64464647  0.393019181  0.30724183
## Frost      -0.21268413  0.472013140 -0.02834442
## Area       -0.14836054 -0.286260213 -0.01320320</code></pre>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="state-dataset.html#cb810-1" tabindex="-1"></a><span class="fu">plot</span>(pca)     <span class="co"># Plot the amount of variance each principal components captures</span></span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-453-1.png" width="672" /></p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="state-dataset.html#cb811-1" tabindex="-1"></a><span class="fu">summary</span>(pca)  <span class="co"># Show the importance of the components</span></span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     1.8971 1.2775 1.0545 0.84113 0.62019 0.55449 0.38006
## Proportion of Variance 0.4499 0.2040 0.1390 0.08844 0.04808 0.03843 0.01806
## Cumulative Proportion  0.4499 0.6539 0.7928 0.88128 0.92936 0.96780 0.98585
##                            PC8
## Standard deviation     0.33643
## Proportion of Variance 0.01415
## Cumulative Proportion  1.00000</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="state-dataset.html#cb813-1" tabindex="-1"></a>percentVar <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">summary</span>(pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="dv">0</span>) <span class="co"># Compute % variances</span></span>
<span id="cb813-2"><a href="state-dataset.html#cb813-2" tabindex="-1"></a>percentVar</span></code></pre></div>
<pre><code>## PC1 PC2 PC3 PC4 PC5 PC6 PC7 
##  45  20  14   9   5   4   2</code></pre>
<p>The first two components are the big cheeses, contributing 45% and 20% of the variance, respectively, collectively account for 65% of the overall variance. The third component, slightly less impactful,still holds 10% of the total variance. The bar plot illustrates the dominance of each individual component.</p>

<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="state-dataset.html#cb815-1" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb815-2"><a href="state-dataset.html#cb815-2" tabindex="-1"></a><span class="fu">row.names</span>(sta) <span class="ot">&lt;-</span> sta<span class="sc">$</span>State</span>
<span id="cb815-3"><a href="state-dataset.html#cb815-3" tabindex="-1"></a><span class="fu">autoplot</span>(<span class="fu">prcomp</span>(st,  <span class="at">scale =</span> T), <span class="at">data =</span> sta, </span>
<span id="cb815-4"><a href="state-dataset.html#cb815-4" tabindex="-1"></a>         <span class="at">colour =</span> <span class="st">&#39;Region&#39;</span>, <span class="at">shape =</span> <span class="cn">FALSE</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="fl">3.5</span>,</span>
<span id="cb815-5"><a href="state-dataset.html#cb815-5" tabindex="-1"></a>         <span class="at">loadings =</span> <span class="cn">TRUE</span>, <span class="at">loadings.colour =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb815-6"><a href="state-dataset.html#cb815-6" tabindex="-1"></a>         <span class="at">loadings.label.size =</span> <span class="dv">4</span>, <span class="at">loadings.label.colour =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:state-bioplot"></span>
<img src="book_files/figure-html/state-bioplot-1.png" alt="Biplot for PCA." width="672" />
<p class="caption">
Figure 8.14: Biplot for PCA.
</p>
</div>
<p>The biplot is like our data’s own reality show, illustrating the special roles of these variables to the component of the variance. Illiteracy positively contributes to variance PC1, while Life.Exp and Frost play a contrasting negative role with PC1. Additionally, Area significantly influences the positive variance in PC2. The other four variables exhibit both sides role, contributing positively or negatively to PC1 and PC2.
Drama ensues as Southern states like Louisiana (LA) and Mississippi (MS) showcase their Illiteracy and Murder rates, while North-Central states like Minnesota (MN) and North Dakota (ND) boast their high Life Expectancy and Frost. Alaska (AK) and California (CA) from the West region flaunt their Big Area feature.</p>
</div>
<div id="linear-model-analysis" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Linear model analysis<a href="state-dataset.html#linear-model-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ready to play detective with numbers? Let’s explore the fascinating realm of linear models to unravel the mystery behind the murder rate. We’re dropping HS.Grad and Frost out of our suspect list due to their high correlation with other variables.</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="state-dataset.html#cb816-1" tabindex="-1"></a>lm.data <span class="ot">&lt;-</span> sta[, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb816-2"><a href="state-dataset.html#cb816-2" tabindex="-1"></a>lm.data <span class="ot">&lt;-</span> <span class="fu">within</span>(lm.data, Region <span class="ot">&lt;-</span> <span class="fu">relevel</span>(Region, <span class="at">ref =</span> <span class="st">&quot;South&quot;</span>))  <span class="co"># Set region South as reference</span></span>
<span id="cb816-3"><a href="state-dataset.html#cb816-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder <span class="sc">~</span> .,  <span class="at">data =</span> lm.data)</span>
<span id="cb816-4"><a href="state-dataset.html#cb816-4" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Murder ~ ., data = lm.data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8178 -0.9446 -0.1485  1.0406  3.5501 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          1.059e+02  1.601e+01   6.611 5.85e-08 ***
## Population           2.591e-04  5.439e-05   4.764 2.39e-05 ***
## Income               2.619e-04  4.870e-04   0.538  0.59362    
## Illiteracy           1.861e+00  5.567e-01   3.343  0.00178 ** 
## Life.Exp            -1.445e+00  2.275e-01  -6.351 1.37e-07 ***
## Area                 1.133e-06  3.407e-06   0.333  0.74117    
## RegionNortheast     -2.673e+00  8.020e-01  -3.333  0.00183 ** 
## RegionNorth Central -7.182e-01  8.712e-01  -0.824  0.41451    
## RegionWest           2.358e-01  8.096e-01   0.291  0.77229    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.552 on 41 degrees of freedom
## Multiple R-squared:  0.852,  Adjusted R-squared:  0.8232 
## F-statistic: 29.51 on 8 and 41 DF,  p-value: 1.168e-14</code></pre>
<p>The prime suspects in influencing the murder rate turn out to be Life Expectancy, Population, and Illiteracy, with the region playing the role of an accessory. Here’s the lowdown: for every step up in Life Expectancy, the murder rate drops by 1.445 units. Conversely, Population and Illiteracy are playing the villains, pushing up the murder rate by 0.000259 and 1.861 units, respectively. Being in the Northeast gets you a 2.673-unit markdown on murder rates. Our model is a rival Sherlock, explaining 82% of the variance in murder rates. Here’s the formula to predict the murder rate:</p>
<p>Murder=105.9-1.445<span class="math inline">\(*Life.Exp+0.000259*\)</span>Population+1.861<span class="math inline">\(*Illiteracy-2.673*\)</span>RegionNortheast</p>
<blockquote>
<p>::: {.exercise #unnamed-chunk-455}</p>
</blockquote>
<blockquote>
<p>Your turn to wear the detective hat! Analyze a linear model for Illiteracy and interpret your result. Hint: Check the corrplot figure <a href="state-dataset.html#fig:state-corrplot">8.5</a> and pay attention to the high correlation between murder rate and life expectancy.
:::</p>
</blockquote>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Conclusion<a href="state-dataset.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>-The southern region shows a higher murder rate with lower life expectancy, income, and high school graduation rate but a higher illiteracy rate. Conversely, the northern region is all about lower murder rate with higher population density, life expectancy, income, and high school graduation rate accompanied by lower illiteracy.</p>
<p>-Fun fact: Data on life expectancy, population, illiteracy of the state in the 1970s, along with regional affiliations, can help you guess its murder rate from those days. Quite the narrative power vested in numbers, right?</p>
<p>That’s a wrap! Remember, in the world of data, there’s always a story waiting to be told. Happy analyzing!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advanced-topics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-game-sales-dataset.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
